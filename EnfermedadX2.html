<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>An√°lisis de Brotes y Modelamiento en Salud P√∫blica: Taller D√≠a 4 - Grupo 2 - Estimaci√≥n de las distribuciones de rezagos epidemiol√≥gicos: Enfermedad X</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Epiverse-TRACE" src="assets/images/logo_epimodelac.png"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #FFF">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Vista de Aprendiz <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/EnfermedadX2.html';">Vista de Instructor</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Epiverse-TRACE" src="assets/images/epiverse-logo.svg"></div>
    <div class="lesson-title-md">
      An√°lisis de Brotes y Modelamiento en Salud P√∫blica
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            An√°lisis de Brotes y Modelamiento en Salud P√∫blica
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Puntos Clave</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glosario</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Perfiles de Aprendiz</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            M√°s <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  An√°lisis de Brotes y Modelamiento en Salud P√∫blica
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 46%" class="percentage">
    46%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 46%" aria-valuenow="46" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Vista de Aprendiz
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/EnfermedadX2.html">Vista de Instructor</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODIOS
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <?xml version="1.0" encoding="UTF-8"?><div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
      <a href="index.html">Resumen y Configuraci√≥n</a>
    </div>
    <!--/div.accordion-header-->
  </div>
  <!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="TallerIntroAnaliticaBrotes.html">1. Taller D√≠a 2 - Introducci√≥n a la anal√≠tica de brotes</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="ZIKAB.html">2. Taller D√≠a 3 - Construyendo un modelo matem√°tico simple para Zika.</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="EnfermedadX.html">3. Taller D√≠a 4 - Grupo 1 - Estimaci√≥n de las distribuciones de rezagos epidemiol√≥gicos: Enfermedad X</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Taller D√≠a 4 - Grupo 2 - Estimaci√≥n de las distribuciones de rezagos epidemiol√≥gicos: Enfermedad X
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introducci%C3%B3n">1. Introducci√≥n</a></li>
<li><a href="#agenda">2. Agenda</a></li>
<li><a href="#conceptos-claves">3. Conceptos claves</a></li>
<li><a href="#paquetes-de-r-para-la-practica">4. Paquetes de <em>R</em> para la practica</a></li>
<li><a href="#datos">5. Datos</a></li>
<li><a href="#exploraci%C3%B3n-de-los-datos">6. Exploraci√≥n de los datos</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="Sivirep-tutorial.html">5. Taller sivirep</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="Serofoi-tutorial.html">6. Tutorial Serofoi</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="Vaccineff-tutorial.html">7. Tutorial Vaccineff: Introducci√≥n al c√°lculo de efectividad vacunal con cohortes</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="epiCo-tutorial.html">8. Tutorial epiCo: Taller An√°lisis de Riesgo y Tablero de Control</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RECURSOS
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Puntos Clave</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glosario</a>
                      </li>
                      <li>
                        <a href="profiles.html">Perfiles de Aprendiz</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">Ver todo en una sola p√°gina</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="EnfermedadX.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="Sivirep-tutorial.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="EnfermedadX.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Taller D√≠a 4 - Grupo
        </a>
        <a class="chapter-link float-end" href="Sivirep-tutorial.html" rel="next">
          Next: Taller sivirep... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Taller D√≠a 4 - Grupo 2 - Estimaci√≥n de las distribuciones de rezagos epidemiol√≥gicos: Enfermedad X</h1>
        <p> Last updated on 2023-12-07 | 
        
        <a href="https://github.com/Joskerus/Nuevoformato/edit/main/episodes/EnfermedadX2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>¬øC√≥mo responder ante un brote de una enfermedad desconocida?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>Al final de este taller usted podr√°:</p>
<ul><li><p>Comprender los conceptos clave de las distribuciones de rezagos
epidemiol√≥gicos para la Enfermedad X.</p></li>
<li><p>Comprender las estructuras de datos y las herramientas para el
an√°lisis de datos de rastreo de contactos.</p></li>
<li><p>Aprender a ajustar las estimaciones del intervalo serial y el
per√≠odo de incubaci√≥n de la Enfermedad X teniendo en cuenta la censura
por intervalo utilizando un marco de trabajo Bayesiano.</p></li>
<li><p>Aprender a utilizar estos par√°metros para informar estrategias de
control en un brote de un pat√≥geno desconocido.</p></li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="introducci√≥n"><h2 class="section-heading">1. Introducci√≥n<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width"><p>La Enfermedad X representa un hipot√©tico, pero plausible, brote de
una enfermedad infecciosa en el futuro. Este t√©rmino fue acu√±ado por la
Organizaci√≥n Mundial de la Salud (OMS) y sirve como un t√©rmino general
para un pat√≥geno desconocido que podr√≠a causar una epidemia grave a
nivel internacional. Este concepto representa la naturaleza impredecible
de la aparici√≥n de enfermedades infecciosas y resalta la necesidad de
una preparaci√≥n global y mecanismos de respuesta r√°pida. La Enfermedad X
simboliza el potencial de una enfermedad inesperada y de r√°pida
propagaci√≥n, y resalta la necesidad de sistemas de salud flexibles y
adaptables, as√≠ como capacidades de investigaci√≥n para identificar,
comprender y combatir pat√≥genos desconocidos.</p>
<p>En esta pr√°ctica, va a aprender a estimar los rezagos
epidemiol√≥gicos, el tiempo entre dos eventos epidemiol√≥gicos, utilizando
un conjunto de datos simulado de la Enfermedad X.</p>
<p>La Enfermedad X es causada por un pat√≥geno desconocido y se transmite
directamente de persona a persona. Espec√≠ficamente, la practica se
centrar√° en estimar el per√≠odo de incubaci√≥n y el intervalo serial.</p>
</section><section id="agenda"><h2 class="section-heading">2. Agenda<a class="anchor" aria-label="anchor" href="#agenda"></a>
</h2>
<hr class="half-width"><p>Parte 1. Individual o en grupo.</p>
<p>Parte 2. En 7 grupos de 6 personas. Construir estrategia de rastreo
de contactos y aislamiento y preparar presentaci√≥n de m√°ximo 10
mins.</p>
</section><section id="conceptos-claves"><h2 class="section-heading">3. Conceptos claves<a class="anchor" aria-label="anchor" href="#conceptos-claves"></a>
</h2>
<hr class="half-width"><div class="section level4">
<h4 id="rezagos-epidemiol√≥gicos-per√≠odo-de-incubaci√≥n-e-intervalo-serial"><strong>3.1. Rezagos epidemiol√≥gicos: Per√≠odo de incubaci√≥n e
intervalo serial</strong><a class="anchor" aria-label="anchor" href="#rezagos-epidemiol%C3%B3gicos-per%C3%ADodo-de-incubaci%C3%B3n-e-intervalo-serial"></a></h4>
<p>En epidemiolog√≠a, las distribuciones de rezagos se refieren a los
<em>retrasos temporales</em> entre dos eventos clave durante un brote.
Por ejemplo: el tiempo entre el inicio de los s√≠ntomas y el diagn√≥stico,
el tiempo entre la aparici√≥n de s√≠ntomas y la muerte, entre muchos
otros.</p>
<p>Este taller se enfocar√° en dos rezagos clave conocidos como el
per√≠odo de incubaci√≥n y el intervalo serial. Ambos son cruciales para
informar la respuesta de salud p√∫blica.</p>
<p>El <u><strong>per√≠odo de incubaci√≥n</strong></u> es el tiempo entre
la infecci√≥n y la aparici√≥n de s√≠ntomas.</p>
<p>El <u><strong>intervalo serial</strong></u> es el tiempo entre la
aparici√≥n de s√≠ntomas entre el caso primario y secundario.</p>
<p>La relaci√≥n entre estos par√°metros tiene un impacto en si la
enfermedad se transmite antes <u>(<strong>transmisi√≥n
pre-sintom√°tica</strong>)</u> o despu√©s de que los s√≠ntomas
<u>(<strong>transmisi√≥n sintom√°tica</strong>)</u> se hayan desarrollado
en el caso primario (Figura 1).</p>
<figure><img src="practicalfig.jpg" class="figure mx-auto d-block"></figure><p>Figura 1. Relaci√≥n entre el per√≠odo de incubaci√≥n y el intervalo
serial en el momento de la transmisi√≥n (<em>Adaptado de Nishiura et
al.¬†2020)</em></p>
</div>
<div class="section level4">
<h4 id="distribuciones-comunes-de-rezagos-y-posibles-sesgos">3.2. Distribuciones comunes de rezagos y posibles sesgos<a class="anchor" aria-label="anchor" href="#distribuciones-comunes-de-rezagos-y-posibles-sesgos"></a></h4>
<div class="section level5">
<h5 id="sesgos-potenciales"><strong>3.2.1 Sesgos potenciales</strong><a class="anchor" aria-label="anchor" href="#sesgos-potenciales"></a></h5>
<p>Cuando se estiman rezagos epidemiol√≥gicos, es importante considerar
posibles sesgos:</p>
<p><u><strong>Censura</strong></u> significa que sabemos que un evento
ocurri√≥, pero no sabemos exactamente cu√°ndo sucedi√≥. La mayor√≠a de los
datos epidemiol√≥gicos est√°n ‚Äúdoblemente censurados‚Äù debido a la
incertidumbre que rodea tanto los tiempos de eventos primarios como
secundarios. No tener en cuenta la censura puede llevar a estimaciones
sesgadas de la desviaci√≥n est√°ndar del resago (Park et al.¬†en
progreso).</p>
<p><u><strong>Truncamiento a la derecha</strong></u> es un tipo de sesgo
de muestreo relacionado con el proceso de recolecci√≥n de datos. Surge
porque solo se pueden observar los casos que han sido reportados. No
tener en cuenta el truncamiento a la derecha durante la fase de
crecimiento de una epidemia puede llevar a una subestimaci√≥n del rezago
medio (Park et al.¬†en progreso).</p>
<p>El sesgo <u><strong>din√°mico (o de fase epid√©mica</strong>)</u> es
otro tipo de sesgo de muestreo. Afecta a los datos retrospectivos y est√°
relacionado con la fase de la epidemia: durante la fase de crecimiento
exponencial, los casos que desarrollaron s√≠ntomas recientemente est√°n
sobrerrepresentados en los datos observados, mientras que durante la
fase de declive, estos casos est√°n subrepresentados, lo que lleva a la
estimaci√≥n de intervalos de retraso m√°s cortos y m√°s largos,
respectivamente (Park et al.¬†en progreso).</p>
</div>
<div class="section level5">
<h5 id="distribuciones-de-rezagos"><strong>3.2.2 Distribuciones de rezagos</strong><a class="anchor" aria-label="anchor" href="#distribuciones-de-rezagos"></a></h5>
<p>Tres distribuciones de probabilidad comunes utilizadas para
caracterizar rezagos en epidemiolog√≠a de enfermedades infecciosas (Tabla
1):</p>
<table class="table"><caption>Tabla 1. Tres de las distribuciones de probabilidad m√°s comunes
para rezagos epidemiol√≥gicos.</caption>
<colgroup><col width="15%"><col width="84%"></colgroup><tbody><tr class="odd"><td rowspan="2">
<h1 id="distribuci√≥n">Distribuci√≥n</h1>
<p><strong>Weibull</strong></p>
</td>
<td rowspan="2">Par√°metros | :=======================================:+
<code>shape</code> y <code>scale</code> (forma y escala) |</td>
</tr><tr class="even"></tr><tr class="odd"><td><strong>gamma</strong></td>
<td>
<code>shape</code> y <code>scale</code> (forma y escala) |</td>
</tr><tr class="even"><td><strong>log normal</strong></td>
<td>
<code>log mean</code> y <code>log standard deviation</code> (media
logar√≠tmica y desviaci√≥n est√°ndar logar√≠tmica)</td>
</tr></tbody></table></div>
</div>
</section><section id="paquetes-de-r-para-la-practica"><h2 class="section-heading">4. Paquetes de <em>R</em> para la practica<a class="anchor" aria-label="anchor" href="#paquetes-de-r-para-la-practica"></a>
</h2>
<hr class="half-width"><p>En esta practica se usar√°n los siguientes paquetes de
<code>R</code>:</p>
<ul><li><p><code>dplyr</code> para manejo de datos</p></li>
<li><p><code>epicontacts</code> para visualizar los datos de rastreo de
contactos</p></li>
<li><p><code>ggplot2</code> y <code>patchwork</code> para
gr√°ficar</p></li>
<li><p><code>incidence</code> para visualizar curvas epidemicas</p></li>
<li><p><code>rstan</code> para estimar el per√≠odo de incubaci√≥n</p></li>
<li><p><code>coarseDataTools</code> via <code>EpiEstim</code> para
estimar el intervalo serial</p></li>
</ul><p>Instrucciones de instalaci√≥n para los paquetes:</p>
<p>Para cargar los paquetes, escriba:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epicontacts</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">coarseDataTools</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EpiEstim</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">loo</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">patchwork</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">rstan</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="datos"><h2 class="section-heading">5. Datos<a class="anchor" aria-label="anchor" href="#datos"></a>
</h2>
<hr class="half-width"><p>Esta pr√°ctica est√° partida en dos grupos para abordar dos
enfermedades desconocidas con diferentes modos de transmisi√≥n.</p>
<p>Cargue los datos simulados que est√°n guardados como un archivo .RDS,
de acuerdo a su grupo asignado. Puede encontrar esta informaci√≥n en la
carpeta <a href="https://drive.google.com/drive/folders/1v8gMuEJx24ottM0VR4X_Ile60EV18ay3?usp=sharing" class="external-link">Enfermedad
X</a>. Descargue la carpeta, extr√°igala en el computador y abra el
proyecto de R.</p>
<p>Hay dos elementos de inter√©s:</p>
<ul><li><p><code>linelist</code>, un archivo que contiene una lista de casos
de la Enfermedad X, un caso por fila.</p></li>
<li><p><code>contacts</code>, un archivo con datos de rastreo de
contactos que contiene informaci√≥n sobre pares de casos primarios y
secundarios.</p></li>
</ul><div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in gzfile(file, "rb"): cannot open compressed file
'Data/practical_data_group2.RDS', probable reason 'No such file or directory'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in gzfile(file, "rb"): cannot open the connection</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'dat' not found</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'dat' not found</code></pre>
</div>
</section><section id="exploraci√≥n-de-los-datos"><h2 class="section-heading">6. Exploraci√≥n de los datos<a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-los-datos"></a>
</h2>
<hr class="half-width"><div class="section level4">
<h4 id="exploraci√≥n-de-los-datos-en-linelist"><strong>6.1. Exploraci√≥n de los datos en
<code>linelist</code></strong><a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-los-datos-en-linelist"></a></h4>
<p>Empiece con <code>linelist</code>. Estos datos fueron recolectados
como parte de la vigilancia epidemiol√≥gica rutinaria. Cada fila
representa un caso de la Enfermedad X, y hay 7 variables:</p>
<ul><li><p><code>id</code>: n√∫mero √∫nico de identificaci√≥n del caso</p></li>
<li><p><code>date_onset</code>: fecha de inicio de los s√≠ntomas del
paciente</p></li>
<li><p><code>sex</code>: : M = masculino; F = femenino</p></li>
<li><p><code>age</code>: edad del paciente en a√±os</p></li>
<li><p><code>exposure</code>: informaci√≥n sobre c√≥mo el paciente podr√≠a
haber estado expuesto</p></li>
<li><p><code>exposure_start</code>: primera fecha en que el paciente
estuvo expuesto</p></li>
<li><p><code>exposure_end</code>: √∫ltima fecha en que el paciente estuvo
expuesto</p></li>
</ul><div class="alert alert-secondary">
<p><em>üí° <strong>Preguntas (1)</strong></em></p>
<ul><li><p><em>¬øCu√°ntos casos hay en los datos de
<code>linelist</code>?</em></p></li>
<li><p><em>¬øQu√© proporci√≥n de los casos son femeninos?</em></p></li>
<li><p><em>¬øCu√°l es la distribuci√≥n de edades de los
casos?</em></p></li>
<li><p><em>¬øQu√© tipo de informaci√≥n sobre la exposici√≥n est√°
disponible?</em></p></li>
</ul></div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inspecionar los datos</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'linelist' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P1</span></span>
<span><span class="fu">nrow</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'linelist' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P2</span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="fu">nrow</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'linelist' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P3</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'linelist' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P4</span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">exposure</span>, exclude <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu">nrow</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'linelist' not found</code></pre>
</div>
<div class="alert alert-secondary">
<p><em>üí° <strong>Discusi√≥n</strong></em></p>
<ul><li><p>¬øPor qu√© cree que falta la informaci√≥n de exposici√≥n en algunos
casos?</p></li>
<li><p>Ahora, grafique la curva epid√©mica. ¬øEn qu√© parte del brote cree
que est√° (principio, medio, final)?</p></li>
</ul></div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'linelist' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'i' not found</code></pre>
</div>
<p>Parece que la epidemia todav√≠a podr√≠a esta creciendo.</p>
</div>
<div class="section level4">
<h4 id="exploraci√≥n-de-los-datos-de-rastreo-de-contactos"><strong>6.2. Exploraci√≥n de los datos de
<code>rastreo de contactos</code></strong><a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-los-datos-de-rastreo-de-contactos"></a></h4>
<p>Ahora vea los datos de rastreo de contactos, que se obtuvieron a
trav√©s de entrevistas a los pacientes. A los pacientes se les pregunt√≥
sobre actividades e interacciones recientes para identificar posibles
fuentes de infecci√≥n. Se emparejaron pares de casos primarios y
secundarios si el caso secundario nombraba al caso primario como un
contacto. Solo hay informaci√≥n de un subconjunto de los casos porque no
todos los pacientes pudieron ser contactados para una entrevista.</p>
<p>Note que para este ejercicio, se asumir√° que los casos secundarios
solo ten√≠an un posible infectante. En realidad, la posibilidad de que un
caso tenga m√∫ltiples posibles infectantes necesita ser evaluada.</p>
<p>Los datos de rastreo de contactos tienen 4 variables:</p>
<ul><li><p><code>primary_case_id</code>: n√∫mero de identificaci√≥n √∫nico para
el caso primario (infectante)</p></li>
<li><p><code>secondary_case_id</code>: n√∫mero de identificaci√≥n √∫nico
para el caso secundario (infectado)</p></li>
<li><p><code>primary_onset_date</code>: fecha de inicio de s√≠ntomas del
caso primario</p></li>
<li><p><code>secondary_onset_date</code>: fecha de inicio de s√≠ntomas
del caso secundario</p></li>
</ul><div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">make_epicontacts</span><span class="op">(</span>linelist <span class="op">=</span> <span class="va">linelist</span>,</span>
<span>                       contacts <span class="op">=</span> <span class="va">contacts</span>,</span>
<span>                       from <span class="op">=</span> <span class="st">"primary_case_id"</span>,</span>
<span>                       to <span class="op">=</span> <span class="st">"secondary_case_id"</span>,</span>
<span>                       directed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Esto indica que los contactos son directos (i.e., este gr√°fico traza una flecha desde los casos primarios a los secundarios)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'linelist' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'x' not found</code></pre>
</div>
<div class="alert alert-secondary">
<p><em>üí° <strong>Preguntas (2)</strong></em></p>
<ul><li>Describa los grupos (clusters).<br></li>
<li>¬øVe alg√∫n evento potencial de superpropagaci√≥n (donde un caso
propaga el pat√≥geno a muchos otros casos)?</li>
</ul></div>
</div>
</section><div class="section level1">
<h1 id="pausa-1-_________"><em><code>_______Pausa 1 _________</code></em><a class="anchor" aria-label="anchor" href="#pausa-1-_________"></a></h1>
<hr><div class="section level2">
<h2 id="estimaci√≥n-del-per√≠odo-de-incubaci√≥n">7. Estimaci√≥n del per√≠odo de incubaci√≥n<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-per%C3%ADodo-de-incubaci%C3%B3n"></a></h2>
<p>Ahora, enfoquese en el per√≠odo de incubaci√≥n. Se utilizar√° los datos
del <code>linelist</code> para esta parte. Se necesitan ambos el tiempo
de inicio de sintomas y el timpo de la posible exposici√≥n. Note que en
los datos hay dos fechas de exposici√≥n, una de inicio y una de final.
Algunas veces la fecha exacta de exposici√≥n es desconocida y en su lugar
se obtiene la ventana de exposici√≥n durante la entrevista.</p>
<div class="alert alert-secondary">
<p><em>üí° <strong>Preguntas (3)</strong></em></p>
<ul><li><p>¬øPara cu√°ntos casos tiene datos tanto de la fecha de inicio de
s√≠ntomas como de exposici√≥n?</p></li>
<li><p>Calcule las ventanas de exposici√≥n. ¬øCu√°ntos casos tienen una
√∫nica fecha de exposici√≥n?</p></li>
</ul></div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ip</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">linelist</span>, <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">exposure_start</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>               <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">exposure_end</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'linelist' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nrow</span><span class="op">(</span><span class="va">ip</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'ip' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_window</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_end</span> <span class="op">-</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'ip' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_window</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'ip' not found</code></pre>
</div>
<div class="section level3">
<h3 id="estimaci√≥n-naive-del-per√≠odo-de-incubaci√≥n">7.1. Estimaci√≥n naive del per√≠odo de incubaci√≥n<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-naive-del-per%C3%ADodo-de-incubaci%C3%B3n"></a></h3>
<p>Empiece calculando una estimaci√≥n naive del per√≠odo de
incubaci√≥n.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># M√°ximo tiempo de per√≠odo de incubaci√≥n</span></span>
<span><span class="va">ip</span><span class="op">$</span><span class="va">max_ip</span> <span class="op">&lt;-</span> <span class="va">ip</span><span class="op">$</span><span class="va">date_onset</span> <span class="op">-</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'ip' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">max_ip</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'ip' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># M√≠nimo tiempo de per√≠odo de incubaci√≥n</span></span>
<span><span class="va">ip</span><span class="op">$</span><span class="va">min_ip</span> <span class="op">&lt;-</span> <span class="va">ip</span><span class="op">$</span><span class="va">date_onset</span> <span class="op">-</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_end</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'ip' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">min_ip</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'ip' not found</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="censura-estimada-ajustada-del-per√≠odo-de-incubaci√≥n">7.2. Censura estimada ajustada del per√≠odo de incubaci√≥n<a class="anchor" aria-label="anchor" href="#censura-estimada-ajustada-del-per%C3%ADodo-de-incubaci%C3%B3n"></a></h3>
<p>Ahora, ajuste tres distribuciones de probabilidad a los datos del
per√≠odo de incubaci√≥n teniendo en cuenta la censura doble. Adapte un
c√≥digo de <code>stan</code> que fue publicado por Miura et al.¬†durante
el brote global de mpox de 2022. Este m√©todo no tiene en cuenta el
truncamiento a la derecha ni el sesgo din√°mico.</p>
<p>Recuerde que el inter√©s principal es considerar tres distribuciones
de probabilidad: <em>Weibull</em>, <em>gamma</em> y <em>log normal</em>
(Ver Tabla 1).</p>
<p><code>Stan</code> es un programa de software que implementa el
algoritmo Monte Carlo Hamiltoniano (HMC por su siglas en ingl√©s de
Hamiltonian Monte Carlo). HMC es un m√©todo de Monte Carlo de cadena de
Markov (MCMC) para ajustar modelos complejos a datos utilizando
estad√≠sticas bayesianas.</p>
<div class="section level4">
<h4 id="corra-el-modelo-en-stan"><strong>7.1.1. Corra el modelo en Stan</strong><a class="anchor" aria-label="anchor" href="#corra-el-modelo-en-stan"></a></h4>
<p>Ajuste las tres distribuciones en este bloque de c√≥digo.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare los datos</span></span>
<span><span class="va">earliest_exposure</span> <span class="op">&lt;-</span> <span class="fu">as.Date</span><span class="op">(</span><span class="fu">min</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'ip' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ip</span> <span class="op">&lt;-</span> <span class="va">ip</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">date_onset</span> <span class="op">-</span> <span class="va">earliest_exposure</span><span class="op">)</span>,</span>
<span>         exposure_start <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">exposure_start</span> <span class="op">-</span> <span class="va">earliest_exposure</span><span class="op">)</span>,</span>
<span>         exposure_end <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">exposure_end</span> <span class="op">-</span> <span class="va">earliest_exposure</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">date_onset</span>, <span class="va">exposure_start</span>, <span class="va">exposure_end</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'ip' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Configure algunas opciones para ejecutar las cadenas MCMC en paralelo</span></span>
<span><span class="co"># Ejecuci√≥n de las cadenas MCMC en paralelo significa que se ejecutaran varias cadenas al mismo tiempo usando varios n√∫cleos de su computador</span></span>
<span><span class="fu">options</span><span class="op">(</span>mc.cores<span class="op">=</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_data</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>N <span class="op">=</span> <span class="fu">length</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span><span class="op">)</span>, <span class="co"># NN√∫mero de observaciones</span></span>
<span>              tStartExposure <span class="op">=</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span>,</span>
<span>              tEndExposure <span class="op">=</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_end</span>,</span>
<span>              tSymptomOnset <span class="op">=</span> <span class="va">ip</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'ip' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tres distribuciones de probabilidad</span></span>
<span><span class="va">distributions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"weibull"</span>, <span class="st">"gamma"</span>, <span class="st">"lognormal"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># C√≥digo de Stan </span></span>
<span><span class="va">code</span> <span class="op">&lt;-</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  data{</span></span>
<span><span class="st">    int&lt;lower=1&gt; N;</span></span>
<span><span class="st">    vector[N] tStartExposure;</span></span>
<span><span class="st">    vector[N] tEndExposure;</span></span>
<span><span class="st">    vector[N] tSymptomOnset;</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  parameters{</span></span>
<span><span class="st">    real&lt;lower=0&gt; par[2];</span></span>
<span><span class="st">    vector&lt;lower=0, upper=1&gt;[N] uE;  // Uniform value for sampling between start and end exposure</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  transformed parameters{</span></span>
<span><span class="st">    vector[N] tE;   // infection moment</span></span>
<span><span class="st">    tE = tStartExposure + uE .* (tEndExposure - tStartExposure);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">model{</span></span>
<span><span class="st">    // Contribution to likelihood of incubation period</span></span>
<span><span class="st">    target += %s_lpdf(tSymptomOnset -  tE  | par[1], par[2]);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  generated quantities {</span></span>
<span><span class="st">    // likelihood for calculation of looIC</span></span>
<span><span class="st">    vector[N] log_lik;</span></span>
<span><span class="st">    for (i in 1:N) {</span></span>
<span><span class="st">      log_lik[i] = %s_lpdf(tSymptomOnset[i] -  tE[i]  | par[1], par[2]);</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">"</span>, <span class="va">distributions</span>, <span class="va">distributions</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">code</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">distributions</span></span>
<span></span>
<span><span class="co"># La siguiente l√≠nea puede tomar ~1.5 min</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="va">stan_model</span>, model_code <span class="op">=</span> <span class="va">code</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Toma ~40 sec.</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="va">sampling</span>, <span class="va">models</span>, <span class="fu">list</span><span class="op">(</span><span class="va">input_data</span><span class="op">)</span>, </span>
<span>              iter<span class="op">=</span><span class="fl">3000</span>, <span class="co"># N√∫mero de iteraciones (largo de la cadena MCMC)</span></span>
<span>              warmup<span class="op">=</span><span class="fl">1000</span>, <span class="co"># N√∫mero de muestras a descartar al inicio de MCMC</span></span>
<span>              chain<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="co"># N√∫mero de cadenas MCMC a ejecutar</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'input_data' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu">rstan</span><span class="fu">::</span><span class="fu">extract</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">$</span><span class="va">par</span>, <span class="va">fit</span>, SIMPLIFY<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># muestreo posterior </span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in dots[[1L]][[1L]]: object of type 'closure' is not subsettable</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="revisar-si-hay-convergencia"><strong>7.1.2. Revisar si hay convergencia</strong><a class="anchor" aria-label="anchor" href="#revisar-si-hay-convergencia"></a></h4>
<p>Ahora verifique la convergencia del modelo. Observe los valores de
r-hat, los tama√±os de muestra efectivos y las trazas MCMC. R-hat compara
las estimaciones entre y dentro de cadenas para los par√°metros del
modelo; valores cercanos a 1 indican que las cadenas se han mezclado
bien (Vehtari et al.¬†2021). El tama√±o de muestra efectivo estima el
n√∫mero de muestras independientes despu√©s de tener en cuenta la
dependencia en las cadenas MCMC (Lambert 2018). Para un modelo con 4
cadenas MCMC, se recomienda un tama√±o total de muestra efectiva de al
menos 400 (Vehtari et al.¬†2021).</p>
<p>Para cada modelo con distribuci√≥n ajustada:</p>
<div class="alert alert-secondary">
<p><em>üí° <strong>Questions (4)</strong></em></p>
<ul><li><p>¬øLos valores de r-hat son cercanos a 1?</p></li>
<li><p>¬øLas 4 cadenas MCMC generalmente se superponen y permanecen
alrededor de los mismos valores (se ven como orugas peludas)?</p></li>
</ul></div>
</div>
<div class="section level4">
<h4 id="convergencia-para-gamma"><strong>7.1.2.1. Convergencia para Gamma</strong><a class="anchor" aria-label="anchor" href="#convergencia-para-gamma"></a></h4>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span>, digits <span class="op">=</span> <span class="fl">3</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in fit$gamma: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rstan</span><span class="fu">::</span><span class="fu">traceplot</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in (function (cond) : error in evaluating the argument 'object' in selecting a method for function 'traceplot': object of type 'closure' is not subsettable</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="convergencia-para-log-normal"><strong>7.1.2.2. Convergencia para log normal</strong><a class="anchor" aria-label="anchor" href="#convergencia-para-log-normal"></a></h4>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">lognormal</span>, digits <span class="op">=</span> <span class="fl">3</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in fit$lognormal: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rstan</span><span class="fu">::</span><span class="fu">traceplot</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">lognormal</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in (function (cond) : error in evaluating the argument 'object' in selecting a method for function 'traceplot': object of type 'closure' is not subsettable</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="convergencia-para-weibull"><strong>7.1.2.3. Convergencia para Weibull</strong><a class="anchor" aria-label="anchor" href="#convergencia-para-weibull"></a></h4>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">weibull</span>, digits <span class="op">=</span> <span class="fl">3</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in fit$weibull: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rstan</span><span class="fu">::</span><span class="fu">traceplot</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">weibull</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in (function (cond) : error in evaluating the argument 'object' in selecting a method for function 'traceplot': object of type 'closure' is not subsettable</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="calcule-los-criterios-de-comparaci√≥n-de-los-modelos"><strong>7.1.3. Calcule los criterios de comparaci√≥n de los
modelos</strong><a class="anchor" aria-label="anchor" href="#calcule-los-criterios-de-comparaci%C3%B3n-de-los-modelos"></a></h4>
<p>Calcule el criterio de informaci√≥n ampliamente aplicable (WAIC) y el
criterio de informaci√≥n de dejar-uno-fuera (LOOIC) para comparar los
ajustes de los modelos. El modelo con mejor ajuste es aquel con el WAIC
o LOOIC m√°s bajo. En esta secci√≥n tambi√©n se resumir√° las distribuciones
y se har√° algunos gr√°ficos.</p>
<div class="alert alert-secondary">
<p><em>üí° <strong>Questions (5)</strong></em></p>
<ul><li>¬øQu√© modelo tiene mejor ajuste?</li>
</ul></div>
</div>
<div class="section level4">
<h4 id="section"></h4>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calcule WAIC para los tres modelos</span></span>
<span><span class="va">waic</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu">waic</span><span class="op">(</span><span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span>, <span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in dots[[1L]][[1L]]: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">waic</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>function(x, ...) {
  UseMethod("waic")
}
&lt;bytecode: 0x55c668973f40&gt;
&lt;environment: namespace:loo&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Para looic, se necesita proveer los tama√±os de muestra relativos</span></span>
<span><span class="co"># al llamar a loo. Este paso lleva a mejores estimados de los tama√±os de </span></span>
<span><span class="co"># muestra PSIS efectivos y del error de Monte Carlo </span></span>
<span></span>
<span><span class="co"># Extraer la verosimilitud puntual logar√≠tmica para la distribuci√≥n Weibull</span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">weibull</span>, merge_chains <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in fit$weibull: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtener los tama√±os de muestra relativos efectivos</span></span>
<span><span class="va">r_eff</span> <span class="op">&lt;-</span> <span class="fu">relative_eff</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'loglik' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calcula LOOIC</span></span>
<span><span class="va">loo_w</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="op">(</span><span class="va">loglik</span>, r_eff <span class="op">=</span> <span class="va">r_eff</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'loo': object 'loglik' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imprimir los resultados</span></span>
<span><span class="va">loo_w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'loo_w' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extraer la verosimilitud puntual logar√≠tmica para la distribuci√≥n gamma </span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span>, merge_chains <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in fit$gamma: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r_eff</span> <span class="op">&lt;-</span> <span class="fu">relative_eff</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'loglik' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_g</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="op">(</span><span class="va">loglik</span>, r_eff <span class="op">=</span> <span class="va">r_eff</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'loo': object 'loglik' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_g</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'loo_g' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb82">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extraer la verosimilitud puntual logar√≠tmica para la distribuci√≥n log normal </span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">lognormal</span>, merge_chains <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in fit$lognormal: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r_eff</span> <span class="op">&lt;-</span> <span class="fu">relative_eff</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'loglik' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb86">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_l</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="op">(</span><span class="va">loglik</span>, r_eff <span class="op">=</span> <span class="va">r_eff</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'loo': object 'loglik' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb88">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_l</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'loo_l' not found</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="reporte-los-resultados"><strong>7.1.4. Reporte los resultados</strong><a class="anchor" aria-label="anchor" href="#reporte-los-resultados"></a></h4>
<p>La cola derecha de la distribuci√≥n del per√≠odo de incubaci√≥n es
importante para dise√±ar estrategias de control (por ejemplo,
cuarentena), los percentiles del 25 al 75 informan sobre el momento m√°s
probable en que podr√≠a ocurrir la aparici√≥n de s√≠ntomas, y la
distribuci√≥n completa puede usarse como una entrada en modelos
matem√°ticos o estad√≠sticos, como para pron√≥sticos (Lessler et
al.¬†2009).</p>
<p>Obtenga las estad√≠sticas resumidas.</p>
<div class="codewrapper sourceCode" id="cb90">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Necesitamos convertir los par√°metros de las distribuciones a la media y desviaci√≥n est√°ndar del rezago</span></span>
<span></span>
<span><span class="co"># En Stan, los par√°metros de las distribuciones son:</span></span>
<span><span class="co"># Weibull: forma y escala</span></span>
<span><span class="co"># Gamma: forma e inversa de la escala (aka rate)</span></span>
<span><span class="co"># Log Normal: mu y sigma</span></span>
<span><span class="co"># Referencia: https://mc-stan.org/docs/2_21/functions-reference/positive-continuous-distributions.html</span></span>
<span></span>
<span><span class="co"># Calcule las medias</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span></span>
<span>  <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># media de Weibull</span></span>
<span>  <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="co"># media de gamma</span></span>
<span>  <span class="fu">exp</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># media de log normal</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'pos' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calcule las desviaciones est√°ndar</span></span>
<span><span class="va">standard_deviations</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span></span>
<span>  <span class="fu">sqrt</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">sqrt</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'pos' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imprimir los rezagos medios e intervalos cre√≠bles del 95%</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_means</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">means</span>, <span class="fl">2</span>, <span class="va">quantile</span>, <span class="va">probs</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'means' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb96">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="va">res_means</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">colnames</span><span class="op">(</span><span class="va">waic</span><span class="op">)</span> <span class="co"># Aqu√≠ parece faltar la definici√≥n de 'waic'</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'res_means' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb98">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_means</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'res_means' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb100">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_sds</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">standard_deviations</span>, <span class="fl">2</span>, <span class="va">quantile</span>, <span class="va">probs</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'standard_deviations' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb102">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="va">res_sds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">colnames</span><span class="op">(</span><span class="va">waic</span><span class="op">)</span> <span class="co"># Aqu√≠ parece faltar la definici√≥n de 'waic'</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'res_sds' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb104">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_sds</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'res_sds' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb106">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Informe la mediana e intervalos cre√≠bles del 95% para los cuantiles de cada distribuci√≥n</span></span>
<span></span>
<span><span class="va">quantiles_to_report</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>, <span class="fl">0.99</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Weibull</span></span>
<span><span class="va">cens_w_percentiles</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">quantiles_to_report</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">qweibull</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="va">probs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in FUN(X[[i]], ...): object 'pos' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb108">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="va">cens_w_percentiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">quantiles_to_report</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'cens_w_percentiles' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb110">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">cens_w_percentiles</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'cens_w_percentiles' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb112">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gamma</span></span>
<span><span class="va">cens_g_percentiles</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">quantiles_to_report</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">qgamma</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="va">probs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in FUN(X[[i]], ...): object 'pos' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb114">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="va">cens_g_percentiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">quantiles_to_report</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'cens_g_percentiles' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb116">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">cens_g_percentiles</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'cens_g_percentiles' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb118">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Log normal</span></span>
<span><span class="va">cens_ln_percentiles</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">quantiles_to_report</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">qlnorm</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="va">probs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in FUN(X[[i]], ...): object 'pos' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb120">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="va">cens_ln_percentiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">quantiles_to_report</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'cens_ln_percentiles' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb122">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">cens_ln_percentiles</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'cens_ln_percentiles' not found</code></pre>
</div>
<p>Para cada modelo, encuentre estos elementos para el per√≠odo de
incubaci√≥n estimado en la salida de arriba y escribalos abajo.</p>
<ul><li><p>Media e intervalo de credibilidad del 95%</p></li>
<li><p>Desviaci√≥n est√°ndar e intervalo de credibilidad del 95%</p></li>
<li><p>Percentiles (e.g., 2.5, 5, 25, 50, 75, 95, 97.5, 99)</p></li>
<li><p>Los par√°metros de las distribuciones ajustadas (e.g., shape y
scale para distribuci√≥n gamma)</p></li>
</ul></div>
<div class="section level4">
<h4 id="grafique-los-resultados"><strong>7.1.5. Grafique los resultados</strong><a class="anchor" aria-label="anchor" href="#grafique-los-resultados"></a></h4>
<div class="codewrapper sourceCode" id="cb124">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare los resultados para graficarlos</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span><span class="co">#Tome los valores de las medias para trazar la funci√≥n de densidad acumulatica empirica</span></span>
<span>  inc_day <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">input_data</span><span class="op">$</span><span class="va">tSymptomOnset</span><span class="op">-</span><span class="va">input_data</span><span class="op">$</span><span class="va">tEndExposure</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="va">input_data</span><span class="op">$</span><span class="va">tSymptomOnset</span><span class="op">-</span><span class="va">input_data</span><span class="op">$</span><span class="va">tStartExposure</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'input_data' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb126">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_plot</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="co"># Esto configura el rango del eje x (n√∫mero de d√≠as)</span></span>
<span></span>
<span><span class="va">Gam_plot</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>dose<span class="op">=</span> <span class="va">x_plot</span>, </span>
<span>                               pred<span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               low <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               upp <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in FUN(X[[i]], ...): object 'pos' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb128">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Wei_plot</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>dose<span class="op">=</span> <span class="va">x_plot</span>, </span>
<span>                               pred<span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               low <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               upp <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in FUN(X[[i]], ...): object 'pos' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb130">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ln_plot</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>dose<span class="op">=</span> <span class="va">x_plot</span>, </span>
<span>                              pred<span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              low <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              upp <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in FUN(X[[i]], ...): object 'pos' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb132">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Grafique las curvas de la distribuci√≥n acumulada </span></span>
<span><span class="va">gamma_ggplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">inc_day</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">Gam_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>, y<span class="op">=</span><span class="va">pred</span><span class="op">)</span>, color<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data<span class="op">=</span><span class="va">Gam_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>,ymin<span class="op">=</span><span class="va">low</span>,ymax<span class="op">=</span><span class="va">upp</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Incubation period (days)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Gamma"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `ggplot()`:
! `data` cannot be a function.
‚Ñπ Have you misspelled the `data` argument in `ggplot()`</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb134">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weibul_ggplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">inc_day</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">Wei_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>, y<span class="op">=</span><span class="va">pred</span><span class="op">)</span>, color<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data<span class="op">=</span><span class="va">Wei_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>,ymin<span class="op">=</span><span class="va">low</span>,ymax<span class="op">=</span><span class="va">upp</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Incubation period (days)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Weibull"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `ggplot()`:
! `data` cannot be a function.
‚Ñπ Have you misspelled the `data` argument in `ggplot()`</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb136">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lognorm_ggplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">inc_day</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">ln_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>, y<span class="op">=</span><span class="va">pred</span><span class="op">)</span>, color<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data<span class="op">=</span><span class="va">ln_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>,ymin<span class="op">=</span><span class="va">low</span>,ymax<span class="op">=</span><span class="va">upp</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Incubation period (days)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Log normal"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `ggplot()`:
! `data` cannot be a function.
‚Ñπ Have you misspelled the `data` argument in `ggplot()`</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb138">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">lognorm_ggplot</span><span class="op">|</span><span class="va">gamma_ggplot</span><span class="op">|</span><span class="va">weibul_ggplot</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'lognorm_ggplot' not found</code></pre>
</div>
<p>En los gr√°ficos anteriores, la l√≠nea negra es la distribuci√≥n
acumulativa emp√≠rica (los datos), mientras que la curva azul es la
distribuci√≥n de probabilidad ajustada con los intervalos de credibilidad
del 95%. Aseg√∫rese de que la curva azul est√© sobre la l√≠nea negra.</p>
<div class="alert alert-secondary">
<p><em>üí° <strong>Preguntas (6)</strong></em></p>
<ul><li>¬øSon los ajustes de las distribuciones lo que espera?</li>
</ul></div>
</div>
<div class="section level4">
<h4 id="section-1"></h4>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="pausa-2-_________"><em><code>_______Pausa 2 _________</code></em><a class="anchor" aria-label="anchor" href="#pausa-2-_________"></a></h1>
<div class="section level2">
<h2 id="estimaci√≥n-del-intervalo-serial">8. Estimaci√≥n del intervalo serial<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-intervalo-serial"></a></h2>
<p>Ahora, estime el intervalo serial. Nuevamente, se realizar√° primero
una estimaci√≥n navie calculando la diferencia entre la fecha de inicio
de s√≠ntomas entre el par de casos primario y secundario.</p>
<ol style="list-style-type: decimal"><li><p>¬øExisten casos con intervalos seriales negativos en los datos
(por ejemplo, el inicio de los s√≠ntomas en el caso secundario ocurri√≥
antes del inicio de los s√≠ntomas en el caso primario)?</p></li>
<li><p>Informe la mediana del intervalo serial, as√≠ como el m√≠nimo y el
m√°ximo.</p></li>
<li><p>Grafique la distribuci√≥n del intervalo serial.</p></li>
</ol><div class="section level3">
<h3 id="estimaci√≥n-naive">8.1. Estimaci√≥n naive<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-naive"></a></h3>
<div class="codewrapper sourceCode" id="cb140">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">secondary_onset_date</span> <span class="op">-</span> <span class="va">contacts</span><span class="op">$</span><span class="va">primary_onset_date</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'contacts' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb142">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'contacts' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb144">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span>, xlab <span class="op">=</span> <span class="st">"Serial interval (days)"</span>, breaks <span class="op">=</span> <span class="fl">25</span>, main <span class="op">=</span> <span class="st">""</span>, col <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'contacts' not found</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="estimaci√≥n-ajustada-por-censura">8.2. Estimaci√≥n ajustada por censura<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-ajustada-por-censura"></a></h3>
<p>Ahora se estimar√° el intervalo serial utilizando una implementaci√≥n
del paquete <code>courseDataTools</code> dentro del paquete R
<code>EpiEstim</code>. Este m√©todo tiene en cuenta la censura doble y
permite comparar diferentes distribuciones de probabilidad, pero no se
ajusta por truncamiento a la derecha o sesgo din√°mico.</p>
<p>Se considerar√° tres distribuciones de probabilidad y deber√°
seleccionar la que mejor se ajuste a los datos utilizando WAIC o LOOIC.
Recuerde que la distribuci√≥n con mejor ajuste tendr√° el WAIC o LOOIC m√°s
bajo.</p>
<p>Ten en cuenta que en <code>coarseDataTools</code>, los par√°metros
para las distribuciones son ligeramente diferentes que en rstan. Aqu√≠,
los par√°metros para la distribuci√≥n gamma son shape y scale (forma y
escala) (<a href="https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf" class="external-link uri">https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf</a>).</p>
<p>Solo se ejecutar√° una cadena MCMC para cada distribuci√≥n en inter√©s
del tiempo, pero en la pr√°ctica deber√≠a ejecutar m√°s de una cadena para
asegurarse de que el MCMC converge en la distribuci√≥n objetivo. Usar√°
las distribuciones a priori predeterminadas, que se pueden encontrar en
la documentaci√≥n del paquete (ver ‚Äòdetalles‚Äô para la funci√≥n
dic.fit.mcmc aqu√≠: (<a href="https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf" class="external-link uri">https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf</a>).</p>
<div class="section level4">
<h4 id="preparaci√≥n-de-los-datos">8.2.1. Preparaci√≥n de los datos<a class="anchor" aria-label="anchor" href="#preparaci%C3%B3n-de-los-datos"></a></h4>
<div class="codewrapper sourceCode" id="cb146">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Formatee los datos de intervalos censurados del intervalo serial</span></span>
<span></span>
<span><span class="co"># Cada l√≠nea representa un evento de transmisi√≥n</span></span>
<span><span class="co"># EL/ER muestran el l√≠mite inferior/superior de la fecha de inicio de los s√≠ntomas en el caso primario (infector)</span></span>
<span><span class="co"># SL/SR muestran lo mismo para el caso secundario (infectado)</span></span>
<span><span class="co"># type tiene entradas 0 que corresponden a datos censurados doblemente por intervalo</span></span>
<span><span class="co"># (ver Reich et al. Statist. Med. 2009)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">si_data</span> <span class="op">&lt;-</span> <span class="va">contacts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">primary_case_id</span>, <span class="op">-</span><span class="va">secondary_case_id</span>, <span class="op">-</span><span class="va">primary_onset_date</span>, <span class="op">-</span><span class="va">secondary_onset_date</span>,<span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>SL <span class="op">=</span> <span class="va">diff</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>type <span class="op">=</span> <span class="fl">0</span>, EL <span class="op">=</span> <span class="fl">0</span>, ER <span class="op">=</span> <span class="fl">1</span>, SR <span class="op">=</span> <span class="va">SL</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">EL</span>, <span class="va">ER</span>, <span class="va">SL</span>, <span class="va">SR</span>, <span class="va">type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'contacts' not found</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="ajuste-una-distribuci√≥n-gamma-para-el-si">8.2.2. Ajuste una distribuci√≥n gamma para el SI<a class="anchor" aria-label="anchor" href="#ajuste-una-distribuci%C3%B3n-gamma-para-el-si"></a></h4>
<p>Primero, ajuste una distribuci√≥n gamma al intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb148">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">overall_seed</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># semilla para el generador de n√∫meros aleatorios para MCMC</span></span>
<span><span class="va">MCMC_seed</span> <span class="op">&lt;-</span> <span class="fl">007</span></span>
<span></span>
<span><span class="co"># Ejecutaremos el modelo durante 4000 iteraciones con las primeras 1000 muestras descartadas como burning</span></span>
<span><span class="va">n_mcmc_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># n√∫mero de muestras a extraer de la posterior (despu√©s del burning)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="st">"G"</span>, <span class="co"># Ajuste de una distribuci√≥n Gamma para el Intervalo Serial (SI)</span></span>
<span>  method <span class="op">=</span> <span class="st">"MCMC"</span>, <span class="co"># MCMC usando coarsedatatools</span></span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># n√∫mero de muestras de burning (muestras descartadas al comienzo de MCMC) </span></span>
<span>  n1 <span class="op">=</span> <span class="fl">50</span>, <span class="co"># n1 es el n√∫mero de pares de media y desviaci√≥n est√°ndar del SI que se extraen</span></span>
<span>  n2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># n2 es el tama√±o de la muestra posterior extra√≠da para cada par de media y desviaci√≥n est√°ndar del SI</span></span>
<span></span>
<span></span>
<span><span class="va">mcmc_control</span> <span class="op">&lt;-</span> <span class="fu">make_mcmc_control</span><span class="op">(</span></span>
<span>seed <span class="op">=</span> <span class="va">MCMC_seed</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">burnin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">dist</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span></span>
<span><span class="fu">list</span><span class="op">(</span></span>
<span>si_parametric_distr <span class="op">=</span> <span class="va">dist</span>,</span>
<span>mcmc_control <span class="op">=</span> <span class="va">mcmc_control</span>,</span>
<span>seed <span class="op">=</span> <span class="va">overall_seed</span>,</span>
<span>n1 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>n2 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ajuste el SI</span></span>
<span><span class="va">si_fit_gamma</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu">dic.fit.mcmc</span><span class="op">(</span></span>
<span>dat <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>init.pars <span class="op">=</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">burnin</span>,</span>
<span>n.samples <span class="op">=</span> <span class="va">n_mcmc_samples</span>,</span>
<span>seed <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_data' not found</code></pre>
</div>
<p>Ahora observe los resultados.</p>
<div class="codewrapper sourceCode" id="cb150">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verificar convergencia de las cadenas MCMC </span></span>
<span><span class="va">converg_diag_gamma</span> <span class="op">&lt;-</span> <span class="fu">check_cdt_samples_convergence</span><span class="op">(</span><span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb152">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">converg_diag_gamma</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'converg_diag_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb154">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Guardar las muestras MCMC en un dataframe</span></span>
<span><span class="va">si_samples_gamma</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>type <span class="op">=</span> <span class="st">'Symptom onset'</span>,</span>
<span>shape <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>,</span>
<span>scale <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span>,</span>
<span>p50 <span class="op">=</span> <span class="fu">qgamma</span><span class="op">(</span></span>
<span>p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>shape <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>, </span>
<span>scale <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">mutate</span><span class="op">(</span> <span class="co"># La ecuaci√≥n de conversi√≥n se encuentra aqu√≠: https://en.wikipedia.org/wiki/Gamma_distribution</span></span>
<span>mean <span class="op">=</span> <span class="va">shape</span><span class="op">*</span><span class="va">scale</span>,</span>
<span>sd <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">shape</span><span class="op">*</span><span class="va">scale</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb156">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtener la media, desviaci√≥n est√°ndar y 95% CrI</span></span>
<span></span>
<span><span class="va">si_summary_gamma</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">si_samples_gamma</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>mean_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>mean_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>mean_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sd_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sd_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sd_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_samples_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb158">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_gamma</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_summary_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb160">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga las mismas estad√≠sticas de resumen para los par√°metros de la distribuci√≥n</span></span>
<span><span class="va">si_samples_gamma</span> <span class="op">|&gt;</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>shape_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>shape_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>shape_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>scale_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>scale_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>scale_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_samples_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb162">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Necesita esto para hacer gr√°ficos m√°s tarde</span></span>
<span><span class="va">gamma_shape</span> <span class="op">&lt;-</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'shape'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb164">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gamma_rate</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'scale'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_gamma' not found</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="ajuste-de-una-distribuci√≥n-log-normal-para-el-intervalo-serial">8.2.3. Ajuste de una distribuci√≥n log normal para el intervalo
serial<a class="anchor" aria-label="anchor" href="#ajuste-de-una-distribuci%C3%B3n-log-normal-para-el-intervalo-serial"></a></h4>
<p>Ahora, ajuste una distribuci√≥n log normal a los datos del intervalo
serial.</p>
<div class="codewrapper sourceCode" id="cb166">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ejecute el modelo durante 4000 iteraciones, descartando las primeras 1000 muestras como burning</span></span>
<span><span class="va">n_mcmc_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># n√∫mero de muestras a extraer de la posterior (despu√©s del burning)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="st">"L"</span>, <span class="co"># Ajustando una distribuci√≥n log-normal para el Intervalo Serial (SI)</span></span>
<span>  method <span class="op">=</span> <span class="st">"MCMC"</span>, <span class="co"># MCMC usando coarsedatatools</span></span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># n√∫mero de muestras de burning (muestras descartadas al comienzo de MCMC) </span></span>
<span>  n1 <span class="op">=</span> <span class="fl">50</span>, <span class="co"># n1 es el n√∫mero de pares de media y desviaci√≥n est√°ndar de SI que se extraen</span></span>
<span>  n2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># n2 es el tama√±o de la muestra posterior extra√≠da para cada par de media y desviaci√≥n est√°ndar de SI</span></span>
<span></span>
<span></span>
<span><span class="va">mcmc_control</span> <span class="op">&lt;-</span> <span class="fu">make_mcmc_control</span><span class="op">(</span></span>
<span>seed <span class="op">=</span> <span class="va">MCMC_seed</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">burnin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">dist</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span></span>
<span><span class="fu">list</span><span class="op">(</span></span>
<span>si_parametric_distr <span class="op">=</span> <span class="va">dist</span>,</span>
<span>mcmc_control <span class="op">=</span> <span class="va">mcmc_control</span>,</span>
<span>seed <span class="op">=</span> <span class="va">overall_seed</span>,</span>
<span>n1 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>n2 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ajuste del intervalo serial</span></span>
<span><span class="va">si_fit_lnorm</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu">dic.fit.mcmc</span><span class="op">(</span></span>
<span>dat <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>init.pars <span class="op">=</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">burnin</span>,</span>
<span>n.samples <span class="op">=</span> <span class="va">n_mcmc_samples</span>,</span>
<span>seed <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_data' not found</code></pre>
</div>
<p>Revise los resultados.</p>
<div class="codewrapper sourceCode" id="cb168">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise la convergencia de las cadenas MCMC </span></span>
<span><span class="va">converg_diag_lnorm</span> <span class="op">&lt;-</span> <span class="fu">check_cdt_samples_convergence</span><span class="op">(</span><span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb170">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">converg_diag_lnorm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'converg_diag_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb172">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Guarde las muestras de MCMC en un dataframe</span></span>
<span><span class="va">si_samples_lnorm</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>type <span class="op">=</span> <span class="st">'Symptom onset'</span>,</span>
<span>meanlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>,</span>
<span>sdlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span>,</span>
<span>p50 <span class="op">=</span> <span class="fu">qlnorm</span><span class="op">(</span></span>
<span>p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>meanlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>, </span>
<span>sdlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">mutate</span><span class="op">(</span> <span class="co"># La ecuaci√≥n para la conversi√≥n est√° aqu√≠ https://en.wikipedia.org/wiki/Log-normal_distribution</span></span>
<span>mean <span class="op">=</span> <span class="fu">exp</span><span class="op">(</span><span class="va">meanlog</span> <span class="op">+</span> <span class="op">(</span><span class="va">sdlog</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>sd <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">sdlog</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">meanlog</span> <span class="op">+</span> <span class="va">sdlog</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb174">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga la media, desviaci√≥n est√°ndar e intervalo de credibilidad del 95% </span></span>
<span><span class="va">si_summary_lnorm</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">si_samples_lnorm</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>mean_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>mean_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>mean_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sd_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sd_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sd_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_samples_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb176">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_lnorm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_summary_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb178">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga las estad√≠sticas reumen para los par√°metros de la distribuci√≥n</span></span>
<span><span class="va">si_samples_lnorm</span> <span class="op">|&gt;</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>meanlog_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">meanlog</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>meanlog_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">meanlog</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>meanlog_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">meanlog</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sdlog_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sdlog</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sdlog_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sdlog</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sdlog_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sdlog</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_samples_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb180">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lognorm_meanlog</span> <span class="op">&lt;-</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'meanlog'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb182">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lognorm_sdlog</span> <span class="op">&lt;-</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'sdlog'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_lnorm' not found</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="ajuste-de-una-distribuci√≥n-weibull-para-el-intervalo-serial">8.2.4. Ajuste de una distribuci√≥n Weibull para el intervalo
serial<a class="anchor" aria-label="anchor" href="#ajuste-de-una-distribuci%C3%B3n-weibull-para-el-intervalo-serial"></a></h4>
<p>Finalmente, ajuste de una distribuci√≥n Weibull para los datos del
intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb184">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ejecutaremos el modelo durante 4000 iteraciones, descartando las primeras 1000 muestras como burning</span></span>
<span><span class="va">n_mcmc_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># n√∫mero de muestras a extraer de la posterior (despu√©s del burning)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="st">"W"</span>, <span class="co"># Ajustando una distribuci√≥n Weibull para el Intervalo Serial (SI)</span></span>
<span>  method <span class="op">=</span> <span class="st">"MCMC"</span>, <span class="co"># MCMC usando coarsedatatools</span></span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># n√∫mero de muestras de burning (muestras descartadas al comienzo de MCMC) </span></span>
<span>  n1 <span class="op">=</span> <span class="fl">50</span>, <span class="co"># n1 es el n√∫mero de pares de media y desviaci√≥n est√°ndar de SI que se extraen</span></span>
<span>  n2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># n2 es el tama√±o de la muestra posterior extra√≠da para cada par de media y desviaci√≥n est√°ndar de SI</span></span>
<span></span>
<span><span class="va">mcmc_control</span> <span class="op">&lt;-</span> <span class="fu">make_mcmc_control</span><span class="op">(</span></span>
<span>seed <span class="op">=</span> <span class="va">MCMC_seed</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">burnin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">dist</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span></span>
<span><span class="fu">list</span><span class="op">(</span></span>
<span>si_parametric_distr <span class="op">=</span> <span class="va">dist</span>,</span>
<span>mcmc_control <span class="op">=</span> <span class="va">mcmc_control</span>,</span>
<span>seed <span class="op">=</span> <span class="va">overall_seed</span>,</span>
<span>n1 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>n2 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ajuste el intervalo serial </span></span>
<span><span class="va">si_fit_weibull</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu">dic.fit.mcmc</span><span class="op">(</span></span>
<span>dat <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>init.pars <span class="op">=</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">burnin</span>,</span>
<span>n.samples <span class="op">=</span> <span class="va">n_mcmc_samples</span>,</span>
<span>seed <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_data' not found</code></pre>
</div>
<p>Revise los resultados.</p>
<div class="codewrapper sourceCode" id="cb186">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise covengencia</span></span>
<span><span class="va">converg_diag_weibull</span> <span class="op">&lt;-</span> <span class="fu">check_cdt_samples_convergence</span><span class="op">(</span><span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_weibull' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb188">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">converg_diag_weibull</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'converg_diag_weibull' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb190">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Guarde las muestra MCMC en un dataframe</span></span>
<span><span class="va">si_samples_weibull</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>type <span class="op">=</span> <span class="st">'Symptom onset'</span>,</span>
<span>shape <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>,</span>
<span>scale <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span>,</span>
<span>p50 <span class="op">=</span> <span class="fu">qweibull</span><span class="op">(</span></span>
<span>p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>shape <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>, </span>
<span>scale <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">mutate</span><span class="op">(</span> <span class="co"># La cuaci√≥n para conversi√≥n est√° aqu√≠ https://en.wikipedia.org/wiki/Weibull_distribution</span></span>
<span>mean <span class="op">=</span> <span class="va">scale</span><span class="op">*</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span>,</span>
<span>sd <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">scale</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_weibull' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb192">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga las estad√≠sticas resumen</span></span>
<span><span class="va">si_summary_weibull</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">si_samples_weibull</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>mean_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>mean_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>mean_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sd_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sd_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sd_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_samples_weibull' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb194">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_weibull</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_summary_weibull' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb196">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga las estad√≠sticas resumen para los par√°metros de la distribuci√≥n.</span></span>
<span><span class="va">si_samples_weibull</span> <span class="op">|&gt;</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>shape_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>shape_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>shape_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>scale_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>scale_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>scale_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_samples_weibull' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb198">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weibull_shape</span> <span class="op">&lt;-</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'shape'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_weibull' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb200">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weibull_scale</span> <span class="op">&lt;-</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'scale'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_weibull' not found</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="grafique-los-resultados-para-el-intervalo-serial">8.2.5. Grafique los resultados para el intervalo serial<a class="anchor" aria-label="anchor" href="#grafique-los-resultados-para-el-intervalo-serial"></a></h4>
<p>Ahora, grafique el ajuste de las tres distribuciones. Aseg√∫rese que
la distribuci√≥n ajuste bien los datos del intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb202">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">contacts</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">diff</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"#FFAD05"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">10</span>,<span class="fl">12</span>,<span class="fl">14</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    linewidth<span class="op">=</span><span class="fl">.8</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span><span class="op">(</span><span class="fu">dgamma</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">gamma_shape</span>, rate <span class="op">=</span> <span class="va">gamma_rate</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>linetype  <span class="op">=</span> <span class="st">'Gamma'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    linewidth<span class="op">=</span><span class="fl">.8</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">meanlog</span>, <span class="va">sdlog</span><span class="op">)</span><span class="op">(</span><span class="fu">dlnorm</span><span class="op">(</span><span class="va">z</span>, <span class="va">meanlog</span>, <span class="va">sdlog</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>meanlog <span class="op">=</span> <span class="va">lognorm_meanlog</span>, sdlog <span class="op">=</span> <span class="va">lognorm_sdlog</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span><span class="st">'Log normal'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    linewidth<span class="op">=</span><span class="fl">.8</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">scale</span><span class="op">)</span><span class="op">(</span><span class="fu">dweibull</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">scale</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">weibull_shape</span>, scale <span class="op">=</span> <span class="va">weibull_scale</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span><span class="st">'Weibull'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'solid'</span>,<span class="st">'twodash'</span>,<span class="st">'dotted'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days"</span>, y <span class="op">=</span> <span class="st">"Number of case pairs"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">5.2</span>,<span class="fl">.2</span>,<span class="fl">.2</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'contacts' not found</code></pre>
</div>
<p>Ahora calcule el WAIC y LOOIC. <code>coarseDataTools</code> no tiene
una forma integrada de hacer esto, por lo que se necesita calcular la
verosimilitud a partir de las cadenas MCMC y utilizar el paquete
<code>loo</code> en R.</p>
<div class="codewrapper sourceCode" id="cb204">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cargue las funciones de verosimilitud de coarseDataTools</span></span>
<span><span class="va">calc_looic_waic</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">symp</span>, <span class="va">symp_si</span>, <span class="va">dist</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="co"># Prepare los datos y par√°metros para el paquete loo</span></span>
<span><span class="co"># Se necesita: una matriz de tama√±o S por N, donde S es el tama√±o de la muestra posterior (con todas las cadenas fusionadas)</span></span>
<span><span class="co"># y N es el n√∫mero de puntos de datos</span></span>
<span></span>
<span>  </span>
<span>  <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fu">length</span><span class="op">(</span><span class="va">symp_si</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">si_data</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">nrow</span><span class="op">(</span><span class="va">symp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span><span class="op">(</span><span class="va">symp_si</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu">diclik2</span><span class="op">(</span>par1 <span class="op">=</span> <span class="va">symp_si</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>                 par2 <span class="op">=</span> <span class="va">symp_si</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, </span>
<span>                 EL <span class="op">=</span> <span class="va">symp</span><span class="op">$</span><span class="va">EL</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, ER <span class="op">=</span> <span class="va">symp</span><span class="op">$</span><span class="va">ER</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, SL <span class="op">=</span> <span class="va">symp</span><span class="op">$</span><span class="va">SL</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, SR <span class="op">=</span> <span class="va">symp</span><span class="op">$</span><span class="va">SR</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                 dist <span class="op">=</span> <span class="va">dist</span><span class="op">)</span></span>
<span>    <span class="va">mat</span><span class="op">[</span><span class="va">j</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">L</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>waic <span class="op">=</span> <span class="fu">waic</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              looic <span class="op">=</span> <span class="fu">loo</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># now we have to take the log to get log likelihood</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">compare_gamma</span> <span class="op">&lt;-</span> <span class="fu">calc_looic_waic</span><span class="op">(</span>symp <span class="op">=</span> <span class="va">si_data</span>, symp_si <span class="op">=</span> <span class="va">si_fit_gamma</span>, dist <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb206">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_lnorm</span> <span class="op">&lt;-</span> <span class="fu">calc_looic_waic</span><span class="op">(</span>symp <span class="op">=</span> <span class="va">si_data</span>, symp_si <span class="op">=</span> <span class="va">si_fit_lnorm</span>, dist <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb208">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_weibull</span> <span class="op">&lt;-</span> <span class="fu">calc_looic_waic</span><span class="op">(</span>symp <span class="op">=</span> <span class="va">si_data</span>, symp_si <span class="op">=</span> <span class="va">si_fit_weibull</span>, dist <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_fit_weibull' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb210">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imprima resultados</span></span>
<span><span class="va">compare_gamma</span><span class="op">[[</span><span class="st">"waic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'compare_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb212">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_lnorm</span><span class="op">[[</span><span class="st">"waic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'compare_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb214">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_weibull</span><span class="op">[[</span><span class="st">"waic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'compare_weibull' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb216">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_gamma</span><span class="op">[[</span><span class="st">"looic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'compare_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb218">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_lnorm</span><span class="op">[[</span><span class="st">"looic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'compare_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb220">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_weibull</span><span class="op">[[</span><span class="st">"looic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'compare_weibull' not found</code></pre>
</div>
<p>Incluya lo siguiente cuando reporte el intervalo serial:</p>
<ul><li><p>Media e intervalo de credibilidad del 95%</p></li>
<li><p>Desviaci√≥n est√°ndar y e intervalo de credibilidad del
95%</p></li>
<li><p>Los par√°metros de la distribuci√≥n ajustada (e.g., shape y scale
para distribuci√≥n gamma)</p></li>
</ul><div class="alert alert-secondary">
<p><em>üí° <strong>Preguntas (7)</strong></em></p>
<ul><li>¬øQu√© distribuci√≥n tiene el menor WAIC y LOOIC??</li>
</ul></div>
<div class="codewrapper sourceCode" id="cb222">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_gamma</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_summary_gamma' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb224">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_lnorm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_summary_lnorm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb226">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_weibull</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'si_summary_weibull' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="pausa-3-_________"><em><code>_______Pausa 3 _________</code></em><a class="anchor" aria-label="anchor" href="#pausa-3-_________"></a></h1>
<div class="section level2">
<h2 id="medidas-de-control">9. Medidas de control<a class="anchor" aria-label="anchor" href="#medidas-de-control"></a></h2>
<div class="section level3">
<h3 id="analicemos-el-resultado-juntos">9.1 Analicemos el resultado juntos<a class="anchor" aria-label="anchor" href="#analicemos-el-resultado-juntos"></a></h3>
<div class="alert alert-secondary">
<p>Ahora ha finalizado el an√°lisis estad√≠stico ü•≥</p>
<ul><li><p>Compare el per√≠odo de incubaci√≥n y el intervalo serial.</p></li>
<li><p>¬øCu√°l es m√°s largo?</p></li>
<li><p>¬øOcurre la transmisi√≥n pre-sintom√°tica con la Enfermedad
X?</p></li>
</ul><!-- --><ul><li><p>¬øSer√°n medidas efectivas aislar a los individuos sintom√°ticos y
rastrear y poner en cuarentena a sus contactos?</p></li>
<li><p>Si no lo son, ¬øqu√© otras medidas se pueden implementar para
frenar el brote?</p></li>
</ul></div>
</div>
<div class="section level3">
<h3 id="dise√±o-de-una-estrateg√≠a-de-rastreo-de-contactos">9.2 Dise√±o de una estrateg√≠a de rastreo de contactos<a class="anchor" aria-label="anchor" href="#dise%C3%B1o-de-una-estrateg%C3%ADa-de-rastreo-de-contactos"></a></h3>
<p>Basado en los rezagos estimados as√≠ como la demograf√≠a de los casos,
dise√±e una estrategia de rastreo de contactos para el brote, incluyendo
un plan de comunicaciones (Pista: piense sobre la log√≠stica).</p>
</div>
</div>
<div class="section level2">
<h2 id="valores-verdaderos">10. Valores verdaderos<a class="anchor" aria-label="anchor" href="#valores-verdaderos"></a></h2>
<p>Los valores verdaderos usados para simular las epidem√≠as fueron:</p>
<table style="width:96%;" class="table"><caption>Tabla 2. Valores verdaderos del <strong><em>per√≠odo de
incubaci√≥n.</em></strong>
</caption>
<colgroup><col width="19%"><col width="21%"><col width="19%"><col width="33%"><col width="2%"></colgroup><tbody><tr class="odd"><td></td>
<td>Distribuci√≥n</td>
<td colspan="3">Media (d√≠as) | Desviaci√≥n est√°ndar (d√≠as)</td>
</tr><tr class="even"><td>Grupo 1</td>
<td>Log normal</td>
<td>5.7</td>
<td>4.6</td>
<td></td>
</tr><tr class="odd"><td>Grupo 2</td>
<td>Weibull</td>
<td>7.1</td>
<td>3.7</td>
<td></td>
</tr></tbody></table><table style="width:96%;" class="table"><caption>Tabla 3. Valores verdaderos del <strong><em>intervalo
serial</em></strong>.</caption>
<colgroup><col width="18%"><col width="22%"><col width="18%"><col width="34%"><col width="2%"></colgroup><tbody><tr class="odd"><td></td>
<td>Distribuci√≥n</td>
<td colspan="3">Media (d√≠as) | Desviaci√≥n est√°ndar (d√≠as)</td>
</tr><tr class="even"><td>Group 1</td>
<td>Gamma</td>
<td>8.4</td>
<td>4.9</td>
<td></td>
</tr><tr class="odd"><td>Group 2</td>
<td>Gamma</td>
<td>4.8</td>
<td>3.3</td>
<td></td>
</tr></tbody></table><p>¬øC√≥mo se comparan sus estimaciones con los valores verdaderos?
Discuta las posibles razones para las diferencias.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<p>Revise si al final de esta lecci√≥n adquiri√≥ estas competencias:</p>
<ul><li><p>Comprender los conceptos clave de las distribuciones de retrasos
epidemiol√≥gicos para la Enfermedad X.</p></li>
<li><p>Entender las estructuras de datos y las herramientas para el
an√°lisis de datos de rastreo de contactos.</p></li>
<li><p>Aprender c√≥mo ajustar las estimaciones del intervalo serial y del
per√≠odo de incubaci√≥n de la Enfermedad X teniendo en cuenta la censura
por intervalo usando un marco de trabajo Bayesiano.</p></li>
<li><p>Aprender a utilizar estos par√°metros para informar estrategias de
control en un brote de un pat√≥geno desconocido.</p></li>
</ul></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="recursos-adicionales">11. Recursos adicionales<a class="anchor" aria-label="anchor" href="#recursos-adicionales"></a></h2>
<p>En este pr√°ctica, en gran medida se ignoraron los sesgos de
truncamiento a la derecha y sesgo din√°mico, en parte debido a la falta
de herramientas f√°cilmente disponibles que implementen las mejores
pr√°cticas. Para aprender m√°s sobre c√≥mo estos sesgos podr√≠an afectar la
estimaci√≥n de las distribuciones de retraso epidemiol√≥gico en tiempo
real, recomendamos un tutorial sobre el paquete
<code>dynamicaltruncation</code> en R de Sam Abbott y Sang Woo Park (<a href="https://github.com/parksw3/epidist-paper" class="external-link uri">https://github.com/parksw3/epidist-paper</a>).</p>
</div>
<div class="section level2">
<h2 id="contribuidores">12. Contribuidores<a class="anchor" aria-label="anchor" href="#contribuidores"></a></h2>
<p>Kelly Charniga, Zachary Madewell, Zulma M. Cucunub√°</p>
</div>
<div class="section level2">
<h2 id="referencias">13. Referencias<a class="anchor" aria-label="anchor" href="#referencias"></a></h2>
<ol style="list-style-type: decimal"><li>Reich NG et al.¬†Estimating incubation period distributions with
coarse data. Stat Med. 2009;28:2769‚Äì84. PubMed <a href="https://doi.org/10.1002/sim.3659" class="external-link uri">https://doi.org/10.1002/sim.3659</a>
</li>
<li>Miura F et al.¬†Estimated incubation period for monkeypox cases
confirmed in the Netherlands, May 2022. Euro Surveill.
2022;27(24):pii=2200448. <a href="https://doi.org/10.2807/1560-7917.ES.2022.27.24.2200448" class="external-link uri">https://doi.org/10.2807/1560-7917.ES.2022.27.24.2200448</a>
</li>
<li>Abbott S, Park Sang W. Adjusting for common biases in infectious
disease data when estimating distributions. 2022 [cited 7 November
2023]. <a href="https://github.com/parksw3/dynamicaltruncation" class="external-link uri">https://github.com/parksw3/dynamicaltruncation</a>
</li>
<li>Lessler J et al.¬†Incubation periods of acute respiratory viral
infections: a systematic review, The Lancet Infectious Diseases.
2009;9(5):291-300. <a href="https://doi.org/10.1016/S1473-3099(09)70069-6" class="external-link uri">https://doi.org/10.1016/S1473-3099(09)70069-6</a>.</li>
<li>Cori A et al.¬†Estimate Time Varying Reproduction Numbers from
Epidemic Curves. 2022 [cited 7 November 2023]. <a href="https://github.com/mrc-ide/EpiEstim" class="external-link uri">https://github.com/mrc-ide/EpiEstim</a>
</li>
<li>Lambert B. A Student‚Äôs Guide to Bayesian Statistics. Los Angeles,
London, New Delhi, Singapore, Washington DC, Melbourne: SAGE, 2018.</li>
<li>Vehtari A et al.¬†Rank-normalization, folding, and localization: An
improved R-hat for assessing convergence of MCMC. Bayesian Analysis
2021: Advance publication 1-28. <a href="https://doi.org/10.1214/20-BA1221" class="external-link uri">https://doi.org/10.1214/20-BA1221</a>
</li>
<li>Nishiura H et al.¬†Serial interval of novel coronavirus (COVID-19)
infections. Int J Infect Dis. 2020;93:284-286. <a href="https://doi.org/10.1016/j.ijid.2020.02.060" class="external-link uri">https://doi.org/10.1016/j.ijid.2020.02.060</a>
</li>
</ol><!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 --></div>
</div>



      </div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="EnfermedadX.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="Sivirep-tutorial.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="EnfermedadX.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Taller D√≠a 4 - Grupo
        </a>
        <a class="chapter-link float-end" href="Sivirep-tutorial.html" rel="next">
          Next: Taller sivirep... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/Joskerus/Nuevoformato/edit/main/episodes/EnfermedadX2.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/Joskerus/Nuevoformato/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/Joskerus/Nuevoformato/" class="external-link">Source</a></p>
				<p><a href="https://github.com/Joskerus/Nuevoformato/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/translate-spanish" class="external-link">sandpaper (0.15.0.9000)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/1bc5753e917d515c3d888ce6cc013c0a680eacfc" class="external-link">pegboard (0.7.3)</a>,
      and <a href="https://github.com/epiverse-trace/varnish/tree/tracelactheme" class="external-link">varnish (0.3.3.9000)</a>.</p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://Joskerus.github.io/Nuevoformato/EnfermedadX2.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Taller D√≠a 4 - Grupo 2 - Estimaci√≥n de las distribuciones de rezagos epidemiol√≥gicos: Enfermedad X",
  "creativeWorkStatus": "active",
  "url": "https://Joskerus.github.io/Nuevoformato/EnfermedadX2.html",
  "identifier": "https://Joskerus.github.io/Nuevoformato/EnfermedadX2.html",
  "dateCreated": "2023-11-10",
  "dateModified": "2023-12-07",
  "datePublished": "2023-12-07"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

