<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="es">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Análisis de Brotes y Modelamiento en Salud Pública: Todo en una sola página</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Ir al contenido principal</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Epiverse-TRACE" src="assets/images/logo_epimodelac.png"><abbr class="badge badge-light" title="Esta lección se encuentra en la fase pre-alfa, lo que significa que está en las primeras etapas de desarrollo, pero aún no se ha enseñado." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #FFF">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alfa
          </a>
          <span class="visually-hidden">Esta lección se encuentra en la fase pre-alfa, lo que significa que está en las primeras etapas de desarrollo, pero aún no se ha enseñado.</span>
        </abbr>

      </div>
    </div>
    <div class="selector-container">


      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Vista de estudiante <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Vista de la instructora</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Navegación principal"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Alternar navegación">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menú</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Epiverse-TRACE" src="assets/images/epiverse-logo.svg">
</div>
    <div class="lesson-title-md">
      Análisis de Brotes y Modelamiento en Salud Pública
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Buscar en la página All In One" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Análisis de Brotes y Modelamiento en Salud Pública
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Puntos Clave</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glosario</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Perfiles de estudiante</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Más <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="" aria-label=""><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Buscar en la página All In One"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Análisis de Brotes y Modelamiento en Salud Pública
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Progreso de la lección" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="Cerrar menú" alt="Cerrar menú" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Cerrar " data-episodes="Episodios ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Vista de estudiante
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Vista de la instructora</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODIOS
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Resumen y configuración</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="TallerIntroAnaliticaBrotes.html">1. Introducción a la analítica de brotes</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="ZIKAB.html">2. Construyendo un modelo matemático simple para Zika</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="EnfermedadX.html">3. Estimación de las distribuciones de rezagos epidemiológicos: Enfermedad X</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="Sivirep-tutorial.html">4. Generar reportes a partir de bases de datos de vigilancia epidemiológica usando sivirep</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="Serofoi-tutorial.html">5. Estima la fuerza de infección a partir de encuestas serológicas usando serofoi</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="Vaccineff-tutorial.html">6. Introducción al cálculo de efectividad vacunal con cohortes usando vaccineff</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="epiCo-tutorial.html">7. Indicadores demográficos, canales endémicos y clusters de incidencia usando epiCo</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RECURSOS
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Puntos Clave</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glosario</a>
                      </li>
                      <li>
                        <a href="profiles.html">Perfiles de estudiante</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">Todo en una sola página</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-TallerIntroAnaliticaBrotes"><p>Content from <a href="TallerIntroAnaliticaBrotes.html">Introducción a la analítica de brotes</a></p>
<hr>
<p>Última actualización: 2025-03-13 |

        <a href="https://github.com/epiverse-trace/epimodelac/edit/main/episodes/TallerIntroAnaliticaBrotes.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo modelar y analizar un brote?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<p>Al final de este taller usted podrá:</p>
<ul>
<li><p>Identificar los parámetros necesarios en casos de transmisión de
enfermedades infecciosas de persona a persona.</p></li>
<li><p>Estimar la probabilidad de muerte (CFR).</p></li>
<li><p>Calcular y graficar la incidencia.</p></li>
<li><p>Estimar e interpretar la tasa de crecimiento y el tiempo en que
se duplica la epidemia.</p></li>
<li><p>Estimar e interpretar el número de reproducción instantáneo de la
epidemia.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="tiempos-de-ejecución">Tiempos de ejecución<a class="anchor" aria-label="anchor" href="#tiempos-de-ejecuci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>Explicación del taller (10 minutos)</p>
<p>Realización del taller (100 minutos taller)</p>
<ul>
<li><p>Parte 1: Estructura de datos y CFR (15 min)</p></li>
<li><p>Parte 2: Incidencia y tasa de crecimiento (45 min)</p></li>
<li><p>Parte 3: Rt (40 min)</p></li>
</ul>
<p>Discusión 30 minutos</p>
</section><section><h2 class="section-heading" id="introducción">Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>Un nuevo brote de virus del Ébola (EVE) en un país ficticio de África
occidental</p>
<div class="section level4">
<h4 id="conceptos-básicos-a-desarrollar">Conceptos básicos a desarrollar<a class="anchor" aria-label="anchor" href="#conceptos-b%C3%A1sicos-a-desarrollar"></a>
</h4>
<p>En esta práctica se desarrollarán los siguientes conceptos:</p>
<ul>
<li><p>Transmisión de enfermedades infecciosas de persona a
persona</p></li>
<li><p>Número de reproducción básico</p></li>
<li><p>Número de reproducción instantáneo</p></li>
<li><p>Probabilidad de muerte (IFR, CFR)</p></li>
<li><p>Intervalo serial</p></li>
<li><p>Tasa de crecimiento</p></li>
<li><p>Incidencia</p></li>
</ul>
<div id="preparación-previa" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="preparación-previa" class="callout-inner">
<h3 class="callout-title">Preparación previa</h3>
<div class="callout-content">
<p>Antes de comenzar,</p>
<ol style="list-style-type: decimal">
<li><p>descargue la carpeta con los datos y el proyecto desde <a href="https://drive.google.com/drive/folders/1T0uZ2FNhwFAnFcCNxfLX8V6Ir3IsJO6y?usp=sharing" class="external-link">Carpetas
de datos</a> .</p></li>
<li><p>Ahí mismo encontrará un archivo <code>.R</code> para instalar las
dependencias necesarias para este taller.</p></li>
<li><p>Recuerde abrir el archivo <code>RProject</code> denominado
<code>Taller-Brotes-Ebola.Rproj</code> antes de empezar a
trabajar.</p></li>
</ol>
<p>Este paso no solo le ayudará a cumplir con las buenas prácticas de
programación en R, sino también a mantener un directorio organizado,
permitiendo un desarrollo exitoso del taller.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="estructura-de-datos">1. Estructura de datos<a class="anchor" aria-label="anchor" href="#estructura-de-datos"></a>
</h2>
<hr class="half-width">
<div class="section level4">
<h4 id="cargue-de-librerías">Cargue de librerías:<a class="anchor" aria-label="anchor" href="#cargue-de-librer%C3%ADas"></a>
</h4>
<p>Cargue las librerías necesarias para el análisis epidemiológico. Los
datos serán manipulados con tidyverse que es una colección de paquetes
para la ciencia de datos.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span> <span class="co"># contiene ggplot2, dplyr, tidyr, readr, purrr, tibble</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">readxl</span><span class="op">)</span> <span class="co"># para leer archivos Excel</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">binom</span><span class="op">)</span> <span class="co"># para intervalos de confianza binomiales</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">knitr</span><span class="op">)</span> <span class="co"># para crear tablas bonitas con kable()</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span> <span class="co"># para calcular incidencia y ajustar modelos</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EpiEstim</span><span class="op">)</span> <span class="co"># para estimar R(t)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="cargue-de-bases-de-datos">Cargue de bases de datos<a class="anchor" aria-label="anchor" href="#cargue-de-bases-de-datos"></a>
</h4>
<p>Se le ha proporcionado la siguiente base de datos:</p>
<ul>
<li>
<code>casos</code>: una base de datos de casos que contiene
información de casos hasta el 1 de julio de 2014.</li>
</ul>
<p>Para leer en R este archivo, utilice la función <code>read_rds</code>
de <code>tidyverse</code>. Se creará una tabla de datos almacenada como
objeto de clase <code>tibble.</code></p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">casos</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/casos.rds"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="estructura-de-los-datos">Estructura de los datos<a class="anchor" aria-label="anchor" href="#estructura-de-los-datos"></a>
</h4>
<p>Explore la estructura de los datos. Para esto puede utilizar la
función <code>glimpse</code> de <code>tidyverse</code>, la cual nos
proporciona una visión rápida y legible de la estructura interna de
nuestro conjunto de datos.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">casos</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 166
Columns: 11
$ id_caso                  &lt;chr&gt; "d1fafd", "53371b", "f5c3d8", "6c286a", "0f58…
$ generacion               &lt;dbl&gt; 0, 1, 1, 2, 2, 0, 3, 3, 2, 3, 4, 3, 4, 2, 4, …
$ fecha_de_infeccion       &lt;date&gt; NA, 2014-04-09, 2014-04-18, NA, 2014-04-22, …
$ fecha_inicio_sintomas    &lt;date&gt; 2014-04-07, 2014-04-15, 2014-04-21, 2014-04-…
$ fecha_de_hospitalizacion &lt;date&gt; 2014-04-17, 2014-04-20, 2014-04-25, 2014-04-…
$ fecha_desenlace          &lt;date&gt; 2014-04-19, NA, 2014-04-30, 2014-05-07, 2014…
$ desenlace                &lt;chr&gt; NA, NA, "Recuperacion", "Muerte", "Recuperaci…
$ genero                   &lt;fct&gt; f, m, f, f, f, f, f, f, m, m, f, f, f, f, f, …
$ hospital                 &lt;fct&gt; Military Hospital, Connaught Hospital, other,…
$ longitud                 &lt;dbl&gt; -13.21799, -13.21491, -13.22804, -13.23112, -…
$ latitud                  &lt;dbl&gt; 8.473514, 8.464927, 8.483356, 8.464776, 8.452…</code></pre>
</div>
<p>Como puede observar contactos tiene 11 columnas (variables) y 166
filas de datos. En un rápido vistazo puede observar el tipo de las
variables por ejemplo, la columna <code>desenlace</code> tiene formato
carácter (<code>chr</code>) y contiene entre sus valores
<code>"Recuperación"</code> o <code>"Muerte"</code>.</p>
<p>Además, puede encontrar estas variables:</p>
<ul>
<li><p>El identificador <code>id_caso</code></p></li>
<li><p>La generación de infectados (cuantas infecciones secundarias
desde la fuente hasta el sujeto han ocurrido)</p></li>
<li><p>La fecha de infección</p></li>
<li><p>La fecha de inicio de síntomas</p></li>
<li><p>La fecha de hospitalización</p></li>
<li><p>La fecha del desenlace que, como se puede observar, en la
siguiente variable puede tener entre sus opciones <code>NA</code> (no
hay información hasta ese momento o no hay registro), recuperación y
muerte</p></li>
<li><p>La variable género que puede ser <code>f</code> de femenino o
<code>m</code> de masculino</p></li>
<li><p>El lugar de hospitalización, en la variable hospital</p></li>
<li><p>Y las variables longitud y latitud</p></li>
</ul>
<p>Note que las fechas ya están en formato fecha
(<code>date</code>).</p>
</div>
</section><section><h2 class="section-heading" id="cfr">2. CFR<a class="anchor" aria-label="anchor" href="#cfr"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="probabilidad-de-muerte-en-los-casos-reportados-cfr-por-case-fatality-risk">Probabilidad de muerte en los casos reportados (<code>CFR</code>,
por <em>Case Fatality Risk</em>)<a class="anchor" aria-label="anchor" href="#probabilidad-de-muerte-en-los-casos-reportados-cfr-por-case-fatality-risk"></a>
</h3>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">casos</span><span class="op">$</span><span class="va">desenlace</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
      Muerte Recuperacion         &lt;NA&gt;
          60           43           63 </code></pre>
</div>
<div id="desafío-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-1" class="callout-inner">
<h3 class="callout-title">Desafío 1</h3>
<div class="callout-content">
<p>Calcule la probabilidad de muerte en los casos reportados
(<code>CFR</code>) tomando el número de muertes y el número de casos con
desenlace final conocido del objeto <code>casos</code>. Esta vez se
calculará el <code>CFR</code> con el método <em>Naive</em>. Los cálculos
<em>Naive</em> (<em>inocentes</em>) tienen el problema de que pueden
presentar sesgos, por lo que no deberían ser utilizados para informar
decisiones de salud pública. Hablaremos de estos sesgos en profundidad
en el día 4.</p>
<p>Durante este taller se le presentarán algunos retos, para los cuales
obtendrá algunas pistas, por ejemplo en el presente reto se le presenta
una pista, la cual es un fragmento del código que usted debe completar
para alcanzar la solución. En los espacios donde dice
<code>COMPLETE</code> por favor diligencie el código faltante.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">muertes</span> <span class="op">&lt;-</span>  <span class="va">COMPLETE</span></span>
<span></span>
<span><span class="va">casos_desenlace_final_conocido</span> <span class="op">&lt;-</span> <span class="fu">sum</span><span class="op">(</span><span class="va">casos</span><span class="op">$</span><span class="va">desenlace</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Muerte"</span>, <span class="st">"Recuperacion"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">CFR</span> <span class="op">&lt;-</span> <span class="va">COMPLETE</span> <span class="op">/</span> <span class="va">COMPLETE</span></span></code></pre>
</div>
<p>Ejemplo,</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reto</span></span>
<span><span class="va">muertes</span> <span class="op">&lt;-</span>  <span class="va">COMPLETE</span></span>
<span><span class="co">#Solución</span></span>
<span><span class="va">muertes</span> <span class="op">&lt;-</span> <span class="fu">sum</span><span class="op">(</span><span class="va">casos</span><span class="op">$</span><span class="va">desenlace</span> <span class="op">%in%</span> <span class="st">"Muerte"</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.5825243</code></pre>
</div>
</div>
</div>
</div>

<p>Para complementar el calculo del CFR se pueden calcular sus
intervalos de confianza por medio de la función
<code>binom.confint</code>. La función <code>binom.confint</code> se
utiliza para calcular intervalos de confianza para una proporción en una
distribución binomial, que corresponde, por ejemplo, a cuando tenemos el
total de infecciones con desenlace final conocido (recuperado o muerte).
Esta función pide tres argumentos: 1) el número de muertes y 2) el
número total de casos con desenlace final conocido, es decir sin
importar que hayan muerto o se hayan recuperado, pero sin cuenta los
datos con <code>NA</code>; 3) el método que se utilizará para calcular
los intervalos de confianza, en este caso “<code>exact</code>” (método
Clopper-Pearson).</p>
<div id="desafío-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="desafío-2" class="callout-inner">
<h3 class="callout-title">Desafío 2</h3>
<div class="callout-content">
<p>Determine el CFR con sus intervalos de confianza utilizando la
función <code>binom.confint</code>. Y obtenga este resultado:</p>
<table class="table">
<caption><strong>CFR con intervalos de confianza</strong></caption>
<thead><tr class="header">
<th align="left">method</th>
<th align="right">x</th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">exact</td>
<td align="right">60</td>
<td align="right">103</td>
<td align="right">0.5825243</td>
<td align="right">0.4812264</td>
<td align="right">0.6789504</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Pista </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Recuerde diligenciar los espacios donde dice <code>COMPLETE</code>. Y
obtenga este resultado</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CFR_con_CI</span> <span class="op">&lt;-</span> <span class="fu">binom.confint</span><span class="op">(</span><span class="va">COMPLETE</span>, <span class="va">COMPLETE</span>, method <span class="op">=</span> <span class="st">"COMPLETE"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"**COMPLETE ¿QUE TITULO LE PONDRÍA?**"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CFR_con_CI</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>

</div>
</section><section><h2 class="section-heading" id="incidencia">3. Incidencia<a class="anchor" aria-label="anchor" href="#incidencia"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="curva-de-incidencia-diaria">3.1. Curva de incidencia diaria<a class="anchor" aria-label="anchor" href="#curva-de-incidencia-diaria"></a>
</h3>
<p>El paquete <code>incidence</code> es de gran utilidad para el
análisis epidemiológico de datos de incidencia de enfermedades
infecciosas, dado que permite calcular la incidencia a partir del
intervalo temporal suministrado (e.g. diario o semanal). Dentro de este
paquete esta la función <code>incidence</code> la cual cuenta con los
siguientes argumentos:</p>
<ol style="list-style-type: decimal">
<li><p><code>dates</code> contiene una variable con fechas que
representan cuándo ocurrieron eventos individuales, como por ejemplo la
fecha de inicio de los síntomas de una enfermedad en un conjunto de
pacientes.</p></li>
<li><p><code>interval</code> es un intervalo de tiempo fijo por el que
se quiere calcular la incidencia. Por ejemplo,
<code>interval = 365</code> para un año. Si no se especifica, el valor
por defecto es diario.</p></li>
<li><p><code>last_date</code> fecha donde se establecerá un limite
temporal para los datos. Por ejemplo, la última fecha de
hospitalización. Para este tercer argumento, podemos incluir la opción
<code>max</code> y la opción <code>na.rm</code>. La primera para obtener
la última fecha de una variable y la segunda para ignorar los
<code>NA</code> en caso de que existan.</p></li>
</ol>
<p>Por ejemplo, se podría escribir
<code>last_date = max(base_de_datos$vector_ultima_fecha, na.rm = TRUE)</code></p>
<p>Con esta información la función agrupa los casos según el intervalo
de tiempo especificado y cuenta el número de eventos (como casos de
enfermedad) que ocurrieron dentro de cada intervalo.</p>
<div id="desafío-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-3" class="callout-inner">
<h3 class="callout-title">Desafío 3</h3>
<div class="callout-content">
<p>Calcule la incidencia diaria usando únicamente el primer argumento de
la función <code>incidence</code> ¿Qué fecha sería la más adecuada?
Tenga en cuenta que se espera que esta sea la que pueda dar mejor
información, es decir la menor cantidad de <code>NA</code>s.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incidencia_diaria</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="op">(</span><span class="va">COMPLETE</span><span class="op">)</span></span>
<span><span class="va">incidencia_diaria</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>El resultado es un objeto de clase incidencia
(<code>incidence</code>) que contiene el recuento de casos para cada
intervalo de tiempo, lo que facilita su visualización y análisis
posterior. Como puede observar la función produjo los siguientes
datos:</p>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;incidence object&gt;
[166 cases from days 2014-04-07 to 2014-06-29]

$counts: matrix with 84 rows and 1 columns
$n: 166 cases in total
$dates: 84 dates marking the left-side of bins
$interval: 1 day
$timespan: 84 days
$cumulative: FALSE</code></pre>
</div>

<p>Como resultado de la función se produjo un objeto tipo lista. Este
objeto arroja estos datos: <code>166 casos</code> contemplados entre los
días <code>2014-04-07</code> al <code>2014-06-29</code> para un total de
<code>84 días</code>; se menciona que el intervalo es de
<code>1 día</code>, dado que no se utilizo específico explicitamente el
parámetro por lo cual quedó su valor por defecto. Finalmente se menciona
“<code>cumulative : FALSE</code>” lo que quiere decir que no se esta
haciendo el acumulado de la incidencia, es decir que los casos
corresponden a los del intervalo <code>interval: 1 day</code>, es decir
a los casos nuevos cada día en específico.</p>
<p>Ahora haga una gráfica de la incidencia diaria.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">incidencia_diaria</span>, border <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>En el <code>Eje X (Fechas)</code>: Se puede observar fechas van desde
el <code>7 de abril de 2014</code> hasta una fecha posterior al
<code>21 de junio de 2014</code>. Estas fechas representan el período de
observación del brote.</p>
<p>En el <code>Eje Y (Incidencia Diaria)</code>: La altura de las barras
indica el número de nuevos casos reportados cada fecha según el tipo de
fecha escogido.</p>
<p>Dado que no se agregó el parámetro <code>interval</code> la
incidencia quedó por defecto diaria, produciéndose un histograma en el
que cada barra representa la incidencia de un día, es decir, los casos
nuevos. Los días sin barras sugieren que no hubo casos nuevos para esa
fecha o que los datos podrían no estar disponibles para esos días.</p>
<p>A pesar de que hay una curva creciente, hay periodos con pocos o
ningún caso. ¿Porque cree que podrían darse estos periodos de pocos a
pesar de la curva creciente?</p>

</div>
<div class="section level3">
<h3 id="cálculo-de-la-incidencia-semanal">3.2. Cálculo de la incidencia semanal<a class="anchor" aria-label="anchor" href="#c%C3%A1lculo-de-la-incidencia-semanal"></a>
</h3>
<p>Teniendo en cuenta lo aprendido con respecto a la incidencia diaria,
cree una variable para incidencia semanal. Luego, interprete el
resultado y haga una gráfica. Para escoger la fecha que utilizará como
última fecha debe asignarle un valor al argumento <code>last_date</code>
de la función <code>incidence</code> ¿Qué fecha sería la más adecuada?
Tenga en cuenta que la fecha debe ser posterior a la fecha que se haya
escogido como el primer argumento.</p>
<div id="desafío-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-4" class="callout-inner">
<h3 class="callout-title">Desafío 4</h3>
<div class="callout-content">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>incidencia_semanal <span class="ot">&lt;-</span> <span class="fu">incidence</span>(PRIMER ARGUMENTO,  <span class="co">#COMPLETE</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>                                SEGUNDO ARGUMENTO, <span class="co">#COMPLETE </span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                                TERCER ARGUMENTO)  <span class="co">#COMPLETE</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;incidence object&gt;
[166 cases from days 2014-04-07 to 2014-06-30]
[166 cases from ISO weeks 2014-W15 to 2014-W27]

$counts: matrix with 13 rows and 1 columns
$n: 166 cases in total
$dates: 13 dates marking the left-side of bins
$interval: 7 days
$timespan: 85 days
$cumulative: FALSE</code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>

<p>Compare la gráfica de incidencia diaria con la de incidencia semanal.
¿Qué observa? ¿Los datos se comportan diferente? ¿Es lo que esperaba?
¿Logra observar alguna tendencia?</p>
</div>
</section><section><h2 class="section-heading" id="tasa-de-crecimiento">4. Tasa de crecimiento<a class="anchor" aria-label="anchor" href="#tasa-de-crecimiento"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="modelo-log-lineal">4.1. Modelo log-lineal<a class="anchor" aria-label="anchor" href="#modelo-log-lineal"></a>
</h3>
<div class="section level4">
<h4 id="estimación-de-la-tasa-de-crecimiento-mediante-un-modelo-log-lineal">Estimación de la tasa de crecimiento mediante un modelo
log-lineal<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-la-tasa-de-crecimiento-mediante-un-modelo-log-lineal"></a>
</h4>
<p>Para observar mejor las tendencias de crecimiento en el número de
casos se puede visualizar la incidencia semanal en una escala
logarítmica. Esto es particularmente útil para identificar patrones
exponenciales en los datos.</p>
<p>Grafique la incidencia transformada logarítmicamente:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">as.data.frame</span><span class="op">(</span><span class="va">incidencia_semanal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dates</span>, y <span class="op">=</span> <span class="fu">log</span><span class="op">(</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_x_incidence</span><span class="op">(</span><span class="va">incidencia_semanal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Semana"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Incidencia semanal logarítmica"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-19-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level4">
<h4 id="interpretación-del-modelo">Ajuste un modelo log-lineal a los datos de incidencia semanal<a class="anchor" aria-label="anchor" href="#interpretaci%C3%B3n-del-modelo"></a>
</h4>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ajuste_modelo</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="fu">::</span><span class="fu">fit</span><span class="op">(</span><span class="va">incidencia_semanal</span><span class="op">)</span></span>
<span><span class="va">ajuste_modelo</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;incidence_fit object&gt;

$model: regression of log-incidence over time

$info: list containing the following items:
  $r (daily growth rate):
[1] 0.04145251

  $r.conf (confidence interval):
          2.5 %     97.5 %
[1,] 0.02582225 0.05708276

  $doubling (doubling time in days):
[1] 16.72148

  $doubling.conf (confidence interval):
        2.5 %   97.5 %
[1,] 12.14285 26.84302

  $pred: data.frame of incidence predictions (12 rows, 5 columns)</code></pre>
</div>
<div id="desafío-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="desafío-5" class="callout-inner">
<h3 class="callout-title">Desafío 5</h3>
<div class="callout-content">
<p>¿Qué observa en este resultado?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Solución </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p><code>$model</code>: Indica que se ha realizado una regresión
logarítmica de la incidencia en función del tiempo. Esto implica que la
relación entre el tiempo y la incidencia de la enfermedad ha sido
modelada como una función lineal en escala logarítmica en la incidencia
con el fin de entender mejor las tendencias de crecimiento.</p>
<p><code>$info</code>: Contiene varios componentes importantes del
análisis:</p>
<ol style="list-style-type: decimal">
<li>
<code>$r (daily growth rate)</code> Tasa de crecimiento diaria:
<code>0.04145251</code>
</li>
</ol>
<p>La tasa de crecimiento diaria estimada del brote es de
<code>0.0415</code>. Esto significa que cada día la cantidad de casos
está creciendo en un <code>4.15%</code> con respecto al día anterior,
bajo la suposición de un crecimiento exponencial constante durante el
periodo modelado.</p>
<p>Si quisiera acceder a esta información sin ingresar al modelo podría
hacerlo con el siguiente código:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tasa_crecimiento_diaria</span> <span class="op">&lt;-</span> <span class="va">ajuste_modelo</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">r</span></span>
<span><span class="fu">cat</span><span class="op">(</span><span class="st">"La tasa de crecimiento diaria es:"</span>, <span class="va">tasa_crecimiento_diaria</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>La tasa de crecimiento diaria es: 0.04145251 </code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>
<code>$r.conf</code> (confidence interval): 2.5 % 0.02582225 97.5 %
0.05708276</li>
</ol>
<p>El intervalo de confianza del <code>95%</code> para la tasa de
crecimiento diaria está entre <code>0.0258 (2.58%)</code> y
<code>0.0571 (5.71%)</code>.</p>
<p><code>$doubling</code> (doubling time in days): 16.72148</p>
<ol start="3" style="list-style-type: decimal">
<li>El tiempo de duplicación estimado del número de casos nuevos es de
aproximadamente <code>16.72 días</code>. Esto significa que, bajo el
modelo actual y con la tasa de crecimiento estimada, se espera que el
número de casos de la curva epidémica actual se duplique cada
<code>16.72 días</code>.</li>
</ol>
<p><code>$doubling.conf</code> (confidence interval): 2.5 % 12.14285
97.5 % 26.84302</p>
<ol start="4" style="list-style-type: decimal">
<li>El intervalo de confianza del <code>95%</code> para el tiempo de
duplicación está entre aproximadamente <code>12.14</code> y
<code>26.84 días</code>. Este amplio rango refleja la incertidumbre en
la estimación y puede ser consecuencia de la variabilidad en los datos o
de un tamaño de muestra pequeño.</li>
</ol>
<p><code>$pred</code>: Contiene las predicciones de incidencia
observada. Incluye las fechas, la escala de tiempo en días desde el
inicio del brote, los valores ajustados (predicciones) y los límites
inferior y superior del intervalo de confianza para las
predicciones.</p>
<p>Si quiere conocer un poco más de este componente puede explorarlo con
la función <code>glimpse</code>.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">ajuste_modelo</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">pred</span><span class="op">)</span></span></code></pre>
</div>
<p>¿El modelo se ajusta bien a los datos? Verifique el <span class="math inline">\(R^2\)</span></p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AjusteR2modelo</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">ajuste_modelo</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span></span>
<span><span class="fu">cat</span><span class="op">(</span><span class="st">"El R cuadrado ajustado es:"</span>, <span class="va">AjusteR2modelo</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>El R cuadrado ajustado es: 0.7551113 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Antes de continuar ¿Considera más adecuado usar una gráfica semanal
para buscar un ajuste de los datos? ¿Por qué?</p>
<p>¿Es preferible calcular la tasa de crecimiento diaria con el ajuste
semanal y no con el ajuste diario?</p>

<p>Grafique la incidencia incluyendo una línea que represente el
modelo.</p>
<p>Con <code>plot</code></p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">incidencia_semanal</span>, fit <span class="op">=</span> <span class="va">ajuste_modelo</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-24-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Tras ajustar el modelo log-lineal a la incidencia semanal para
estimar la tasa de crecimiento de la epidemia, el gráfico muestra la
curva de ajuste superpuesta a la incidencia semanal observada.</p>
<p>Al final del gráfico se puede observar que la incidencia semanal
disminuye.</p>
<p>¿Porqué cree que podría estar pasando esto? ¿Cómo lo
solucionaría?</p>

</div>
</div>
<div class="section level3">
<h3 id="modelo-log-lineal-con-datos-truncados">4.2. Modelo log-lineal con datos truncados<a class="anchor" aria-label="anchor" href="#modelo-log-lineal-con-datos-truncados"></a>
</h3>
<div class="section level4">
<h4 id="encuentre-una-fecha-límite-adecuada-para-el-modelo-log-lineal-en-función-de-los-rezagos-biológicos-y-administrativos-">Encuentre una fecha límite adecuada para el modelo log-lineal, en
función de los rezagos (biológicos y administrativos).<a class="anchor" aria-label="anchor" href="#encuentre-una-fecha-l%C3%ADmite-adecuada-para-el-modelo-log-lineal-en-funci%C3%B3n-de-los-rezagos-biol%C3%B3gicos-y-administrativos-"></a>
</h4>
<p>Dado que esta epidemia es de Ébola y la mayoría de los casos van a
ser hospitalizados, es muy probable que la mayoría de las notificaciones
ocurran en el momento de la hospitalización. De tal manera que podríamos
examinar cuánto tiempo transcurre entre la fecha de inicio de síntomas y
la fecha de hospitalización para hacernos una idea del rezago para esta
epidemia.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">casos</span><span class="op">$</span><span class="va">fecha_de_hospitalizacion</span> <span class="op">-</span> <span class="va">casos</span><span class="op">$</span><span class="va">fecha_inicio_sintomas</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
   0.00    1.00    2.00    3.53    5.00   22.00 </code></pre>
</div>
<p>Al restar la fecha de hospitalización a la fecha de inicio de
síntomas podría haber valores negativos. ¿Cuál cree que sea su
significado? ¿Ocurre en este caso?</p>
<p>Para evitar el sesgo debido a rezagos en la notificación, se pueden
truncar los datos de incidencia. Pruebe descartar las últimas dos
semanas. Este procedimiento permite concentrarse en el periodo en que
los datos son más completos para un análisis más fiable.</p>
<p>Semanas a descartar al final de la epicurva</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">semanas_a_descartar</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">fecha_minima</span> <span class="op">&lt;-</span> <span class="fu">min</span><span class="op">(</span><span class="va">incidencia_diaria</span><span class="op">$</span><span class="va">dates</span><span class="op">)</span></span>
<span><span class="va">fecha_maxima</span> <span class="op">&lt;-</span> <span class="fu">max</span><span class="op">(</span><span class="va">incidencia_diaria</span><span class="op">$</span><span class="va">dates</span><span class="op">)</span> <span class="op">-</span> <span class="va">semanas_a_descartar</span> <span class="op">*</span> <span class="fl">7</span></span>
<span></span>
<span><span class="co"># Para truncar la incidencia semanal</span></span>
<span><span class="va">incidencia_semanal_truncada</span> <span class="op">&lt;-</span> <span class="fu">subset</span><span class="op">(</span><span class="va">incidencia_semanal</span>, </span>
<span>                         from <span class="op">=</span> <span class="va">fecha_minima</span>, </span>
<span>                         to <span class="op">=</span> <span class="va">fecha_maxima</span><span class="op">)</span> <span class="co"># descarte las últimas semanas de datos</span></span>
<span></span>
<span><span class="co"># Incidencia diaria truncada. No la usamos para la regresión lineal pero se puede usar más adelante</span></span>
<span><span class="va">incidencia_diaria_truncada</span> <span class="op">&lt;-</span> <span class="fu">subset</span><span class="op">(</span><span class="va">incidencia_diaria</span>, </span>
<span>                        from <span class="op">=</span> <span class="va">fecha_minima</span>, </span>
<span>                        to <span class="op">=</span> <span class="va">fecha_maxima</span><span class="op">)</span> <span class="co"># eliminamos las últimas dos semanas de datos</span></span></code></pre>
</div>
<div id="desafío-6" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-6" class="callout-inner">
<h3 class="callout-title">Desafío 6</h3>
<div class="callout-content">
<p>Ahora utilizando los datos truncados
<code>incidencia_semanal_truncada</code> vuelva a ajustar el modelo
logarítmico lineal.</p>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;incidence_fit object&gt;

$model: regression of log-incidence over time

$info: list containing the following items:
  $r (daily growth rate):
[1] 0.05224047

  $r.conf (confidence interval):
          2.5 %    97.5 %
[1,] 0.03323024 0.0712507

  $doubling (doubling time in days):
[1] 13.2684

  $doubling.conf (confidence interval):
        2.5 %   97.5 %
[1,] 9.728286 20.85893

  $pred: data.frame of incidence predictions (10 rows, 5 columns)</code></pre>
</div>
</div>
</div>
</div>

<p>¿Cámo interpreta estos resultados? ¿Compare los <span class="math inline">\(R^2\)</span>?</p>
<div id="desafío-7" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-7" class="callout-inner">
<h3 class="callout-title">Desafío 7</h3>
<div class="callout-content">
<p>Ahora utilizando los datos truncados
<code>incidencia_semanal_truncada</code> vuelva a graficar el modelo
logarítmico lineal.</p>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-29-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>

<p>¿Qué cambios observa?</p>
<p>Observe las estadísticas resumidas del ajuste:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">ajuste_modelo_truncado</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
stats::lm(formula = log(counts) ~ dates.x, data = df)

Residuals:
     Min       1Q   Median       3Q      Max
-0.73474 -0.31655 -0.03211  0.41798  0.65311

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 0.186219   0.332752   0.560 0.591049
dates.x     0.052240   0.008244   6.337 0.000224 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5241 on 8 degrees of freedom
Multiple R-squared:  0.8339,	Adjusted R-squared:  0.8131
F-statistic: 40.16 on 1 and 8 DF,  p-value: 0.0002237</code></pre>
</div>
<p>El modelo muestra que hay una relación significativa
(<code>R-squared: 0.8131</code>) entre el tiempo (<code>dates.x</code>)
y la incidencia de la enfermedad, por lo que concluimos que la
enfermedad muestra un crecimiento exponencial a lo largo del tiempo.</p>
</div>
</div>
<div class="section level3">
<h3 id="tasa-de-crecimiento-y-tasa-de-duplicación-extracción-de-datos">4.3. Tasa de crecimiento y tasa de duplicación: extracción de
datos<a class="anchor" aria-label="anchor" href="#tasa-de-crecimiento-y-tasa-de-duplicaci%C3%B3n-extracci%C3%B3n-de-datos"></a>
</h3>
<div class="section level4">
<h4 id="estimacion-de-la-tasa-de-crecimiento">Estimacion de la tasa de crecimiento<a class="anchor" aria-label="anchor" href="#estimacion-de-la-tasa-de-crecimiento"></a>
</h4>
<p>Para estimar la tasa de crecimiento de una epidemia utilizando un
modelo log-lineal es necesario realizar un ajuste de regresión a los
datos de incidencia. Dado que ya tiene un objeto de incidencia truncado
y un modelo log-lineal ajustado, puede proceder a calcular la tasa de
crecimiento diaria y el tiempo de duplicación de la epidemia.</p>
<p>El modelo log-lineal proporcionará los coeficientes necesarios para
estos cálculos. Note que el coeficiente asociado con el tiempo (la
pendiente de la regresión) se puede interpretar como la tasa de
crecimiento diaria cuando el tiempo se expresa en días.</p>
<p>Con el modelo ajustado truncado, es hora de realizar la estimación de
la tasa de crecimiento. Estos datos los puede encontrar en el objeto
<code>ajuste modelo semana</code>, que tiene los datos ajustados de
incidencia semanal truncada.</p>
<div id="desafío-8" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-8" class="callout-inner">
<h3 class="callout-title">Desafío 8</h3>
<div class="callout-content">
<p>Por favor escriba el código para obtener los siguientes valores:</p>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>La tasa de crecimiento diaria es: 0.05224047 </code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Intervalo de confianza de la tasa de crecimiento diaria (95%): 0.03323024 0.0712507 </code></pre>
</div>
</div>
</div>
</div>

<p>Si no lo recuerda, vuelva por pistas a la sección <a href="#interpretaci%C3%B3n-del-modelo">Ajuste un modelo log-lineal a los
datos de incidencia semanal</a></p>
<p>Ahora que ya ha obtenido la tasa de crecimiento diaria y sus
intervalos de confianza, puede pasar a estimar el tiempo de
duplicación.</p>
</div>
<div class="section level4">
<h4 id="estimación-del-tiempo-de-duplicación">Estimación del tiempo de duplicación<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-tiempo-de-duplicaci%C3%B3n"></a>
</h4>
<p>Esta información también la encontrará calculada y lista para
utilizar en el objeto <code>ajuste_modelo_truncado</code>, que tiene los
datos ajustados de incidencia semanal truncada.</p>
<div id="desafío-9" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-9" class="callout-inner">
<h3 class="callout-title">Desafío 9</h3>
<div class="callout-content">
<p>Por favor escriba el código para obtener los siguientes valores:</p>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>El tiempo de duplicación de la epidemia es 13.2684 días</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Intervalo de confianza del tiempo de duplicación (95%): 9.728286 20.85893 </code></pre>
</div>
</div>
</div>
</div>

<p>Si no lo recuerda vuelva por pistas a la sección <a href="#interpretaci%C3%B3n-del-modelo">Ajuste un modelo log-lineal a los
datos de incidencia semanal</a></p>
</div>
</div>
</section><section><h2 class="section-heading" id="estimación-de-número-de-reproducción">5. Estimación de número de reproducción<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-n%C3%BAmero-de-reproducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>Evaluar la velocidad a la que se propaga una infección en una
población es una tarea importante a la hora de informar la respuesta de
salud pública a una epidemia.</p>
<p>Los números de reproducción son métricas típicas para monitorear el
desarrollo de epidemias y son informativos sobre su velocidad de
propagación. El <strong>Número de reproducción básico</strong> <span class="math inline">\(R_0\)</span>, por ejemplo, mide el número promedio
de casos secundarios producidos por un individuo infeccioso dada una
población completamente susceptible. Esta hipótesis suele ser válida
solo al inicio de una epidemia.</p>
<p>Para caracterizar el la propagación en tiempo real es más común
utilizar el <strong>Número de reproducción instantáneo</strong> <span class="math inline">\(R_t\)</span>, el cual describe el número promedio
de casos secundarios generados por un individuo infeccioso en el tiempo
<span class="math inline">\(t\)</span> dado que no han habido cambios en
las condiciones actuales.</p>
<p>En esta sección exploraremos los conceptos necesarios para calcular
el Número de reproducción instantáneo, así como los pasos a seguir para
estimarlo por medio del paquete de R <a href="https://github.com/mrc-ide/EpiEstim" class="external-link">EpiEstim</a>.</p>
<div class="section level3">
<h3 id="intervalo-serial-si">5.1. Intervalo serial (SI)<a class="anchor" aria-label="anchor" href="#intervalo-serial-si"></a>
</h3>
<p>¿Qué es el intervalo serial?</p>
<p>El intervalo serial en epidemiología se refiere al tiempo que
transcurre entre el momento en que una persona infectada (el caso
primario) comienza a mostrar síntomas y el momento en que la persona que
fue infectada por ella (el caso secundario) comienza a mostrar
síntomas.</p>
<p>Este intervalo es importante porque ayuda a entender qué tan rápido
se está propagando una enfermedad y a diseñar estrategias de control
como el rastreo de contactos y la cuarentena. Si el intervalo serial es
corto, puede significar que la enfermedad se propaga rápidamente y que
es necesario actuar con urgencia para contenerla. Si es largo, puede
haber más tiempo para intervenir antes de que la enfermedad se disemine
ampliamente.</p>
<p>Para este brote de Ébola asumiremos que el intervalo serial está
descrito por una distribución Gamma de media (<code>mean_si</code>) de
<code>8.7 días</code> y con una desviación estándar
(<code>std_si</code>) de <code>6.1 días</code>. En la práctica del día 4
estudiaremos cómo estimar el intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parametros de la distribución gamma para el invertavlo serial</span></span>
<span><span class="va">mean_si</span> <span class="op">&lt;-</span> <span class="fl">8.7</span></span>
<span><span class="va">std_si</span> <span class="op">&lt;-</span>  <span class="fl">6.1</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>mean_si <span class="op">=</span> <span class="va">mean_si</span>, std_si <span class="op">=</span> <span class="va">std_si</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># t_start y t_end se configuran automáticamente para estimar R en ventanas deslizantes para 1 semana de forma predeterminada.</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="estimación-de-la-transmisibilidad-variable-en-el-tiempo-rt">5.2. Estimación de la transmisibilidad variable en el tiempo,
R(t)<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-la-transmisibilidad-variable-en-el-tiempo-rt"></a>
</h3>
<p>Cuando la suposición de que (<span class="math inline">\(R\)</span>)
es constante en el tiempo se vuelve insostenible, una alternativa es
estimar la transmisibilidad variable en el tiempo utilizando el Número
de reproducción instantáneo (<span class="math inline">\(R_t\)</span>).
Este enfoque, introducido por Cori et al. (2013), se implementa en el
paquete <code>EpiEstim</code>, el cual estima el <span class="math inline">\(R_t\)</span> para ventanas de tiempo
personalizadas, utilizando una distribución de Poisson. A continuación,
estimamos la transmisibilidad para ventanas de tiempo deslizantes de 1
semana (el valor predeterminado de <code>estimate_R</code>):</p>
<hr>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>mean_si <span class="op">=</span> <span class="va">mean_si</span>, std_si <span class="op">=</span> <span class="va">std_si</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># t_start y t_end se configuran automáticamente para estimar R en ventanas deslizantes para 1 semana de forma predeterminada.</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use estimate_R using method = "parametric_si"</span></span>
<span><span class="va">estimacion_rt</span> <span class="op">&lt;-</span> <span class="fu">estimate_R</span><span class="op">(</span><span class="va">incidencia_diaria_truncada</span>, method <span class="op">=</span> <span class="st">"parametric_si"</span>, </span>
<span>                            si_data <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>                            config <span class="op">=</span> <span class="va">config</span><span class="op">)</span></span>
<span><span class="co"># Observamos las primeras estimaciones de R(t)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">estimacion_rt</span><span class="op">$</span><span class="va">R</span><span class="op">[</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"t_start"</span>, <span class="st">"t_end"</span>, <span class="st">"Median(R)"</span>, </span>
<span>                         <span class="st">"Quantile.0.025(R)"</span>, <span class="st">"Quantile.0.975(R)"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  t_start t_end Median(R) Quantile.0.025(R) Quantile.0.975(R)
1       2     8        NA                NA                NA
2       3     9  2.173592         0.3136801          7.215718
3       4    10  2.148673         0.3100840          7.132996
4       5    11  2.060726         0.2973920          6.841036
5       6    12  1.960940         0.2829915          6.509775
6       7    13  1.869417         0.2697834          6.205943</code></pre>
</div>
<p>Grafique la estimación de <span class="math inline">\(R\)</span> como
función del tiempo:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">estimacion_rt</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-40-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><hr>
<div class="section level4">
<h4 id="sobre-este-documento">Sobre este documento<a class="anchor" aria-label="anchor" href="#sobre-este-documento"></a>
</h4>
<p>Este documento ha sido una adaptación de los materiales originales
disponibles en <a href="https://www.reconlearn.org/" class="external-link">RECON Learn</a></p>
</div>
<div class="section level4">
<h4 id="contribuciones">Contribuciones<a class="anchor" aria-label="anchor" href="#contribuciones"></a>
</h4>
<p>Autores originales:</p>
<ul>
<li><p>Anne Cori</p></li>
<li><p>Natsuko Imai</p></li>
<li><p>Finlay Campbell</p></li>
<li><p>Zhian N. Kamvar</p></li>
<li><p>Thibaut Jombart</p></li>
</ul>
<p>Cambios menores y adaptación a español:</p>
<ul>
<li><p>José M. Velasco-España</p></li>
<li><p>Cándida Díaz-Brochero</p></li>
<li><p>Nicolas Torres</p></li>
<li><p>Zulma M. Cucunubá</p></li>
</ul>
<div id="puntos-clave" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div id="puntos-clave" class="callout-inner">
<h3 class="callout-title">Puntos clave</h3>
<div class="callout-content">
<p>Revise si al final de esta lección adquirió estas competencias:</p>
<ul>
<li><p>Identificar los parámetros necesarios en casos de transmisión de
enfermedades infecciosas de persona a persona.</p></li>
<li><p>Estimar la probabilidad de muerte (CFR).</p></li>
<li><p>Calcular y graficar la incidencia.</p></li>
<li><p>Estimar e interpretar la tasa de crecimiento y el tiempo en el
que se duplica la epidemia.</p></li>
<li><p>Estimar e interpretar el número de reproducción instantáneo de la
epidemia.</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>
</section></section><section id="aio-ZIKAB"><p>Content from <a href="ZIKAB.html">Construyendo un modelo matemático simple para Zika</a></p>
<hr>
<p>Última actualización: 2025-03-13 |

        <a href="https://github.com/epiverse-trace/epimodelac/edit/main/episodes/ZIKAB.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo construir un modelo simplificado de zika?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<p>Al final de este taller usted podrá:</p>
<ul>
<li>Aplicar conceptos como parámetros, <span class="math inline">\(R_0\)</span> e inmunidad de rebaño, aprendidos en
la sesión A del taller</li>
<li>Traducir fórmulas matemáticas de las interacciones entre los
parámetros del modelo a código de R</li>
<li>Realizar un modelo simple en R para una enfermedad transmitida por
vector</li>
<li>Discutir cambios en las proyecciones del modelo cuando se instauran
diferentes estrategias de control de la infección</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introducción">1. Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>En este taller usted aplicará los conceptos básicos del
<strong>modelamiento de Enfermedades Transmitidas por Vectores
(ETV)</strong> mediante el uso del lenguaje R con énfasis en el
funcionamiento de los métodos, utilizando como ejemplo un modelo básico
de infección por un arbovirus: el virus del Zika.</p>
</section><section><h2 class="section-heading" id="agenda">2. Agenda<a class="anchor" aria-label="anchor" href="#agenda"></a>
</h2>
<hr class="half-width">
<ul>
<li>Instrucciones (5 mins)</li>
<li>Desarrollo taller Zika Parte B (45 mins con acompañamiento de
monitores)</li>
<li>Revisión grupal del código (10 mins)</li>
<li>Revisión de resultados (20 mins)</li>
<li>Descanso (25 mins)</li>
<li>Discusión final (60 mins)</li>
</ul></section><section><h2 class="section-heading" id="conceptos-básicos-a-desarrollar">3. Conceptos básicos a desarrollar<a class="anchor" aria-label="anchor" href="#conceptos-b%C3%A1sicos-a-desarrollar"></a>
</h2>
<hr class="half-width">
<p>En esta práctica se desarrollarán los siguientes conceptos:</p>
<ul>
<li>Modelo SIR para ETV Zika</li>
<li>Parametrización de un modelo dinámico</li>
<li>Evaluación de un modelo dinámico</li>
<li>Parametrización de intervenciones de control (fumigación,
mosquiteros y vacunación) para una ETV</li>
</ul></section><section><h2 class="section-heading" id="paquetes-requeridos">4. Paquetes requeridos<a class="anchor" aria-label="anchor" href="#paquetes-requeridos"></a>
</h2>
<hr class="half-width">
<p>Cargue los paquetes necesarios ingresando en R los siguientes
comandos:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">deSolve</span><span class="op">)</span>   <span class="co"># Paquete deSolve para resolver las ecuaciones diferenciales</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span> <span class="co"># Paquetes ggplot2 y dplyr de tidyverse</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">cowplot</span><span class="op">)</span> <span class="co"># Paquete gridExtra para unir gráficos.</span></span></code></pre>
</div>
<ul>
<li>Si desea puede tomar notas en el script de R, para esto se
recomienda usar el símbolo de comentario <em>#</em> después de cada
línea de código (ver ejemplo arriba). O podría utilizar un archivo Rmd
para tener un aspecto similar al del taller.</li>
</ul></section><section><h2 class="section-heading" id="compartimentos-del-modelo-básico-de-zika">5. Compartimentos del modelo básico de Zika<a class="anchor" aria-label="anchor" href="#compartimentos-del-modelo-b%C3%A1sico-de-zika"></a>
</h2>
<hr class="half-width">
<ul>
<li>
<span class="math inline">\(S_h\)</span> : Humanos susceptibles</li>
<li>
<span class="math inline">\(I_h\)</span> : Humanos infecciosos</li>
<li>
<span class="math inline">\(R_h\)</span> : Humanos recuperados de la
infección (inmunizados frente a nueva infección)</li>
<li>
<span class="math inline">\(S_v\)</span> : Vectores
susceptibles</li>
<li>
<span class="math inline">\(E_v\)</span> : Vectores expuestos</li>
<li>
<span class="math inline">\(I_v\)</span> : Vectores infecciosos</li>
</ul></section><section><h2 class="section-heading" id="parámetros-del-modelo">6. Parámetros del modelo<a class="anchor" aria-label="anchor" href="#par%C3%A1metros-del-modelo"></a>
</h2>
<hr class="half-width">
<p>Ahora se usarán los parámetros que discutimos en la parte A del
taller. Si aún no los tiene, estos se pueden encontrar en la guía de
aprendizaje de la parte A del taller.</p>
<div id="desafío-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-1" class="callout-inner">
<h3 class="callout-title">Desafío 1</h3>
<div class="callout-content">
<p>Busque los valores de los parámetros del modelo y diligéncielos en el
recuadro de abajo. Tenga en cuenta que todos los parámetros usados
tienen la misma unidad de tiempo (días).</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>Lv       <span class="ot">&lt;-</span>        <span class="co"># Esperanza de vida de los mosquitos (en días)</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>Lh       <span class="ot">&lt;-</span>        <span class="co"># Esperanza de vida de los humanos (en días)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>PIh      <span class="ot">&lt;-</span>        <span class="co"># Periodo infeccioso en humanos (en días)</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>PIv      <span class="ot">&lt;-</span>        <span class="co"># Periodo infeccioso en vectores (en días)</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>PEI      <span class="ot">&lt;-</span>        <span class="co"># Período extrínseco de incubación en mosquitos adultos (en días)</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>muv      <span class="ot">&lt;-</span>        <span class="co"># Tasa per capita de mortalidad del vector (1/Lv)</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>muh      <span class="ot">&lt;-</span>        <span class="co"># Tasa per capita de mortalidad del hospedador (1/Lh)</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>alphav   <span class="ot">&lt;-</span>        <span class="co"># Tasa per capita de natalidad del vector</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>alphah   <span class="ot">&lt;-</span>        <span class="co"># Tasa per capita de natalidad del hospedador</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>gamma    <span class="ot">&lt;-</span>        <span class="co"># Tasa de recuperación en humanos (1/PIh)</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>delta    <span class="ot">&lt;-</span>        <span class="co"># Tasa extrínseca de incubación (1/PEI)</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>ph       <span class="ot">&lt;-</span>        <span class="co"># Probabilidad de transmisión del vector al hospedador dada una picadura por un mosquito infeccioso a un humano susceptible</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>pv       <span class="ot">&lt;-</span>        <span class="co"># Probabilidad de transmisión del hospedador al vector dada una picadura por un mosquito susceptible a un humano infeccioso</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>Nh       <span class="ot">&lt;-</span>        <span class="co"># Número de humanos</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>m        <span class="ot">&lt;-</span>        <span class="co"># Densidad de mosquitos hembra por humano</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>Nv       <span class="ot">&lt;-</span>        <span class="co"># Número de vectores (m * Nh)</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>R0       <span class="ot">&lt;-</span>        <span class="co"># Número reproductivo básico</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>b        <span class="ot">&lt;-</span>        <span class="fu">sqrt</span>((R0 <span class="sc">*</span> muv<span class="sc">*</span>(muv<span class="sc">+</span>delta) <span class="sc">*</span> (muh<span class="sc">+</span>gamma)) <span class="sc">/</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>                   (m <span class="sc">*</span> ph <span class="sc">*</span> pv <span class="sc">*</span> delta)) <span class="co"># Tasa de picadura</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>betah    <span class="ot">&lt;-</span>        <span class="co"># Coeficiente de transmisión del mosquito al humano</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>betav    <span class="ot">&lt;-</span>        <span class="co"># Coeficiente de transmisión del humano al mosquito</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>TIME     <span class="ot">&lt;-</span>        <span class="co"># Número de años que se va a simular </span></span></code></pre>
</div>
</div>
</div>
</div>

</section><section><h2 class="section-heading" id="ecuaciones-del-modelo">7. Ecuaciones del modelo<a class="anchor" aria-label="anchor" href="#ecuaciones-del-modelo"></a>
</h2>
<hr class="half-width">
<p>Para este modelo emplearemos las siguientes ecuaciones
diferenciales:</p>
<div class="section level3">
<h3 id="humanos">7.1 Humanos<a class="anchor" aria-label="anchor" href="#humanos"></a>
</h3>
<p><span class="math display">\[\ \frac{dSh}{dt}  = \alpha_h N_h -
\beta_h \frac {I_v}{N_h}S_h - \mu_h  S_h \]</span></p>
<p><span class="math display">\[\ \frac{dIh}{dt}  = \beta_h \frac
{I_v}{N_h}S_h - (\gamma + \mu_h) I_h \]</span><br></p>
<p><span class="math display">\[\ \frac{dRh}{dt}  = \gamma I_h  - \mu_h
R_h\]</span></p>
</div>
<div class="section level3">
<h3 id="vectores">7.2 Vectores<a class="anchor" aria-label="anchor" href="#vectores"></a>
</h3>
<p><span class="math display">\[\ \frac{dSv}{dt}  = \alpha_v N_v  -
\beta_v \frac{ I_h} {N_h}S_v  - \mu_v Sv\]</span></p>
<p><span class="math display">\[\ \frac{dE_v}{dt}  = \beta_v \frac{I_h}
{N_h}S_v- (\delta + \mu_v) Ev\]</span><br></p>
<p><span class="math display">\[\ \frac{dI_v}{dt}  = \delta Ev - \mu_v
I_v\]</span></p>
</div>
</section><section><h2 class="section-heading" id="fórmula-para-calcular-r_0-número-reproductivo-básico">8. Fórmula para calcular <span class="math inline">\(R_0\)</span>
(Número reproductivo básico)<a class="anchor" aria-label="anchor" href="#f%C3%B3rmula-para-calcular-r_0-n%C3%BAmero-reproductivo-b%C3%A1sico"></a>
</h2>
<hr class="half-width">
<p>Fórmula necesaria para estimar <span class="math inline">\(R_0\)</span>:</p>
<p><span class="math display">\[ R_0 = \frac{mb^2 p_h p_v \delta}{\mu_v
(\mu_v+\delta)(\mu_h+\gamma)} \]</span></p>
</section><section><h2 class="section-heading" id="modelo-en-r">9. Modelo en R<a class="anchor" aria-label="anchor" href="#modelo-en-r"></a>
</h2>
<hr class="half-width">
<p>Es hora de implementar el modelo en R. Para lograrlo, usaremos la
función <code>ode</code> del paquete <em>desolve</em>. Para el ejercicio
se emplearán 4 argumentos de la función esta función: el primero son las
condiciones iniciales del modelo (argumento <code>y</code>); el segundo
es la secuencia temporal donde se ejecutará el modelo (argumento
<code>times</code>); el tercero es una función que contiene las
ecuaciones diferenciales que entrarán al sistema (argumento
<code>fun</code>); por último un vector que contiene los parámetros con
los que se calculará el sistema (argumento <code>parms</code>).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># NO la copie a R sólo tiene fines ilustrativos.</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">ode</span>(<span class="at">y      =</span> <span class="co"># Condiciones iniciales,</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    <span class="at">times  =</span> <span class="co"># Tiempo,</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="at">fun    =</span> <span class="co"># Modelo o función que lo contenga,</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="at">parms  =</span> <span class="co"># Parámetros</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>)</span></code></pre>
</div>
<div id="desafío-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-2" class="callout-inner">
<h3 class="callout-title">Desafío 2</h3>
<div class="callout-content">
<p>En esta sección se empezará por crear la función (argumento
<code>fun</code>), para ello es necesario traducir las ecuaciones del
modelo a R. Abajo encontrará la función ya construida, por favor
reemplace los parámetros faltantes (Cambie <em>PAR</em> por los
parámetro correspondientes) en las ecuaciones:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arbovmodel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">x</span>, <span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">Sh</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>    <span class="co"># Humanos susceptibles</span></span>
<span>  <span class="va">Ih</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>    <span class="co"># Humanos infecciosos </span></span>
<span>  <span class="va">Rh</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>    <span class="co"># Humanos recuperados</span></span>
<span>  <span class="va">Sv</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>    <span class="co"># Vectores susceptibles</span></span>
<span>  <span class="va">Ev</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>    <span class="co"># Vectores expuestos</span></span>
<span>  <span class="va">Iv</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>    <span class="co"># Vectores infecciosos</span></span>
<span>  </span>
<span>  <span class="fu">with</span><span class="op">(</span><span class="fu">as.list</span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, <span class="co"># entorno local para evaluar derivados</span></span>
<span>       <span class="op">{</span></span>
<span>         <span class="co"># Humanos</span></span>
<span>         <span class="va">dSh</span>   <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="va">Nh</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="op">(</span><span class="va">Iv</span><span class="op">/</span><span class="va">Nh</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sh</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="va">Sh</span>   </span>
<span>         <span class="va">dIh</span>   <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="op">(</span><span class="va">Iv</span><span class="op">/</span><span class="va">Nh</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sh</span> <span class="op">-</span> <span class="op">(</span><span class="va">PAR</span> <span class="op">+</span> <span class="va">PAR</span><span class="op">)</span> <span class="op">*</span> <span class="va">Ih</span></span>
<span>         <span class="va">dRh</span>   <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="va">Ih</span>  <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="va">Rh</span></span>
<span>         </span>
<span>         <span class="co"># Vectores</span></span>
<span>         <span class="va">dSv</span>  <span class="op">&lt;-</span>  <span class="va">alphav</span> <span class="op">*</span> <span class="va">Nv</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="op">(</span><span class="va">Ih</span><span class="op">/</span><span class="va">Nh</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sv</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="va">Sv</span> </span>
<span>         <span class="va">dEv</span>  <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="op">(</span><span class="va">Ih</span><span class="op">/</span><span class="va">Nh</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sv</span> <span class="op">-</span> <span class="op">(</span><span class="va">PAR</span> <span class="op">+</span> <span class="va">PAR</span><span class="op">)</span><span class="op">*</span> <span class="va">Ev</span></span>
<span>         <span class="va">dIv</span>  <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="va">Ev</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="va">Iv</span></span>
<span>         </span>
<span>         <span class="va">dx</span>   <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">dSh</span>, <span class="va">dIh</span>, <span class="va">dRh</span>, <span class="va">dSv</span>, <span class="va">dEv</span>, <span class="va">dIv</span><span class="op">)</span></span>
<span>         <span class="fu">list</span><span class="op">(</span><span class="va">dx</span><span class="op">)</span></span>
<span>       <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>

</section><section><h2 class="section-heading" id="resuelva-el-sistema">10. Resuelva el Sistema<a class="anchor" aria-label="anchor" href="#resuelva-el-sistema"></a>
</h2>
<hr class="half-width">
<p>En esta sección se crearán los tres argumentos faltantes para usar la
función <code>ode</code> y se creará un objeto de clase
<code>data.frame</code> con los resultados de la función
<code>ode</code>. Por favor complete y comente el código para:</p>
<ul>
<li><p>Los VALORES de las condiciones iniciales del sistema.</p></li>
<li><p>Los ARGUMENTOS de la función <strong><code>ode</code></strong> en
el paquete <strong>deSolve</strong>.</p></li>
</ul>
<div id="desafío-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-3" class="callout-inner">
<h3 class="callout-title">Desafío 3</h3>
<div class="callout-content">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Secuencia temporal (times)</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>times  <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">365</span> <span class="sc">*</span> TIME , <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># Los parámetros (parms)</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">muv      =</span> muv,     </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="at">muh      =</span> muh, </span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="at">alphav   =</span> alphav,</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="at">alphah   =</span> alphah,</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="at">gamma    =</span> gamma,   </span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="at">delta    =</span> delta,   </span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  <span class="at">betav    =</span> betav,       </span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  <span class="at">betah    =</span> betah,   </span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  <span class="at">Nh       =</span> Nh,      </span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>  <span class="at">Nv       =</span> Nv</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>)</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co"># Condiciones iniciales del sistema (y)</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>xstart <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Sh =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>            <span class="at">Ih =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>            <span class="at">Rh =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>            <span class="at">Sv =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>            <span class="at">Ev =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>            <span class="at">Iv =</span> VALOR?)        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co"># Resuelva las ecuaciones</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ode</span>(<span class="at">y      =</span> ARGUMENTO?,   <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>                         <span class="at">times  =</span> ARGUMENTO?,   <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>                         <span class="at">fun    =</span> ARGUMENTO?,   <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>                         <span class="at">parms  =</span> ARGUMENTO?))  <span class="co"># COMPLETE Y COMENTE</span></span></code></pre>
</div>
</div>
</div>
</div>

</section><section><h2 class="section-heading" id="resultados">11. Resultados<a class="anchor" aria-label="anchor" href="#resultados"></a>
</h2>
<hr class="half-width">
<div id="desafío-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-4" class="callout-inner">
<h3 class="callout-title">Desafío 4</h3>
<div class="callout-content">
<p>Para tener una visualización más significativa de los resultados,
convierta las unidades de tiempo de <em>días</em> a <em>años</em> y a
<em>semanas</em>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Cree las opciones de tiempo para años y semanas </span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>out<span class="sc">$</span>years <span class="ot">&lt;-</span> </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>out<span class="sc">$</span>weeks <span class="ot">&lt;-</span> </span></code></pre>
</div>
</div>
</div>
</div>

<p>Observe el comportamiento del modelo en distintas escalas de tiempo
(semanas y años):</p>
<div class="section level3">
<h3 id="comportamiento-general-población-humana">11.1 Comportamiento General (Población humana)<a class="anchor" aria-label="anchor" href="#comportamiento-general-poblaci%C3%B3n-humana"></a>
</h3>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise el comportamiento general del modelo para 100 años</span></span>
<span><span class="va">p1h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">Rh</span> <span class="op">+</span> <span class="va">Ih</span> <span class="op">+</span> <span class="va">Sh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'grey68'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana total'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p2h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sh</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'royalblue'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana susceptible'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p3h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'firebrick'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana infecciosa'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p4h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'olivedrab'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana recuperada'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1h</span>, <span class="va">p2h</span>, <span class="va">p3h</span>, <span class="va">p4h</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/ZIKAB-rendered-p1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="comportamiento-general-población-de-vectores">11.2 Comportamiento General (Población de vectores)<a class="anchor" aria-label="anchor" href="#comportamiento-general-poblaci%C3%B3n-de-vectores"></a>
</h3>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise el comportamiento general del modelo</span></span>
<span><span class="va">p1v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">Sv</span> <span class="op">+</span> <span class="va">Ev</span> <span class="op">+</span> <span class="va">Iv</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'grey68'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población total de mosquitos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p2v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sv</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'royalblue'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población susceptible de mosquitos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p3v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ev</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'orchid'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población expuesta de mosquitos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p4v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Iv</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'firebrick'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población infecciosa de mosquitos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1v</span>, <span class="va">p2v</span>, <span class="va">p3v</span>, <span class="va">p4v</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/ZIKAB-rendered-p2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="proporción">11.3 Proporción<a class="anchor" aria-label="anchor" href="#proporci%C3%B3n"></a>
</h3>
<p>Por favor dé una mirada más cuidadosa a las proporciones y
discútalas</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'royalblue'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana susceptible'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Proporción'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'firebrick'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana infecciosa'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Proporción'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'olivedrab'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana recuperada'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Proporción'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/ZIKAB-rendered-p3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="la-primera-epidemia">11.4 La primera epidemia<a class="anchor" aria-label="anchor" href="#la-primera-epidemia"></a>
</h3>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise la primera epidemia</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">out</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">weeks</span> <span class="op">&lt;</span> <span class="fl">54</span><span class="op">)</span></span>
<span><span class="va">p1e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'firebrick'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población de humanos infecciosos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Semanas'</span><span class="op">)</span></span>
<span><span class="va">p2e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'olivedrab'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana recuperada'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Semanas'</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1e</span>, <span class="va">p2e</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/ZIKAB-rendered-p4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="algunos-aspectos-por-discutir">11.5 Algunos aspectos por discutir<a class="anchor" aria-label="anchor" href="#algunos-aspectos-por-discutir"></a>
</h3>
<ul>
<li>¿Qué tan sensible es el modelo a cambios en el <span class="math inline">\(R_0\)</span>?</li>
<li>¿Qué razones hay (según el modelo) para el intervalo de tiempo entre
estas epidemias simuladas?</li>
<li>¿Cómo se puede calcular la tasa de ataque?</li>
</ul>
</div>
<div class="section level3">
<h3 id="modele-una-o-más-intervenciones-de-control">11.6 Modele una o más intervenciones de control<a class="anchor" aria-label="anchor" href="#modele-una-o-m%C3%A1s-intervenciones-de-control"></a>
</h3>
<p>Ahora, utilizando este modelo básico, modelar por grupos el impacto
de las siguientes intervenciones:</p>
<ol style="list-style-type: decimal">
<li>Grupo 1. Fumigación contra mosquitos</li>
<li>Grupo 2. Mosquiteros/angeos</li>
<li>Grupo 3. Vacunación que previene frente a infecciones</li>
</ol>
<p>Para cada intervención:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Indique en qué parte del modelo haría los cambios.</p></li>
<li><p>De acuerdo a la literatura que explique estas intervenciones y
describa cómo parametrizará el modelo. ¿Todas estas intervenciones son
viables en la actualidad?</p></li>
</ol>
</div>
</section><section><h2 class="section-heading" id="sobre-este-documento">Sobre este documento<a class="anchor" aria-label="anchor" href="#sobre-este-documento"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="contribuciones">Contribuciones<a class="anchor" aria-label="anchor" href="#contribuciones"></a>
</h3>
<ul>
<li>Zulma Cucunuba &amp; Pierre Nouvellet: Versión inicial</li>
<li>Kelly Charinga &amp; Zhian N. Kamvar: Edición</li>
<li>José M. Velasco-España: Traducción de Inglés a Español y
Edición</li>
<li>Andree Valle-Campos: Ediciones menores</li>
</ul>
<p>Contribuciones son bienvenidas vía <a href="https://github.com/reconhub/learn/pulls" class="external-link">pull requests</a>. El
archivo fuente del documento original puede ser encontrado <a href="https://raw.githubusercontent.com/reconhub/learn/master/content/post/practical-vbd.Rmd" class="external-link"><strong>aquí</strong></a>.</p>
</div>
<div class="section level3">
<h3 id="asuntos-legales">Asuntos legales<a class="anchor" aria-label="anchor" href="#asuntos-legales"></a>
</h3>
<p><strong>Licencia</strong>: <a href="https://creativecommons.org/licenses/by/3.0/" class="external-link">CC-BY</a>
<strong>Copyright</strong>: Zulma Cucunuba &amp; Pierre Nouvellet,
2017</p>
<!-- ## Referencias -->
<div id="puntos-clave" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div id="puntos-clave" class="callout-inner">
<h3 class="callout-title">Puntos clave</h3>
<div class="callout-content">
<p>Revise si al final de esta lección adquirió estas competencias:</p>
<ul>
<li>Aplicar conceptos como parámetros, <span class="math inline">\(R_0\)</span> e inmunidad de rebaño, aprendidos en
la sesión A del taller</li>
<li>Traducir fórmulas matemáticas de las interacciones entre los
parámetros del modelo a código de R</li>
<li>Realizar un modelo simple en R para una enfermedad transmitida por
vector</li>
<li>Discutir cambios en las proyecciones del modelo cuando se instauran
diferentes estrategias de control de la infección</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-EnfermedadX"><p>Content from <a href="EnfermedadX.html">Estimación de las distribuciones de rezagos epidemiológicos: Enfermedad X</a></p>
<hr>
<p>Última actualización: 2025-03-13 |

        <a href="https://github.com/epiverse-trace/epimodelac/edit/main/episodes/EnfermedadX.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo responder ante un brote de una enfermedad desconocida?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<p>Al final de este taller usted podrá:</p>
<ul>
<li><p>Comprender los conceptos clave de las distribuciones de rezagos
epidemiológicos para la Enfermedad X.</p></li>
<li><p>Comprender las estructuras de datos y las herramientas para el
análisis de datos de rastreo de contactos.</p></li>
<li><p>Aprender a ajustar las estimaciones del intervalo serial y el
período de incubación de la Enfermedad X teniendo en cuenta la censura
por intervalo utilizando un marco de trabajo Bayesiano.</p></li>
<li><p>Aprender a utilizar estos parámetros para informar estrategias de
control en un brote de un patógeno desconocido.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introducción">1. Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>La Enfermedad X representa un hipotético, pero plausible, brote de
una enfermedad infecciosa en el futuro. Este término fue acuñado por la
Organización Mundial de la Salud (OMS) y sirve como un término general
para un patógeno desconocido que podría causar una epidemia grave a
nivel internacional. Este concepto representa la naturaleza impredecible
de la aparición de enfermedades infecciosas y resalta la necesidad de
una preparación global y mecanismos de respuesta rápida. La Enfermedad X
simboliza el potencial de una enfermedad inesperada y de rápida
propagación, y resalta la necesidad de sistemas de salud flexibles y
adaptables, así como capacidades de investigación para identificar,
comprender y combatir patógenos desconocidos.</p>
<p>En esta práctica, va a aprender a estimar los rezagos
epidemiológicos, el tiempo entre dos eventos epidemiológicos, utilizando
un conjunto de datos simulado de la Enfermedad X.</p>
<p>La Enfermedad X es causada por un patógeno desconocido y se transmite
directamente de persona a persona. Específicamente, la practica se
centrará en estimar el período de incubación y el intervalo serial.</p>
</section><section><h2 class="section-heading" id="agenda">2. Agenda<a class="anchor" aria-label="anchor" href="#agenda"></a>
</h2>
<hr class="half-width">
<p>Parte 1. Individual o en grupo.</p>
<p>Parte 2. En grupos de 6 personas. Construir estrategia de rastreo de
contactos y aislamiento y preparar presentación de máximo 10 mins.</p>
</section><section><h2 class="section-heading" id="conceptos-claves">3. Conceptos claves<a class="anchor" aria-label="anchor" href="#conceptos-claves"></a>
</h2>
<hr class="half-width">
<div class="section level4">
<h4 id="rezagos-epidemiológicos-período-de-incubación-e-intervalo-serial">
<strong>3.1. Rezagos epidemiológicos: Período de incubación e
intervalo serial</strong><a class="anchor" aria-label="anchor" href="#rezagos-epidemiol%C3%B3gicos-per%C3%ADodo-de-incubaci%C3%B3n-e-intervalo-serial"></a>
</h4>
<p>En epidemiología, las distribuciones de rezagos se refieren a los
<em>retrasos temporales</em> entre dos eventos clave durante un brote.
Por ejemplo: el tiempo entre el inicio de los síntomas y el diagnóstico,
el tiempo entre la aparición de síntomas y la muerte, entre muchos
otros.</p>
<p>Este taller se enfocará en dos rezagos clave conocidos como el
período de incubación y el intervalo serial. Ambos son cruciales para
informar la respuesta de salud pública.</p>
<p>El <u><strong>período de incubación</strong></u> es el tiempo entre
la infección y la aparición de síntomas.</p>
<p>El <u><strong>intervalo serial</strong></u> es el tiempo entre la
aparición de síntomas entre el caso primario y secundario.</p>
<p>La relación entre estos parámetros tiene un impacto en si la
enfermedad se transmite antes <u>(<strong>transmisión
pre-sintomática</strong>)</u> o después de que los síntomas
<u>(<strong>transmisión sintomática</strong>)</u> se hayan desarrollado
en el caso primario (Figura 1).</p>
<figure><img src="practicalfig.jpg" class="figure mx-auto d-block"></figure><p>Figura 1. Relación entre el período de incubación y el intervalo
serial en el momento de la transmisión (<em>Adaptado de Nishiura et
al. 2020)</em></p>
</div>
<div class="section level4">
<h4 id="distribuciones-comunes-de-rezagos-y-posibles-sesgos">3.2. Distribuciones comunes de rezagos y posibles sesgos<a class="anchor" aria-label="anchor" href="#distribuciones-comunes-de-rezagos-y-posibles-sesgos"></a>
</h4>
<div class="section level5">
<h5 id="sesgos-potenciales">
<strong>3.2.1 Sesgos potenciales</strong><a class="anchor" aria-label="anchor" href="#sesgos-potenciales"></a>
</h5>
<p>Cuando se estiman rezagos epidemiológicos, es importante considerar
posibles sesgos:</p>
<p><u><strong>Censura</strong></u> significa que sabemos que un evento
ocurrió, pero no sabemos exactamente cuándo sucedió. La mayoría de los
datos epidemiológicos están “doblemente censurados” debido a la
incertidumbre que rodea tanto los tiempos de eventos primarios como
secundarios. No tener en cuenta la censura puede llevar a estimaciones
sesgadas de la desviación estándar del resago (Park et al. en
progreso).</p>
<p><u><strong>Truncamiento a la derecha</strong></u> es un tipo de sesgo
de muestreo relacionado con el proceso de recolección de datos. Surge
porque solo se pueden observar los casos que han sido reportados. No
tener en cuenta el truncamiento a la derecha durante la fase de
crecimiento de una epidemia puede llevar a una subestimación del rezago
medio (Park et al. en progreso).</p>
<p>El sesgo <u><strong>dinámico (o de fase epidémica</strong>)</u> es
otro tipo de sesgo de muestreo. Afecta a los datos retrospectivos y está
relacionado con la fase de la epidemia: durante la fase de crecimiento
exponencial, los casos que desarrollaron síntomas recientemente están
sobrerrepresentados en los datos observados, mientras que durante la
fase de declive, estos casos están subrepresentados, lo que lleva a la
estimación de intervalos de retraso más cortos y más largos,
respectivamente (Park et al. en progreso).</p>
</div>
<div class="section level5">
<h5 id="distribuciones-de-rezagos">
<strong>3.2.2 Distribuciones de rezagos</strong><a class="anchor" aria-label="anchor" href="#distribuciones-de-rezagos"></a>
</h5>
<p>Tres distribuciones de probabilidad comunes utilizadas para
caracterizar rezagos en epidemiología de enfermedades infecciosas (Tabla
1):</p>
<table style="width:82%;" class="table">
<caption>Tabla 1. Tres de las distribuciones de probabilidad más comunes
para rezagos epidemiológicos.</caption>
<colgroup>
<col width="23%">
<col width="58%">
</colgroup>
<thead><tr class="header">
<th>Distribución</th>
<th align="center">Parámetros</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Weibull</strong></td>
<td align="center">
<code>shape</code> y <code>scale</code> (forma y
escala)</td>
</tr>
<tr class="even">
<td><strong>gamma</strong></td>
<td align="center">
<code>shape</code> y <code>scale</code> (forma y
escala)</td>
</tr>
<tr class="odd">
<td><strong>log normal</strong></td>
<td align="center">
<code>log mean</code> y
<code>log standard deviation</code> (media y desviación estándar
logarítmica)</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section><h2 class="section-heading" id="paquetes-de-r-para-la-practica">4. Paquetes de <em>R</em> para la practica<a class="anchor" aria-label="anchor" href="#paquetes-de-r-para-la-practica"></a>
</h2>
<hr class="half-width">
<p>En esta practica se usarán los siguientes paquetes de
<code>R</code>:</p>
<ul>
<li><p><code>dplyr</code> para manejo de datos</p></li>
<li><p><code>epicontacts</code> para visualizar los datos de rastreo de
contactos</p></li>
<li><p><code>ggplot2</code> y <code>patchwork</code> para
gráficar</p></li>
<li><p><code>incidence</code> para visualizar curvas epidemicas</p></li>
<li><p><code>rstan</code> para estimar el período de incubación</p></li>
<li><p><code>coarseDataTools</code> via <code>EpiEstim</code> para
estimar el intervalo serial</p></li>
</ul>
<p>Instrucciones de instalación para los paquetes:</p>
<p>Para cargar los paquetes, escriba:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epicontacts</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">coarseDataTools</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EpiEstim</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">loo</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">patchwork</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">rstan</span><span class="op">)</span></span></code></pre>
</div>
<p>Para este taller, las autoras han creado algunas funciones que serán
necesarias para el buen funcionamiento del mismo. Por favor, copie el
siguiente texto, selecciónelo y ejecútelo para tener estas funciones en
su ambiente global y poderlas utilizar.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Calcule la verosimilitud DIC mediante integración</span></span>
<span><span class="va">diclik</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par1</span>, <span class="va">par2</span>, <span class="va">EL</span>, <span class="va">ER</span>, <span class="va">SL</span>, <span class="va">SR</span>, <span class="va">dist</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co">## Si la ventana de síntomas es mayor que la ventana de exposición</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">SL</span><span class="op">&gt;</span><span class="va">ER</span><span class="op">-</span><span class="va">EL</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">dic1</span> <span class="op">&lt;-</span> <span class="fu">integrate</span><span class="op">(</span><span class="va">fw1</span>, lower<span class="op">=</span><span class="va">SL</span><span class="op">-</span><span class="va">ER</span>, upper<span class="op">=</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>,</span>
<span>              subdivisions<span class="op">=</span><span class="fl">10</span>,</span>
<span>              par1<span class="op">=</span><span class="va">par1</span>, par2<span class="op">=</span><span class="va">par2</span>,</span>
<span>              EL<span class="op">=</span><span class="va">EL</span>, ER<span class="op">=</span><span class="va">ER</span>, SL<span class="op">=</span><span class="va">SL</span>, SR<span class="op">=</span><span class="va">SR</span>,</span>
<span>              dist<span class="op">=</span><span class="va">dist</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"W"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">EL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pweibull</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1W"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">EL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">pweibullOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pweibullOff1</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"G"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">EL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pgamma</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1G"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">EL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">pgammaOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pgammaOff1</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"L"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">EL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">plnorm</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1L"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">EL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">plnormOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">plnormOff1</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="kw">stop</span><span class="op">(</span><span class="st">"distribution not supported"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">dic3</span> <span class="op">&lt;-</span> <span class="fu">integrate</span><span class="op">(</span><span class="va">fw3</span>, lower<span class="op">=</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, upper<span class="op">=</span><span class="va">SR</span><span class="op">-</span><span class="va">EL</span>,</span>
<span>              subdivisions<span class="op">=</span><span class="fl">10</span>,</span>
<span>              par1<span class="op">=</span><span class="va">par1</span>, par2<span class="op">=</span><span class="va">par2</span>,</span>
<span>              EL<span class="op">=</span><span class="va">EL</span>, ER<span class="op">=</span><span class="va">ER</span>, SL<span class="op">=</span><span class="va">SL</span>, SR<span class="op">=</span><span class="va">SR</span>,</span>
<span>              dist<span class="op">=</span><span class="va">dist</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="va">dic1</span> <span class="op">+</span> <span class="va">dic2</span> <span class="op">+</span> <span class="va">dic3</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="co">## Si la ventana de exposición es mayor que la ventana de síntomas</span></span>
<span>  <span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">dic1</span> <span class="op">&lt;-</span> <span class="fu">integrate</span><span class="op">(</span><span class="va">fw1</span>, lower<span class="op">=</span><span class="va">SL</span><span class="op">-</span><span class="va">ER</span>, upper<span class="op">=</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, subdivisions<span class="op">=</span><span class="fl">10</span>,</span>
<span>              par1<span class="op">=</span><span class="va">par1</span>, par2<span class="op">=</span><span class="va">par2</span>,</span>
<span>              EL<span class="op">=</span><span class="va">EL</span>, ER<span class="op">=</span><span class="va">ER</span>, SL<span class="op">=</span><span class="va">SL</span>, SR<span class="op">=</span><span class="va">SR</span>,</span>
<span>              dist<span class="op">=</span><span class="va">dist</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"W"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">SL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pweibull</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1W"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">SL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">pweibullOff1</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pweibullOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"G"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">SL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pgamma</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1G"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">SL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">pgammaOff1</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pgammaOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"L"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">SL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">plnorm</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1L"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">dic2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">SL</span><span class="op">)</span><span class="op">*</span></span>
<span>        <span class="op">(</span><span class="fu">plnormOff1</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">plnormOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">ER</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="kw">stop</span><span class="op">(</span><span class="st">"distribution not supported"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">dic3</span> <span class="op">&lt;-</span> <span class="fu">integrate</span><span class="op">(</span><span class="va">fw3</span>, lower<span class="op">=</span><span class="va">SL</span><span class="op">-</span><span class="va">EL</span>, upper<span class="op">=</span><span class="va">SR</span><span class="op">-</span><span class="va">EL</span>,</span>
<span>              subdivisions<span class="op">=</span><span class="fl">10</span>,</span>
<span>              par1<span class="op">=</span><span class="va">par1</span>, par2<span class="op">=</span><span class="va">par2</span>,</span>
<span>              EL<span class="op">=</span><span class="va">EL</span>, ER<span class="op">=</span><span class="va">ER</span>, SL<span class="op">=</span><span class="va">SL</span>, SR<span class="op">=</span><span class="va">SR</span>,</span>
<span>              dist<span class="op">=</span><span class="va">dist</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="va">dic1</span> <span class="op">+</span> <span class="va">dic2</span> <span class="op">+</span> <span class="va">dic3</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Esta verosimilitud DIC está diseñada para datos que tienen intervalos superpuestos</span></span>
<span><span class="va">diclik2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par1</span>, <span class="va">par2</span>, <span class="va">EL</span>, <span class="va">ER</span>, <span class="va">SL</span>, <span class="va">SR</span>, <span class="va">dist</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">SL</span><span class="op">&gt;</span><span class="va">ER</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="fu">diclik</span><span class="op">(</span><span class="va">par1</span>, <span class="va">par2</span>, <span class="va">EL</span>, <span class="va">ER</span>, <span class="va">SL</span>, <span class="va">SR</span>, <span class="va">dist</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">lik1</span> <span class="op">&lt;-</span> <span class="fu">integrate</span><span class="op">(</span><span class="va">diclik2.helper1</span>, lower<span class="op">=</span><span class="va">EL</span>, upper<span class="op">=</span><span class="va">SL</span>,</span>
<span>              SL<span class="op">=</span><span class="va">SL</span>, SR<span class="op">=</span><span class="va">SR</span>, par1<span class="op">=</span><span class="va">par1</span>, par2<span class="op">=</span><span class="va">par2</span>, dist<span class="op">=</span><span class="va">dist</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>    <span class="va">lik2</span> <span class="op">&lt;-</span> <span class="fu">integrate</span><span class="op">(</span><span class="va">diclik2.helper2</span>, lower<span class="op">=</span><span class="va">SL</span>, upper<span class="op">=</span><span class="va">ER</span>,</span>
<span>              SR<span class="op">=</span><span class="va">SR</span>, par1<span class="op">=</span><span class="va">par1</span>, par2<span class="op">=</span><span class="va">par2</span>, dist<span class="op">=</span><span class="va">dist</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="va">lik1</span><span class="op">+</span><span class="va">lik2</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Funciones de verosimilitud para diclik2</span></span>
<span><span class="va">diclik2.helper1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">SL</span>, <span class="va">SR</span>, <span class="va">par1</span>, <span class="va">par2</span>, <span class="va">dist</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span><span class="st">"W"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">pweibull</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pweibull</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span><span class="st">"off1W"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">pweibullOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pweibullOff1</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span><span class="st">"G"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">pgamma</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pgamma</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span><span class="op">==</span><span class="st">"off1G"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">pgammaOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">pgammaOff1</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"L"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">plnorm</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">plnorm</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">x</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1L"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">plnormOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span> <span class="op">-</span> <span class="fu">plnormOff1</span><span class="op">(</span><span class="va">SL</span><span class="op">-</span><span class="va">x</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">stop</span><span class="op">(</span><span class="st">"distribution not supported"</span><span class="op">)</span>     </span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">diclik2.helper2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">SR</span>, <span class="va">par1</span>, <span class="va">par2</span>, <span class="va">dist</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span><span class="st">"W"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">pweibull</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span><span class="st">"off1W"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">pweibullOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span><span class="st">"G"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">pgamma</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span><span class="st">"off1G"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">pgammaOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span><span class="op">==</span><span class="st">"L"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">plnorm</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span><span class="op">==</span><span class="st">"off1L"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">plnormOff1</span><span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">x</span>, <span class="va">par1</span>, <span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">stop</span><span class="op">(</span><span class="st">"distribution not supported"</span><span class="op">)</span>     </span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co">## Funciones que manipulan/calculan la verosimilitud para los datos censurados</span></span>
<span><span class="co">## Las funciones codificadas aquí se toman directamente de las</span></span>
<span><span class="co">## notas de verosimilitud censurada por intervalos dobles.</span></span>
<span><span class="va">fw1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">EL</span>, <span class="va">ER</span>, <span class="va">SL</span>, <span class="va">SR</span>, <span class="va">par1</span>, <span class="va">par2</span>, <span class="va">dist</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co">## Función que calcula la primera función para la integral DIC</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span><span class="op">==</span><span class="st">"W"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">SL</span><span class="op">+</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dweibull</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>,shape<span class="op">=</span><span class="va">par1</span>,scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span><span class="op">==</span><span class="st">"off1W"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">SL</span><span class="op">+</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dweibullOff1</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>,shape<span class="op">=</span><span class="va">par1</span>,scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span><span class="op">==</span><span class="st">"G"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">SL</span><span class="op">+</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dgamma</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span><span class="op">==</span><span class="st">"off1G"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">SL</span><span class="op">+</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dgammaOff1</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span><span class="st">"L"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">SL</span><span class="op">+</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dlnorm</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, meanlog<span class="op">=</span><span class="va">par1</span>, sdlog<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span><span class="st">"off1L"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">ER</span><span class="op">-</span><span class="va">SL</span><span class="op">+</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dlnormOff1</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, meanlog<span class="op">=</span><span class="va">par1</span>, sdlog<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">stop</span><span class="op">(</span><span class="st">"distribution not supported"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fw3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">EL</span>, <span class="va">ER</span>, <span class="va">SL</span>, <span class="va">SR</span>, <span class="va">par1</span>, <span class="va">par2</span>, <span class="va">dist</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="co">## Función que calcula la tercera función para la integral DIC</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"W"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">EL</span><span class="op">-</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dweibull</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1W"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">EL</span><span class="op">-</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dweibullOff1</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span>  <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"G"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">EL</span><span class="op">-</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dgamma</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span>  <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1G"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">EL</span><span class="op">-</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dgammaOff1</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, shape<span class="op">=</span><span class="va">par1</span>, scale<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"L"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">EL</span><span class="op">-</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dlnorm</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, meanlog<span class="op">=</span><span class="va">par1</span>, sdlog<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"off1L"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">SR</span><span class="op">-</span><span class="va">EL</span><span class="op">-</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dlnormOff1</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, meanlog<span class="op">=</span><span class="va">par1</span>, sdlog<span class="op">=</span><span class="va">par2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">stop</span><span class="op">(</span><span class="st">"distribution not supported"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="datos">5. Datos<a class="anchor" aria-label="anchor" href="#datos"></a>
</h2>
<hr class="half-width">
<p>Esta práctica está partida en dos grupos para abordar dos
enfermedades desconocidas con diferentes modos de transmisión.</p>
<p>Cargue los datos simulados que están guardados como un archivo .RDS,
de acuerdo a su grupo asignado. Puede encontrar esta información en la
carpeta <a href="https://drive.google.com/drive/folders/1v8gMuEJx24ottM0VR4X_Ile60EV18ay3?usp=sharing" class="external-link">Enfermedad
X</a>. Descargue la carpeta, extráigala en el computador y abra el
proyecto de R.</p>
<p>Hay dos elementos de interés:</p>
<ul>
<li><p><code>linelist</code>, un archivo que contiene una lista de casos
de la Enfermedad X, un caso por fila.</p></li>
<li><p><code>contacts</code>, un archivo con datos de rastreo de
contactos que contiene información sobre pares de casos primarios y
secundarios.</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Grupo 1</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">readRDS</span><span class="op">(</span><span class="st">"data/practical_data_group1.RDS"</span><span class="op">)</span> </span>
<span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">linelist</span> </span>
<span><span class="va">contacts</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">contacts</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="exploración-de-los-datos">6. Exploración de los datos<a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-los-datos"></a>
</h2>
<hr class="half-width">
<div class="section level4">
<h4 id="exploración-de-los-datos-en-linelist">
<strong>6.1. Exploración de los datos en
<code>linelist</code></strong><a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-los-datos-en-linelist"></a>
</h4>
<p>Empiece con <code>linelist</code>. Estos datos fueron recolectados
como parte de la vigilancia epidemiológica rutinaria. Cada fila
representa un caso de la Enfermedad X, y hay 7 variables:</p>
<ul>
<li><p><code>id</code>: número único de identificación del caso</p></li>
<li><p><code>date_onset</code>: fecha de inicio de los síntomas del
paciente</p></li>
<li><p><code>sex</code>: : M = masculino; F = femenino</p></li>
<li><p><code>age</code>: edad del paciente en años</p></li>
<li><p><code>exposure</code>: información sobre cómo el paciente podría
haber estado expuesto</p></li>
<li><p><code>exposure_start</code>: primera fecha en que el paciente
estuvo expuesto</p></li>
<li><p><code>exposure_end</code>: última fecha en que el paciente estuvo
expuesto</p></li>
</ul>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (1)</strong></em></p>
<ul>
<li><p><em>¿Cuántos casos hay en los datos de
<code>linelist</code>?</em></p></li>
<li><p><em>¿Qué proporción de los casos son femeninos?</em></p></li>
<li><p><em>¿Cuál es la distribución de edades de los
casos?</em></p></li>
<li><p><em>¿Qué tipo de información sobre la exposición está
disponible?</em></p></li>
</ul>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inspecionar los datos</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  id date_onset sex age                    exposure exposure_start exposure_end
1  1 2023-10-01   M  34 Close, skin-to-skin contact           &lt;NA&gt;         &lt;NA&gt;
2  2 2023-10-03   F  38 Close, skin-to-skin contact     2023-09-29   2023-09-29
3  3 2023-10-06   F  38 Close, skin-to-skin contact     2023-09-28   2023-09-28
4  4 2023-10-10   F  37                        &lt;NA&gt;     2023-09-25   2023-09-27
5  5 2023-10-11   F  33                        &lt;NA&gt;     2023-10-05   2023-10-05
6  6 2023-10-12   F  34 Close, skin-to-skin contact     2023-10-10   2023-10-10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P1</span></span>
<span><span class="fu">nrow</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 166</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P2</span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="fu">nrow</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>        <span class="va">M</span></span>
<span><span class="fl">0.6144578</span> </span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P3</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
  22.00   33.00   36.00   35.51   38.00   47.00 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P4</span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">exposure</span>, exclude <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu">nrow</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Close, skin-to-skin contact
                  0.6626506 </code></pre>
</div>
<div class="alert alert-secondary">
<p><em>💡 <strong>Discusión</strong></em></p>
<ul>
<li><p>¿Por qué cree que falta la información de exposición en algunos
casos?</p></li>
<li><p>Ahora, grafique la curva epidémica. ¿En qué parte del brote cree
que está (principio, medio, final)?</p></li>
</ul>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-epi%20curve-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Parece que la epidemia todavía podría esta creciendo.</p>
</div>
<div class="section level4">
<h4 id="exploración-de-los-datos-de-rastreo-de-contactos">
<strong>6.2. Exploración de los datos de
<code>rastreo de contactos</code></strong><a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-los-datos-de-rastreo-de-contactos"></a>
</h4>
<p>Ahora vea los datos de rastreo de contactos, que se obtuvieron a
través de entrevistas a los pacientes. A los pacientes se les preguntó
sobre actividades e interacciones recientes para identificar posibles
fuentes de infección. Se emparejaron pares de casos primarios y
secundarios si el caso secundario nombraba al caso primario como un
contacto. Solo hay información de un subconjunto de los casos porque no
todos los pacientes pudieron ser contactados para una entrevista.</p>
<p>Note que para este ejercicio, se asumirá que los casos secundarios
solo tenían un posible infectante. En realidad, la posibilidad de que un
caso tenga múltiples posibles infectantes necesita ser evaluada.</p>
<p>Los datos de rastreo de contactos tienen 4 variables:</p>
<ul>
<li><p><code>primary_case_id</code>: número de identificación único para
el caso primario (infectante)</p></li>
<li><p><code>secondary_case_id</code>: número de identificación único
para el caso secundario (infectado)</p></li>
<li><p><code>primary_onset_date</code>: fecha de inicio de síntomas del
caso primario</p></li>
<li><p><code>secondary_onset_date</code>: fecha de inicio de síntomas
del caso secundario</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">make_epicontacts</span><span class="op">(</span>linelist <span class="op">=</span> <span class="va">linelist</span>,</span>
<span>                       contacts <span class="op">=</span> <span class="va">contacts</span>,</span>
<span>                       from <span class="op">=</span> <span class="st">"primary_case_id"</span>,</span>
<span>                       to <span class="op">=</span> <span class="st">"secondary_case_id"</span>,</span>
<span>                       directed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Esto indica que los contactos son directos (i.e., este gráfico traza una flecha desde los casos primarios a los secundarios)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div id="htmlwidget-925151b1c8720903e4f8" class="visNetwork html-widget" style="width:90%;height:700px;">

</div>
<script type="application/json" data-for="htmlwidget-925151b1c8720903e4f8">{"x":{"nodes":{"id":[1,2,4,5,6,8,9,10,11,12,15,16,19,21,22,23,25,28,29,30,31,32,33,34,36,37,38,41,42,43,44,45,46,47,51,52,53,54,55,57,59,60,61,63,64,65,66,68,69,70,71,73,74,78,79,80,81,83,86,88,89,90,92,96,98,99,100,102,103,105,106,107,108,111,113,114,115,117,119,120,121,122,125,127,128,129,133,136,138,141,142,144,149,152,153,154,156,158,159,160,161,162,164,165,166],"date_onset":["2023-10-01","2023-10-03","2023-10-10","2023-10-11","2023-10-12","2023-10-13","2023-10-15","2023-10-16","2023-10-16","2023-10-18","2023-10-20","2023-10-21","2023-10-24","2023-10-24","2023-10-25","2023-10-26","2023-10-28","2023-10-30","2023-10-30","2023-10-30","2023-10-31","2023-11-03","2023-11-03","2023-11-03","2023-11-04","2023-11-04","2023-11-05","2023-11-06","2023-11-06","2023-11-06","2023-11-06","2023-11-07","2023-11-07","2023-11-07","2023-11-08","2023-11-09","2023-11-10","2023-11-10","2023-11-10","2023-11-11","2023-11-12","2023-11-12","2023-11-12","2023-11-12","2023-11-13","2023-11-13","2023-11-13","2023-11-14","2023-11-14","2023-11-14","2023-11-14","2023-11-15","2023-11-15","2023-11-16","2023-11-16","2023-11-16","2023-11-16","2023-11-17","2023-11-17","2023-11-18","2023-11-18","2023-11-18","2023-11-18","2023-11-20","2023-11-20","2023-11-20","2023-11-20","2023-11-20","2023-11-21","2023-11-21","2023-11-21","2023-11-21","2023-11-22","2023-11-22","2023-11-23","2023-11-23","2023-11-23","2023-11-24","2023-11-25","2023-11-25","2023-11-25","2023-11-25","2023-11-26","2023-11-26","2023-11-26","2023-11-26","2023-11-26","2023-11-27","2023-11-27","2023-11-27","2023-11-27","2023-11-28","2023-11-29","2023-11-29","2023-11-29","2023-11-29","2023-11-29","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30"],"sex":["M","F","F","F","F","M","F","M","F","M","M","F","M","M","M","M","M","F","F","M","M","M","M","M","F","M","M","F","F","M","F","M","M","F","M","M","F","M","M","M","M","F","F","M","M","M","F","M","M","F","M","M","F","M","M","F","F","M","F","M","M","F","F","M","M","M","F","F","M","M","M","M","M","F","F","M","M","F","M","F","F","F","M","M","M","M","M","M","F","M","F","M","F","M","M","F","F","F","M","F","M","F","M","M","F"],"age":[34,38,37,33,34,35,36,42,39,33,39,39,33,33,32,36,36,34,32,31,38,35,38,30,38,35,34,38,42,35,32,29,32,36,38,28,34,34,27,33,41,38,35,37,42,36,37,33,35,42,31,40,34,32,34,33,34,37,34,42,35,34,41,36,24,35,39,39,43,33,38,34,33,37,37,37,31,27,38,36,38,36,39,31,37,33,37,34,39,40,36,47,34,36,31,22,35,35,37,31,38,38,40,37,36],"exposure":["Close, skin-to-skin contact","Close, skin-to-skin contact",null,null,"Close, skin-to-skin contact",null,null,null,"Close, skin-to-skin contact",null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact",null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact",null,null,null,"Close, skin-to-skin contact"],"exposure_start":[null,"2023-09-29","2023-09-25","2023-10-05","2023-10-10","2023-10-08","2023-10-13","2023-10-04","2023-10-03","2023-10-11","2023-10-13","2023-10-19","2023-10-20","2023-10-05","2023-10-20","2023-10-14","2023-10-26","2023-10-27","2023-10-24","2023-10-17","2023-10-30","2023-11-02","2023-10-27","2023-10-30","2023-10-29","2023-10-25","2023-11-01","2023-11-03","2023-11-03","2023-11-01","2023-11-03","2023-11-05","2023-10-18","2023-10-30","2023-11-02",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"exposure_end":[null,"2023-09-29","2023-09-27","2023-10-05","2023-10-10","2023-10-08","2023-10-13","2023-10-04","2023-10-03","2023-10-11","2023-10-14","2023-10-20","2023-10-20","2023-10-05","2023-10-20","2023-10-15","2023-10-26","2023-10-27","2023-10-25","2023-10-17","2023-10-30","2023-11-02","2023-10-27","2023-10-30","2023-10-30","2023-10-25","2023-11-01","2023-11-03","2023-11-03","2023-11-03","2023-11-04","2023-11-05","2023-10-19","2023-10-30","2023-11-04",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":["1","2","4","5","6","8","9","10","11","12","15","16","19","21","22","23","25","28","29","30","31","32","33","34","36","37","38","41","42","43","44","45","46","47","51","52","53","54","55","57","59","60","61","63","64","65","66","68","69","70","71","73","74","78","79","80","81","83","86","88","89","90","92","96","98","99","100","102","103","105","106","107","108","111","113","114","115","117","119","120","121","122","125","127","128","129","133","136","138","141","142","144","149","152","153","154","156","158","159","160","161","162","164","165","166"],"title":["<p> id: 1<br>date_onset: 2023-10-01<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 2<br>date_onset: 2023-10-03<br>sex: F<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-09-29<br>exposure_end: 2023-09-29 <\/p>","<p> id: 4<br>date_onset: 2023-10-10<br>sex: F<br>age: 37<br>exposure: NA<br>exposure_start: 2023-09-25<br>exposure_end: 2023-09-27 <\/p>","<p> id: 5<br>date_onset: 2023-10-11<br>sex: F<br>age: 33<br>exposure: NA<br>exposure_start: 2023-10-05<br>exposure_end: 2023-10-05 <\/p>","<p> id: 6<br>date_onset: 2023-10-12<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-10<br>exposure_end: 2023-10-10 <\/p>","<p> id: 8<br>date_onset: 2023-10-13<br>sex: M<br>age: 35<br>exposure: NA<br>exposure_start: 2023-10-08<br>exposure_end: 2023-10-08 <\/p>","<p> id: 9<br>date_onset: 2023-10-15<br>sex: F<br>age: 36<br>exposure: NA<br>exposure_start: 2023-10-13<br>exposure_end: 2023-10-13 <\/p>","<p> id: 10<br>date_onset: 2023-10-16<br>sex: M<br>age: 42<br>exposure: NA<br>exposure_start: 2023-10-04<br>exposure_end: 2023-10-04 <\/p>","<p> id: 11<br>date_onset: 2023-10-16<br>sex: F<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-03<br>exposure_end: 2023-10-03 <\/p>","<p> id: 12<br>date_onset: 2023-10-18<br>sex: M<br>age: 33<br>exposure: NA<br>exposure_start: 2023-10-11<br>exposure_end: 2023-10-11 <\/p>","<p> id: 15<br>date_onset: 2023-10-20<br>sex: M<br>age: 39<br>exposure: NA<br>exposure_start: 2023-10-13<br>exposure_end: 2023-10-14 <\/p>","<p> id: 16<br>date_onset: 2023-10-21<br>sex: F<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-19<br>exposure_end: 2023-10-20 <\/p>","<p> id: 19<br>date_onset: 2023-10-24<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-20<br>exposure_end: 2023-10-20 <\/p>","<p> id: 21<br>date_onset: 2023-10-24<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-05<br>exposure_end: 2023-10-05 <\/p>","<p> id: 22<br>date_onset: 2023-10-25<br>sex: M<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-20<br>exposure_end: 2023-10-20 <\/p>","<p> id: 23<br>date_onset: 2023-10-26<br>sex: M<br>age: 36<br>exposure: NA<br>exposure_start: 2023-10-14<br>exposure_end: 2023-10-15 <\/p>","<p> id: 25<br>date_onset: 2023-10-28<br>sex: M<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-26<br>exposure_end: 2023-10-26 <\/p>","<p> id: 28<br>date_onset: 2023-10-30<br>sex: F<br>age: 34<br>exposure: NA<br>exposure_start: 2023-10-27<br>exposure_end: 2023-10-27 <\/p>","<p> id: 29<br>date_onset: 2023-10-30<br>sex: F<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-24<br>exposure_end: 2023-10-25 <\/p>","<p> id: 30<br>date_onset: 2023-10-30<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-17<br>exposure_end: 2023-10-17 <\/p>","<p> id: 31<br>date_onset: 2023-10-31<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-30<br>exposure_end: 2023-10-30 <\/p>","<p> id: 32<br>date_onset: 2023-11-03<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-11-02<br>exposure_end: 2023-11-02 <\/p>","<p> id: 33<br>date_onset: 2023-11-03<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-27<br>exposure_end: 2023-10-27 <\/p>","<p> id: 34<br>date_onset: 2023-11-03<br>sex: M<br>age: 30<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-30<br>exposure_end: 2023-10-30 <\/p>","<p> id: 36<br>date_onset: 2023-11-04<br>sex: F<br>age: 38<br>exposure: NA<br>exposure_start: 2023-10-29<br>exposure_end: 2023-10-30 <\/p>","<p> id: 37<br>date_onset: 2023-11-04<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-25<br>exposure_end: 2023-10-25 <\/p>","<p> id: 38<br>date_onset: 2023-11-05<br>sex: M<br>age: 34<br>exposure: NA<br>exposure_start: 2023-11-01<br>exposure_end: 2023-11-01 <\/p>","<p> id: 41<br>date_onset: 2023-11-06<br>sex: F<br>age: 38<br>exposure: NA<br>exposure_start: 2023-11-03<br>exposure_end: 2023-11-03 <\/p>","<p> id: 42<br>date_onset: 2023-11-06<br>sex: F<br>age: 42<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-11-03<br>exposure_end: 2023-11-03 <\/p>","<p> id: 43<br>date_onset: 2023-11-06<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-11-01<br>exposure_end: 2023-11-03 <\/p>","<p> id: 44<br>date_onset: 2023-11-06<br>sex: F<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-11-03<br>exposure_end: 2023-11-04 <\/p>","<p> id: 45<br>date_onset: 2023-11-07<br>sex: M<br>age: 29<br>exposure: NA<br>exposure_start: 2023-11-05<br>exposure_end: 2023-11-05 <\/p>","<p> id: 46<br>date_onset: 2023-11-07<br>sex: M<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-18<br>exposure_end: 2023-10-19 <\/p>","<p> id: 47<br>date_onset: 2023-11-07<br>sex: F<br>age: 36<br>exposure: NA<br>exposure_start: 2023-10-30<br>exposure_end: 2023-10-30 <\/p>","<p> id: 51<br>date_onset: 2023-11-08<br>sex: M<br>age: 38<br>exposure: NA<br>exposure_start: 2023-11-02<br>exposure_end: 2023-11-04 <\/p>","<p> id: 52<br>date_onset: 2023-11-09<br>sex: M<br>age: 28<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 53<br>date_onset: 2023-11-10<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 54<br>date_onset: 2023-11-10<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 55<br>date_onset: 2023-11-10<br>sex: M<br>age: 27<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 57<br>date_onset: 2023-11-11<br>sex: M<br>age: 33<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 59<br>date_onset: 2023-11-12<br>sex: M<br>age: 41<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 60<br>date_onset: 2023-11-12<br>sex: F<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 61<br>date_onset: 2023-11-12<br>sex: F<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 63<br>date_onset: 2023-11-12<br>sex: M<br>age: 37<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 64<br>date_onset: 2023-11-13<br>sex: M<br>age: 42<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 65<br>date_onset: 2023-11-13<br>sex: M<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 66<br>date_onset: 2023-11-13<br>sex: F<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 68<br>date_onset: 2023-11-14<br>sex: M<br>age: 33<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 69<br>date_onset: 2023-11-14<br>sex: M<br>age: 35<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 70<br>date_onset: 2023-11-14<br>sex: F<br>age: 42<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 71<br>date_onset: 2023-11-14<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 73<br>date_onset: 2023-11-15<br>sex: M<br>age: 40<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 74<br>date_onset: 2023-11-15<br>sex: F<br>age: 34<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 78<br>date_onset: 2023-11-16<br>sex: M<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 79<br>date_onset: 2023-11-16<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 80<br>date_onset: 2023-11-16<br>sex: F<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 81<br>date_onset: 2023-11-16<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 83<br>date_onset: 2023-11-17<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 86<br>date_onset: 2023-11-17<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 88<br>date_onset: 2023-11-18<br>sex: M<br>age: 42<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 89<br>date_onset: 2023-11-18<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 90<br>date_onset: 2023-11-18<br>sex: F<br>age: 34<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 92<br>date_onset: 2023-11-18<br>sex: F<br>age: 41<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 96<br>date_onset: 2023-11-20<br>sex: M<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 98<br>date_onset: 2023-11-20<br>sex: M<br>age: 24<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 99<br>date_onset: 2023-11-20<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 100<br>date_onset: 2023-11-20<br>sex: F<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 102<br>date_onset: 2023-11-20<br>sex: F<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 103<br>date_onset: 2023-11-21<br>sex: M<br>age: 43<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 105<br>date_onset: 2023-11-21<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 106<br>date_onset: 2023-11-21<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 107<br>date_onset: 2023-11-21<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 108<br>date_onset: 2023-11-22<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 111<br>date_onset: 2023-11-22<br>sex: F<br>age: 37<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 113<br>date_onset: 2023-11-23<br>sex: F<br>age: 37<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 114<br>date_onset: 2023-11-23<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 115<br>date_onset: 2023-11-23<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 117<br>date_onset: 2023-11-24<br>sex: F<br>age: 27<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 119<br>date_onset: 2023-11-25<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 120<br>date_onset: 2023-11-25<br>sex: F<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 121<br>date_onset: 2023-11-25<br>sex: F<br>age: 38<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 122<br>date_onset: 2023-11-25<br>sex: F<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 125<br>date_onset: 2023-11-26<br>sex: M<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 127<br>date_onset: 2023-11-26<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 128<br>date_onset: 2023-11-26<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 129<br>date_onset: 2023-11-26<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 133<br>date_onset: 2023-11-26<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 136<br>date_onset: 2023-11-27<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 138<br>date_onset: 2023-11-27<br>sex: F<br>age: 39<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 141<br>date_onset: 2023-11-27<br>sex: M<br>age: 40<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 142<br>date_onset: 2023-11-27<br>sex: F<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 144<br>date_onset: 2023-11-28<br>sex: M<br>age: 47<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 149<br>date_onset: 2023-11-29<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 152<br>date_onset: 2023-11-29<br>sex: M<br>age: 36<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 153<br>date_onset: 2023-11-29<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 154<br>date_onset: 2023-11-29<br>sex: F<br>age: 22<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 156<br>date_onset: 2023-11-29<br>sex: F<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 158<br>date_onset: 2023-11-30<br>sex: F<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 159<br>date_onset: 2023-11-30<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 160<br>date_onset: 2023-11-30<br>sex: F<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 161<br>date_onset: 2023-11-30<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 162<br>date_onset: 2023-11-30<br>sex: F<br>age: 38<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 164<br>date_onset: 2023-11-30<br>sex: M<br>age: 40<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 165<br>date_onset: 2023-11-30<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 166<br>date_onset: 2023-11-30<br>sex: F<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>"],"color":["#CCDDFF","#C4DCF7","#BDDBEF","#B6DAE7","#AFD9E0","#A8D8D8","#A0D7D0","#99D6C9","#92D5C1","#8BD4B9","#84D3B1","#7CD2AA","#7ED0A6","#89CEA7","#95CBA8","#A0C8A9","#ACC6AB","#B8C3AC","#C3C0AD","#CFBEAE","#DABBAF","#E6B8B0","#F2B5B1","#FDB3B2","#F7B1B4","#F0B0B5","#E8AFB6","#E0ADB7","#D8ACB8","#D0ABBA","#C8AABB","#C0A8BC","#B8A7BD","#B1A6BE","#A9A4C0","#A6A5BB","#AEA8AA","#B6AC9A","#BEAF89","#C6B378","#CEB667","#D5B957","#DDBD46","#E5C035","#EDC425","#F5C714","#FDCB03","#FFC808","#FFC513","#FFC11E","#FFBD29","#FFB934","#FFB540","#FFB14B","#FFAD56","#FFA961","#FFA56C","#FFA277","#FEA080","#F9A982","#F5B184","#F0B986","#ECC289","#E7CA8B","#E3D28D","#DFDB8F","#DAE391","#D6EB93","#D1F396","#CDFC98","#CDF99B","#CEF19E","#D0E8A1","#D2E0A5","#D3D8A8","#D5CFAB","#D6C7AE","#D8BFB2","#DAB6B5","#DBAEB8","#DDA6BC","#DF9FBE","#E2A3BB","#E4A7B8","#E7ABB4","#EAAFB1","#EDB2AE","#EFB6AA","#F2BAA7","#F5BEA4","#F8C2A1","#FBC69D","#FDCA9A","#FCCC9B","#F8CCA0","#F3CCA4","#EFCCA9","#EBCCAD","#E6CCB2","#E2CCB6","#DECCBB","#D9CCBF","#D5CCC4","#D1CCC8","#CDCDCD"],"borderWidth":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]},"edges":{"from":[1,1,5,4,6,12,9,15,2,22,22,25,25,29,16,31,34,25,36,30,38,41,28,44,41,23,45,45,37,31,42,54,47,61,54,46,79,68,80,60,74,71,70,88,83,64,63,34,113,69,90,108,113,80,73,107,70,78,64,105,55,108,113,103,128,156,99,128,89,92,106,103],"to":[2,5,8,10,11,16,19,21,23,25,30,32,33,34,36,38,42,43,46,51,52,53,55,57,59,61,65,66,69,70,78,79,80,81,83,86,90,92,96,98,100,102,107,111,114,115,117,119,120,121,122,125,127,129,133,136,138,141,142,144,149,152,153,154,158,159,160,161,162,164,165,166],"primary_onset_date":["2023-10-01","2023-10-01","2023-10-11","2023-10-10","2023-10-12","2023-10-18","2023-10-15","2023-10-20","2023-10-03","2023-10-25","2023-10-25","2023-10-28","2023-10-28","2023-10-30","2023-10-21","2023-10-31","2023-11-03","2023-10-28","2023-11-04","2023-10-30","2023-11-05","2023-11-06","2023-10-30","2023-11-06","2023-11-06","2023-10-26","2023-11-07","2023-11-07","2023-11-04","2023-10-31","2023-11-06","2023-11-10","2023-11-07","2023-11-12","2023-11-10","2023-11-07","2023-11-16","2023-11-14","2023-11-16","2023-11-12","2023-11-15","2023-11-14","2023-11-14","2023-11-18","2023-11-17","2023-11-13","2023-11-12","2023-11-03","2023-11-23","2023-11-14","2023-11-18","2023-11-22","2023-11-23","2023-11-16","2023-11-15","2023-11-21","2023-11-14","2023-11-16","2023-11-13","2023-11-21","2023-11-10","2023-11-22","2023-11-23","2023-11-21","2023-11-26","2023-11-29","2023-11-20","2023-11-26","2023-11-18","2023-11-18","2023-11-21","2023-11-21"],"secondary_onset_date":["2023-10-03","2023-10-11","2023-10-13","2023-10-16","2023-10-16","2023-10-21","2023-10-24","2023-10-24","2023-10-26","2023-10-28","2023-10-30","2023-11-03","2023-11-03","2023-11-03","2023-11-04","2023-11-05","2023-11-06","2023-11-06","2023-11-07","2023-11-08","2023-11-09","2023-11-10","2023-11-10","2023-11-11","2023-11-12","2023-11-12","2023-11-13","2023-11-13","2023-11-14","2023-11-14","2023-11-16","2023-11-16","2023-11-16","2023-11-16","2023-11-17","2023-11-17","2023-11-18","2023-11-18","2023-11-20","2023-11-20","2023-11-20","2023-11-20","2023-11-21","2023-11-22","2023-11-23","2023-11-23","2023-11-24","2023-11-25","2023-11-25","2023-11-25","2023-11-25","2023-11-26","2023-11-26","2023-11-26","2023-11-26","2023-11-27","2023-11-27","2023-11-27","2023-11-27","2023-11-28","2023-11-29","2023-11-29","2023-11-29","2023-11-29","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30"],"width":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":false}},"groups":null,"width":"90%","height":"700px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"id","main":"Select by id","values":[1,2,4,5,6,8,9,10,11,12,15,16,19,21,22,23,25,28,29,30,31,32,33,34,36,37,38,41,42,43,44,45,46,47,51,52,53,54,55,57,59,60,61,63,64,65,66,68,69,70,71,73,74,78,79,80,81,83,86,88,89,90,92,96,98,99,100,102,103,105,106,107,108,111,113,114,115,117,119,120,121,122,125,127,128,129,133,136,138,141,142,144,149,152,153,154,156,158,159,160,161,162,164,165,166]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"opts_manipulation":{"datacss":"table.legend_table {\n  font-size: 11px;\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n}\ntable.legend_table td {\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n  padding: 2px;\n}\ndiv.table_content {\n  width:80px;\n  text-align:center;\n}\ndiv.table_description {\n  width:100px;\n}\n\n.operation {\n  font-size:20px;\n}\n\n.network-popUp {\n  display:none;\n  z-index:299;\n  width:250px;\n  /*height:150px;*/\n  background-color: #f9f9f9;\n  border-style:solid;\n  border-width:1px;\n  border-color: #0d0d0d;\n  padding:10px;\n  text-align: center;\n  position:fixed;\n  top:50%;  \n  left:50%;  \n  margin:-100px 0 0 -100px;  \n\n}","addNodeCols":["id","label"],"editNodeCols":["id","label"],"tab_add_node":"<span id=\"addnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"addnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"addnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"addnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"addnode-cancelButton\"><\/button>","tab_edit_node":"<span id=\"editnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"editnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"editnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"editnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"editnode-cancelButton\"><\/button>"},"iconsRedraw":true},"evals":[],"jsHooks":[]}</script><!--/html_preserve--><div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (2)</strong></em></p>
<ul>
<li>Describa los grupos (clusters).<br>
</li>
<li>¿Ve algún evento potencial de superpropagación (donde un caso
propaga el patógeno a muchos otros casos)?</li>
</ul>
</div>
</div>
</section><div class="section level1">
<h1 id="pausa-1-_________">
<em><code>_______Pausa 1 _________</code></em><a class="anchor" aria-label="anchor" href="#pausa-1-_________"></a>
</h1>
<hr>
<div class="section level2">
<h2 id="estimación-del-período-de-incubación">7. Estimación del período de incubación<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-per%C3%ADodo-de-incubaci%C3%B3n"></a>
</h2>
<p>Ahora, enfoquese en el período de incubación. Se utilizará los datos
del <code>linelist</code> para esta parte. Se necesitan ambos el tiempo
de inicio de sintomas y el timpo de la posible exposición. Note que en
los datos hay dos fechas de exposición, una de inicio y una de final.
Algunas veces la fecha exacta de exposición es desconocida y en su lugar
se obtiene la ventana de exposición durante la entrevista.</p>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (3)</strong></em></p>
<ul>
<li><p>¿Para cuántos casos tiene datos tanto de la fecha de inicio de
síntomas como de exposición?</p></li>
<li><p>Calcule las ventanas de exposición. ¿Cuántos casos tienen una
única fecha de exposición?</p></li>
</ul>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ip</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">linelist</span>, <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">exposure_start</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>               <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">exposure_end</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">nrow</span><span class="op">(</span><span class="va">ip</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 50</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_window</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_end</span> <span class="op">-</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_window</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
 0  1  2
34 11  5 </code></pre>
</div>
<div class="section level3">
<h3 id="estimación-naive-del-período-de-incubación">7.1. Estimación naive del período de incubación<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-naive-del-per%C3%ADodo-de-incubaci%C3%B3n"></a>
</h3>
<p>Empiece calculando una estimación naive del período de
incubación.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Máximo tiempo de período de incubación</span></span>
<span><span class="va">ip</span><span class="op">$</span><span class="va">max_ip</span> <span class="op">&lt;-</span> <span class="va">ip</span><span class="op">$</span><span class="va">date_onset</span> <span class="op">-</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">max_ip</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
   1.00    3.00    4.50    6.38    7.75   20.00 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mínimo tiempo de período de incubación</span></span>
<span><span class="va">ip</span><span class="op">$</span><span class="va">min_ip</span> <span class="op">&lt;-</span> <span class="va">ip</span><span class="op">$</span><span class="va">date_onset</span> <span class="op">-</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_end</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">min_ip</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
   1.00    2.00    4.00    5.96    7.75   19.00 </code></pre>
</div>
</div>
<div class="section level3">
<h3 id="censura-estimada-ajustada-del-período-de-incubación">7.2. Censura estimada ajustada del período de incubación<a class="anchor" aria-label="anchor" href="#censura-estimada-ajustada-del-per%C3%ADodo-de-incubaci%C3%B3n"></a>
</h3>
<p>Ahora, ajuste tres distribuciones de probabilidad a los datos del
período de incubación teniendo en cuenta la censura doble. Adapte un
código de <code>stan</code> que fue publicado por Miura et al. durante
el brote global de mpox de 2022. Este método no tiene en cuenta el
truncamiento a la derecha ni el sesgo dinámico.</p>
<p>Recuerde que el interés principal es considerar tres distribuciones
de probabilidad: <em>Weibull</em>, <em>gamma</em> y <em>log normal</em>
(Ver Tabla 1).</p>
<p><code>Stan</code> es un programa de software que implementa el
algoritmo Monte Carlo Hamiltoniano (HMC por su siglas en inglés de
Hamiltonian Monte Carlo). HMC es un método de Monte Carlo de cadena de
Markov (MCMC) para ajustar modelos complejos a datos utilizando
estadísticas bayesianas.</p>
<div class="section level4">
<h4 id="corra-el-modelo-en-stan">
<strong>7.1.1. Corra el modelo en Stan</strong><a class="anchor" aria-label="anchor" href="#corra-el-modelo-en-stan"></a>
</h4>
<p>Ajuste las tres distribuciones en este bloque de código.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare los datos</span></span>
<span><span class="va">earliest_exposure</span> <span class="op">&lt;-</span> <span class="fu">as.Date</span><span class="op">(</span><span class="fu">min</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ip</span> <span class="op">&lt;-</span> <span class="va">ip</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">date_onset</span> <span class="op">-</span> <span class="va">earliest_exposure</span><span class="op">)</span>,</span>
<span>         exposure_start <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">exposure_start</span> <span class="op">-</span> <span class="va">earliest_exposure</span><span class="op">)</span>,</span>
<span>         exposure_end <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">exposure_end</span> <span class="op">-</span> <span class="va">earliest_exposure</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">date_onset</span>, <span class="va">exposure_start</span>, <span class="va">exposure_end</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Configure algunas opciones para ejecutar las cadenas MCMC en paralelo</span></span>
<span><span class="co"># Ejecución de las cadenas MCMC en paralelo significa que se ejecutaran varias cadenas al mismo tiempo usando varios núcleos de su computador</span></span>
<span><span class="fu">options</span><span class="op">(</span>mc.cores<span class="op">=</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_data</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>N <span class="op">=</span> <span class="fu">length</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span><span class="op">)</span>, <span class="co"># NNúmero de observaciones</span></span>
<span>              tStartExposure <span class="op">=</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span>,</span>
<span>              tEndExposure <span class="op">=</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_end</span>,</span>
<span>              tSymptomOnset <span class="op">=</span> <span class="va">ip</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tres distribuciones de probabilidad</span></span>
<span><span class="va">distributions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"weibull"</span>, <span class="st">"gamma"</span>, <span class="st">"lognormal"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Código de Stan </span></span>
<span><span class="va">code</span> <span class="op">&lt;-</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  data{</span></span>
<span><span class="st">    int&lt;lower=1&gt; N;</span></span>
<span><span class="st">    vector[N] tStartExposure;</span></span>
<span><span class="st">    vector[N] tEndExposure;</span></span>
<span><span class="st">    vector[N] tSymptomOnset;</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  parameters{</span></span>
<span><span class="st">    real&lt;lower=0&gt; par[2];</span></span>
<span><span class="st">    vector&lt;lower=0, upper=1&gt;[N] uE;  // Uniform value for sampling between start and end exposure</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  transformed parameters{</span></span>
<span><span class="st">    vector[N] tE;   // infection moment</span></span>
<span><span class="st">    tE = tStartExposure + uE .* (tEndExposure - tStartExposure);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">model{</span></span>
<span><span class="st">    // Contribution to likelihood of incubation period</span></span>
<span><span class="st">    target += %s_lpdf(tSymptomOnset -  tE  | par[1], par[2]);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  generated quantities {</span></span>
<span><span class="st">    // likelihood for calculation of looIC</span></span>
<span><span class="st">    vector[N] log_lik;</span></span>
<span><span class="st">    for (i in 1:N) {</span></span>
<span><span class="st">      log_lik[i] = %s_lpdf(tSymptomOnset[i] -  tE[i]  | par[1], par[2]);</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">"</span>, <span class="va">distributions</span>, <span class="va">distributions</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">code</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">distributions</span></span>
<span></span>
<span><span class="co"># La siguiente línea puede tomar ~1.5 min</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="va">stan_model</span>, model_code <span class="op">=</span> <span class="va">code</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Toma ~40 sec.</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="va">sampling</span>, <span class="va">models</span>, <span class="fu">list</span><span class="op">(</span><span class="va">input_data</span><span class="op">)</span>, </span>
<span>              iter<span class="op">=</span><span class="fl">3000</span>, <span class="co"># Número de iteraciones (largo de la cadena MCMC)</span></span>
<span>              warmup<span class="op">=</span><span class="fl">1000</span>, <span class="co"># Número de muestras a descartar al inicio de MCMC</span></span>
<span>              chain<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="co"># Número de cadenas MCMC a ejecutar</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
3:                0.751 seconds (Total)
Chain 3: </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu">rstan</span><span class="fu">::</span><span class="fu">extract</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">$</span><span class="va">par</span>, <span class="va">fit</span>, SIMPLIFY<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># muestreo posterior </span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="revisar-si-hay-convergencia">
<strong>7.1.2. Revisar si hay convergencia</strong><a class="anchor" aria-label="anchor" href="#revisar-si-hay-convergencia"></a>
</h4>
<p>Ahora verifique la convergencia del modelo. Observe los valores de
r-hat, los tamaños de muestra efectivos y las trazas MCMC. R-hat compara
las estimaciones entre y dentro de cadenas para los parámetros del
modelo; valores cercanos a 1 indican que las cadenas se han mezclado
bien (Vehtari et al. 2021). El tamaño de muestra efectivo estima el
número de muestras independientes después de tener en cuenta la
dependencia en las cadenas MCMC (Lambert 2018). Para un modelo con 4
cadenas MCMC, se recomienda un tamaño total de muestra efectiva de al
menos 400 (Vehtari et al. 2021).</p>
<p>Para cada modelo con distribución ajustada:</p>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (4)</strong></em></p>
<ul>
<li><p>¿Los valores de r-hat son cercanos a 1?</p></li>
<li><p>¿Las 4 cadenas MCMC generalmente se superponen y permanecen
alrededor de los mismos valores (se ven como orugas peludas)?</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="convergencia-para-gamma">
<strong>7.1.2.1. Convergencia para Gamma</strong><a class="anchor" aria-label="anchor" href="#convergencia-para-gamma"></a>
</h4>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span>, digits <span class="op">=</span> <span class="fl">3</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Inference for Stan model: anon_model.
4 chains, each with iter=3000; warmup=1000; thin=1;
post-warmup draws per chain=2000, total post-warmup draws=8000.

        mean se_mean    sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
par[1] 1.981   0.003 0.364 1.336 1.725 1.959 2.210 2.768 11798    1
par[2] 0.324   0.001 0.068 0.205 0.276 0.321 0.368 0.471 11144    1

Samples were drawn using NUTS(diag_e) at Thu Mar 13 17:08:38 2025.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at
convergence, Rhat=1).</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rstan</span><span class="fu">::</span><span class="fu">traceplot</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-convergence%20gamma-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level4">
<h4 id="convergencia-para-log-normal">
<strong>7.1.2.2. Convergencia para log normal</strong><a class="anchor" aria-label="anchor" href="#convergencia-para-log-normal"></a>
</h4>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">lognormal</span>, digits <span class="op">=</span> <span class="fl">3</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Inference for Stan model: anon_model.
4 chains, each with iter=3000; warmup=1000; thin=1;
post-warmup draws per chain=2000, total post-warmup draws=8000.

       mean se_mean    sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
par[1] 1.53   0.001 0.116 1.302 1.454 1.530 1.606 1.757  9737    1
par[2] 0.80   0.001 0.085 0.656 0.740 0.794 0.852 0.986  9747    1

Samples were drawn using NUTS(diag_e) at Thu Mar 13 17:08:44 2025.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at
convergence, Rhat=1).</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rstan</span><span class="fu">::</span><span class="fu">traceplot</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">lognormal</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-convergence%20lognormal-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level4">
<h4 id="convergencia-para-weibull">
<strong>7.1.2.3. Convergencia para Weibull</strong><a class="anchor" aria-label="anchor" href="#convergencia-para-weibull"></a>
</h4>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">weibull</span>, digits <span class="op">=</span> <span class="fl">3</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Inference for Stan model: anon_model.
4 chains, each with iter=3000; warmup=1000; thin=1;
post-warmup draws per chain=2000, total post-warmup draws=8000.

        mean se_mean    sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
par[1] 1.375   0.001 0.147 1.101 1.273 1.373 1.474 1.670 10002    1
par[2] 6.958   0.008 0.763 5.586 6.432 6.924 7.452 8.557  9453    1

Samples were drawn using NUTS(diag_e) at Thu Mar 13 17:08:31 2025.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at
convergence, Rhat=1).</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rstan</span><span class="fu">::</span><span class="fu">traceplot</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">weibull</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-convergence%20weibull-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level4">
<h4 id="calcule-los-criterios-de-comparación-de-los-modelos">
<strong>7.1.3. Calcule los criterios de comparación de los
modelos</strong><a class="anchor" aria-label="anchor" href="#calcule-los-criterios-de-comparaci%C3%B3n-de-los-modelos"></a>
</h4>
<p>Calcule el criterio de información ampliamente aplicable (WAIC) y el
criterio de información de dejar-uno-fuera (LOOIC) para comparar los
ajustes de los modelos. El modelo con mejor ajuste es aquel con el WAIC
o LOOIC más bajo. En esta sección también se resumirá las distribuciones
y se hará algunos gráficos.</p>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (5)</strong></em></p>
<ul>
<li>¿Qué modelo tiene mejor ajuste?</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="section"></h4>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calcule WAIC para los tres modelos</span></span>
<span><span class="va">waic</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu">waic</span><span class="op">(</span><span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span>, <span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">waic</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>           weibull     gamma lognormal
Estimate 278.03932 276.19369 272.93468
SE        11.94385  13.40658  13.89128</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Para looic, se necesita proveer los tamaños de muestra relativos</span></span>
<span><span class="co"># al llamar a loo. Este paso lleva a mejores estimados de los tamaños de </span></span>
<span><span class="co"># muestra PSIS efectivos y del error de Monte Carlo </span></span>
<span></span>
<span><span class="co"># Extraer la verosimilitud puntual logarítmica para la distribución Weibull</span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">weibull</span>, merge_chains <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Obtener los tamaños de muestra relativos efectivos</span></span>
<span><span class="va">r_eff</span> <span class="op">&lt;-</span> <span class="fu">relative_eff</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Calcula LOOIC</span></span>
<span><span class="va">loo_w</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="op">(</span><span class="va">loglik</span>, r_eff <span class="op">=</span> <span class="va">r_eff</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span>
<span><span class="co"># Imprimir los resultados</span></span>
<span><span class="va">loo_w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Estimate</span></span>
<span><span class="fl">278.0599</span> </span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extraer la verosimilitud puntual logarítmica para la distribución gamma </span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span>, merge_chains <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">r_eff</span> <span class="op">&lt;-</span> <span class="fu">relative_eff</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">loo_g</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="op">(</span><span class="va">loglik</span>, r_eff <span class="op">=</span> <span class="va">r_eff</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span>
<span><span class="va">loo_g</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Estimate</span></span>
<span> <span class="fl">276.212</span> </span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extraer la verosimilitud puntual logarítmica para la distribución log normal </span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">lognormal</span>, merge_chains <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">r_eff</span> <span class="op">&lt;-</span> <span class="fu">relative_eff</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">loo_l</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="op">(</span><span class="va">loglik</span>, r_eff <span class="op">=</span> <span class="va">r_eff</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span>
<span><span class="va">loo_l</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Estimate</span></span>
<span><span class="fl">272.9477</span> </span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="reporte-los-resultados">
<strong>7.1.4. Reporte los resultados</strong><a class="anchor" aria-label="anchor" href="#reporte-los-resultados"></a>
</h4>
<p>La cola derecha de la distribución del período de incubación es
importante para diseñar estrategias de control (por ejemplo,
cuarentena), los percentiles del 25 al 75 informan sobre el momento más
probable en que podría ocurrir la aparición de síntomas, y la
distribución completa puede usarse como una entrada en modelos
matemáticos o estadísticos, como para pronósticos (Lessler et
al. 2009).</p>
<p>Obtenga las estadísticas resumidas.</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Necesitamos convertir los parámetros de las distribuciones a la media y desviación estándar del rezago</span></span>
<span></span>
<span><span class="co"># En Stan, los parámetros de las distribuciones son:</span></span>
<span><span class="co"># Weibull: forma y escala</span></span>
<span><span class="co"># Gamma: forma e inversa de la escala (aka rate)</span></span>
<span><span class="co"># Log Normal: mu y sigma</span></span>
<span><span class="co"># Referencia: https://mc-stan.org/docs/2_21/functions-reference/positive-continuous-distributions.html</span></span>
<span></span>
<span><span class="co"># Calcule las medias</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span></span>
<span>  <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># media de Weibull</span></span>
<span>  <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="co"># media de gamma</span></span>
<span>  <span class="fu">exp</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># media de log normal</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcule las desviaciones estándar</span></span>
<span><span class="va">standard_deviations</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span></span>
<span>  <span class="fu">sqrt</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">sqrt</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Imprimir los rezagos medios e intervalos creíbles del 95%</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_means</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">means</span>, <span class="fl">2</span>, <span class="va">quantile</span>, <span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">res_means</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">colnames</span><span class="op">(</span><span class="va">waic</span><span class="op">)</span> </span>
<span><span class="va">res_means</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       weibull    gamma lognormal
2.5%  5.197888 5.027110  4.995294
50%   6.346635 6.134130  6.345631
97.5% 7.842575 7.530398  8.503507</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_sds</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">standard_deviations</span>, <span class="fl">2</span>, <span class="va">quantile</span>, <span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">res_sds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">colnames</span><span class="op">(</span><span class="va">waic</span><span class="op">)</span> </span>
<span><span class="va">res_sds</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       weibull    gamma lognormal
2.5%  3.703525 3.418258  3.944310
50%   4.662436 4.370152  5.914605
97.5% 6.286989 5.879537 10.247292</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Informe la mediana e intervalos creíbles del 95% para los cuantiles de cada distribución</span></span>
<span></span>
<span><span class="va">quantiles_to_report</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>, <span class="fl">0.99</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Weibull</span></span>
<span><span class="va">cens_w_percentiles</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">quantiles_to_report</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">qweibull</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="va">probs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">cens_w_percentiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">quantiles_to_report</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cens_w_percentiles</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          0.025      0.05      0.5     0.95    0.975     0.99
2.5%  0.2226648 0.4187368 4.132515 12.57144 14.44430 16.73516
50%   0.4736473 0.7925686 5.303937 15.39771 17.92060 21.06267
97.5% 0.8436894 1.2942736 6.633881 19.90329 23.66104 28.55937</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gamma</span></span>
<span><span class="va">cens_g_percentiles</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">quantiles_to_report</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">qgamma</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="va">probs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">cens_g_percentiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">quantiles_to_report</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cens_g_percentiles</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          0.025     0.05      0.5     0.95    0.975     0.99
2.5%  0.3319419 0.568054 4.105415 11.86654 13.84125 16.29075
50%   0.7177673 1.060611 5.121315 14.62269 17.20068 20.52602
97.5% 1.1966601 1.627537 6.306510 18.82582 22.50940 27.29428</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Log normal</span></span>
<span><span class="va">cens_ln_percentiles</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">quantiles_to_report</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">qlnorm</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="va">probs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">cens_ln_percentiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">quantiles_to_report</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cens_ln_percentiles</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          0.025      0.05      0.5     0.95    0.975     0.99
2.5%  0.6218388 0.8401438 3.677559 12.50864 15.51554 19.86556
50%   0.9753523 1.2517352 4.616236 16.98871 21.81698 29.19024
97.5% 1.3700979 1.6993750 5.795872 25.36863 34.20759 48.89508</code></pre>
</div>
<p>Para cada modelo, encuentre estos elementos para el período de
incubación estimado en la salida de arriba y escribalos abajo.</p>
<ul>
<li><p>Media e intervalo de credibilidad del 95%</p></li>
<li><p>Desviación estándar e intervalo de credibilidad del 95%</p></li>
<li><p>Percentiles (e.g., 2.5, 5, 25, 50, 75, 95, 97.5, 99)</p></li>
<li><p>Los parámetros de las distribuciones ajustadas (e.g., shape y
scale para distribución gamma)</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="grafique-los-resultados">
<strong>7.1.5. Grafique los resultados</strong><a class="anchor" aria-label="anchor" href="#grafique-los-resultados"></a>
</h4>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare los resultados para graficarlos</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span><span class="co">#Tome los valores de las medias para trazar la función de densidad acumulatica empirica</span></span>
<span>  inc_day <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">input_data</span><span class="op">$</span><span class="va">tSymptomOnset</span><span class="op">-</span><span class="va">input_data</span><span class="op">$</span><span class="va">tEndExposure</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="va">input_data</span><span class="op">$</span><span class="va">tSymptomOnset</span><span class="op">-</span><span class="va">input_data</span><span class="op">$</span><span class="va">tStartExposure</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_plot</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="co"># Esto configura el rango del eje x (número de días)</span></span>
<span></span>
<span><span class="va">Gam_plot</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>dose<span class="op">=</span> <span class="va">x_plot</span>, </span>
<span>                               pred<span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               low <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               upp <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Wei_plot</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>dose<span class="op">=</span> <span class="va">x_plot</span>, </span>
<span>                               pred<span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               low <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               upp <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ln_plot</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>dose<span class="op">=</span> <span class="va">x_plot</span>, </span>
<span>                              pred<span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              low <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              upp <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Grafique las curvas de la distribución acumulada </span></span>
<span><span class="va">gamma_ggplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">inc_day</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">Gam_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>, y<span class="op">=</span><span class="va">pred</span><span class="op">)</span>, color<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data<span class="op">=</span><span class="va">Gam_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>,ymin<span class="op">=</span><span class="va">low</span>,ymax<span class="op">=</span><span class="va">upp</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Incubation period (days)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Gamma"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weibul_ggplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">inc_day</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">Wei_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>, y<span class="op">=</span><span class="va">pred</span><span class="op">)</span>, color<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data<span class="op">=</span><span class="va">Wei_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>,ymin<span class="op">=</span><span class="va">low</span>,ymax<span class="op">=</span><span class="va">upp</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Incubation period (days)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Weibull"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lognorm_ggplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">inc_day</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">ln_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>, y<span class="op">=</span><span class="va">pred</span><span class="op">)</span>, color<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data<span class="op">=</span><span class="va">ln_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>,ymin<span class="op">=</span><span class="va">low</span>,ymax<span class="op">=</span><span class="va">upp</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Incubation period (days)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Log normal"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">lognorm_ggplot</span><span class="op">|</span><span class="va">gamma_ggplot</span><span class="op">|</span><span class="va">weibul_ggplot</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-plot%20ip-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>En los gráficos anteriores, la línea negra es la distribución
acumulativa empírica (los datos), mientras que la curva azul es la
distribución de probabilidad ajustada con los intervalos de credibilidad
del 95%. Asegúrese de que la curva azul esté sobre la línea negra.</p>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (6)</strong></em></p>
<ul>
<li>¿Son los ajustes de las distribuciones lo que espera?</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="section-1"></h4>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="pausa-2-_________">
<em><code>_______Pausa 2 _________</code></em><a class="anchor" aria-label="anchor" href="#pausa-2-_________"></a>
</h1>
<div class="section level2">
<h2 id="estimación-del-intervalo-serial">8. Estimación del intervalo serial<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-intervalo-serial"></a>
</h2>
<p>Ahora, estime el intervalo serial. Nuevamente, se realizará primero
una estimación navie calculando la diferencia entre la fecha de inicio
de síntomas entre el par de casos primario y secundario.</p>
<ol style="list-style-type: decimal">
<li><p>¿Existen casos con intervalos seriales negativos en los datos
(por ejemplo, el inicio de los síntomas en el caso secundario ocurrió
antes del inicio de los síntomas en el caso primario)?</p></li>
<li><p>Informe la mediana del intervalo serial, así como el mínimo y el
máximo.</p></li>
<li><p>Grafique la distribución del intervalo serial.</p></li>
</ol>
<div class="section level3">
<h3 id="estimación-naive">8.1. Estimación naive<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-naive"></a>
</h3>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">secondary_onset_date</span> <span class="op">-</span> <span class="va">contacts</span><span class="op">$</span><span class="va">primary_onset_date</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
  1.000   4.000   6.000   7.625  10.000  23.000 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span>, xlab <span class="op">=</span> <span class="st">"Serial interval (days)"</span>, breaks <span class="op">=</span> <span class="fl">25</span>, main <span class="op">=</span> <span class="st">""</span>, col <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-si%20naive-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="estimación-ajustada-por-censura">8.2. Estimación ajustada por censura<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-ajustada-por-censura"></a>
</h3>
<p>Ahora se estimará el intervalo serial utilizando una implementación
del paquete <code>courseDataTools</code> dentro del paquete R
<code>EpiEstim</code>. Este método tiene en cuenta la censura doble y
permite comparar diferentes distribuciones de probabilidad, pero no se
ajusta por truncamiento a la derecha o sesgo dinámico.</p>
<p>Se considerará tres distribuciones de probabilidad y deberá
seleccionar la que mejor se ajuste a los datos utilizando WAIC o LOOIC.
Recuerde que la distribución con mejor ajuste tendrá el WAIC o LOOIC más
bajo.</p>
<p>Ten en cuenta que en <code>coarseDataTools</code>, los parámetros
para las distribuciones son ligeramente diferentes que en rstan. Aquí,
los parámetros para la distribución gamma son shape y scale (forma y
escala) (<a href="https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf" class="external-link uri">https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf</a>).</p>
<p>Solo se ejecutará una cadena MCMC para cada distribución en interés
del tiempo, pero en la práctica debería ejecutar más de una cadena para
asegurarse de que el MCMC converge en la distribución objetivo. Usará
las distribuciones a priori predeterminadas, que se pueden encontrar en
la documentación del paquete (ver ‘detalles’ para la función
dic.fit.mcmc aquí: (<a href="https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf" class="external-link uri">https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf</a>).</p>
<div class="section level4">
<h4 id="preparación-de-los-datos">8.2.1. Preparación de los datos<a class="anchor" aria-label="anchor" href="#preparaci%C3%B3n-de-los-datos"></a>
</h4>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Formatee los datos de intervalos censurados del intervalo serial</span></span>
<span></span>
<span><span class="co"># Cada línea representa un evento de transmisión</span></span>
<span><span class="co"># EL/ER muestran el límite inferior/superior de la fecha de inicio de los síntomas en el caso primario (infector)</span></span>
<span><span class="co"># SL/SR muestran lo mismo para el caso secundario (infectado)</span></span>
<span><span class="co"># type tiene entradas 0 que corresponden a datos censurados doblemente por intervalo</span></span>
<span><span class="co"># (ver Reich et al. Statist. Med. 2009)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">si_data</span> <span class="op">&lt;-</span> <span class="va">contacts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">primary_case_id</span>, <span class="op">-</span><span class="va">secondary_case_id</span>, <span class="op">-</span><span class="va">primary_onset_date</span>, <span class="op">-</span><span class="va">secondary_onset_date</span>,<span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>SL <span class="op">=</span> <span class="va">diff</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>type <span class="op">=</span> <span class="fl">0</span>, EL <span class="op">=</span> <span class="fl">0</span>, ER <span class="op">=</span> <span class="fl">1</span>, SR <span class="op">=</span> <span class="va">SL</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">EL</span>, <span class="va">ER</span>, <span class="va">SL</span>, <span class="va">SR</span>, <span class="va">type</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="ajuste-una-distribución-gamma-para-el-si">8.2.2. Ajuste una distribución gamma para el SI<a class="anchor" aria-label="anchor" href="#ajuste-una-distribuci%C3%B3n-gamma-para-el-si"></a>
</h4>
<p>Primero, ajuste una distribución gamma al intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">overall_seed</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># semilla para el generador de números aleatorios para MCMC</span></span>
<span><span class="va">MCMC_seed</span> <span class="op">&lt;-</span> <span class="fl">007</span></span>
<span></span>
<span><span class="co"># Ejecutaremos el modelo durante 4000 iteraciones con las primeras 1000 muestras descartadas como burning</span></span>
<span><span class="va">n_mcmc_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># número de muestras a extraer de la posterior (después del burning)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="st">"G"</span>, <span class="co"># Ajuste de una distribución Gamma para el Intervalo Serial (SI)</span></span>
<span>  method <span class="op">=</span> <span class="st">"MCMC"</span>, <span class="co"># MCMC usando coarsedatatools</span></span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># número de muestras de burning (muestras descartadas al comienzo de MCMC) </span></span>
<span>  n1 <span class="op">=</span> <span class="fl">50</span>, <span class="co"># n1 es el número de pares de media y desviación estándar del SI que se extraen</span></span>
<span>  n2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># n2 es el tamaño de la muestra posterior extraída para cada par de media y desviación estándar del SI</span></span>
<span></span>
<span></span>
<span><span class="va">mcmc_control</span> <span class="op">&lt;-</span> <span class="fu">make_mcmc_control</span><span class="op">(</span></span>
<span>seed <span class="op">=</span> <span class="va">MCMC_seed</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">burnin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">dist</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span></span>
<span><span class="fu">list</span><span class="op">(</span></span>
<span>si_parametric_distr <span class="op">=</span> <span class="va">dist</span>,</span>
<span>mcmc_control <span class="op">=</span> <span class="va">mcmc_control</span>,</span>
<span>seed <span class="op">=</span> <span class="va">overall_seed</span>,</span>
<span>n1 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>n2 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ajuste el SI</span></span>
<span><span class="va">si_fit_gamma</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu">dic.fit.mcmc</span><span class="op">(</span></span>
<span>dat <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>init.pars <span class="op">=</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">burnin</span>,</span>
<span>n.samples <span class="op">=</span> <span class="va">n_mcmc_samples</span>,</span>
<span>seed <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Running 4000 MCMC iterations
MCMCmetrop1R iteration 1 of 4000
function value = -201.95281
theta =
   1.04012
   0.99131
Metropolis acceptance rate = 0.00000

MCMCmetrop1R iteration 1001 of 4000
function value = -202.42902
theta =
   0.95294
   1.05017
Metropolis acceptance rate = 0.55445

MCMCmetrop1R iteration 2001 of 4000
function value = -201.88547
theta =
   1.18355
   0.82124
Metropolis acceptance rate = 0.56522

MCMCmetrop1R iteration 3001 of 4000
function value = -202.11109
theta =
   1.26323
   0.77290
Metropolis acceptance rate = 0.55148



@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The Metropolis acceptance rate was 0.55500
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</code></pre>
</div>
<p>Ahora observe los resultados.</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verificar convergencia de las cadenas MCMC </span></span>
<span><span class="va">converg_diag_gamma</span> <span class="op">&lt;-</span> <span class="fu">check_cdt_samples_convergence</span><span class="op">(</span><span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Gelman-Rubin MCMC convergence diagnostic was successful.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">converg_diag_gamma</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Guardar las muestras MCMC en un dataframe</span></span>
<span><span class="va">si_samples_gamma</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>type <span class="op">=</span> <span class="st">'Symptom onset'</span>,</span>
<span>shape <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>,</span>
<span>scale <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span>,</span>
<span>p50 <span class="op">=</span> <span class="fu">qgamma</span><span class="op">(</span></span>
<span>p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>shape <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>, </span>
<span>scale <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">mutate</span><span class="op">(</span> <span class="co"># La ecuación de conversión se encuentra aquí: https://en.wikipedia.org/wiki/Gamma_distribution</span></span>
<span>mean <span class="op">=</span> <span class="va">shape</span><span class="op">*</span><span class="va">scale</span>,</span>
<span>sd <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">shape</span><span class="op">*</span><span class="va">scale</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Obtener la media, desviación estándar y 95% CrI</span></span>
<span></span>
<span><span class="va">si_summary_gamma</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">si_samples_gamma</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>mean_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>mean_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>mean_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sd_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sd_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sd_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">si_summary_gamma</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.659641   6.65395  8.707372 4.342087 3.602425 5.481316</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga las mismas estadísticas de resumen para los parámetros de la distribución</span></span>
<span><span class="va">si_samples_gamma</span> <span class="op">|&gt;</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>shape_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>shape_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>shape_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>scale_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>scale_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>scale_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Necesita esto para hacer gráficos más tarde</span></span>
<span><span class="va">gamma_shape</span> <span class="op">&lt;-</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'shape'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">gamma_rate</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'scale'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="ajuste-de-una-distribución-log-normal-para-el-intervalo-serial">8.2.3. Ajuste de una distribución log normal para el intervalo
serial<a class="anchor" aria-label="anchor" href="#ajuste-de-una-distribuci%C3%B3n-log-normal-para-el-intervalo-serial"></a>
</h4>
<p>Ahora, ajuste una distribución log normal a los datos del intervalo
serial.</p>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ejecute el modelo durante 4000 iteraciones, descartando las primeras 1000 muestras como burning</span></span>
<span><span class="va">n_mcmc_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># número de muestras a extraer de la posterior (después del burning)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="st">"L"</span>, <span class="co"># Ajustando una distribución log-normal para el Intervalo Serial (SI)</span></span>
<span>  method <span class="op">=</span> <span class="st">"MCMC"</span>, <span class="co"># MCMC usando coarsedatatools</span></span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># número de muestras de burning (muestras descartadas al comienzo de MCMC) </span></span>
<span>  n1 <span class="op">=</span> <span class="fl">50</span>, <span class="co"># n1 es el número de pares de media y desviación estándar de SI que se extraen</span></span>
<span>  n2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># n2 es el tamaño de la muestra posterior extraída para cada par de media y desviación estándar de SI</span></span>
<span></span>
<span></span>
<span><span class="va">mcmc_control</span> <span class="op">&lt;-</span> <span class="fu">make_mcmc_control</span><span class="op">(</span></span>
<span>seed <span class="op">=</span> <span class="va">MCMC_seed</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">burnin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">dist</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span></span>
<span><span class="fu">list</span><span class="op">(</span></span>
<span>si_parametric_distr <span class="op">=</span> <span class="va">dist</span>,</span>
<span>mcmc_control <span class="op">=</span> <span class="va">mcmc_control</span>,</span>
<span>seed <span class="op">=</span> <span class="va">overall_seed</span>,</span>
<span>n1 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>n2 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ajuste del intervalo serial</span></span>
<span><span class="va">si_fit_lnorm</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu">dic.fit.mcmc</span><span class="op">(</span></span>
<span>dat <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>init.pars <span class="op">=</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">burnin</span>,</span>
<span>n.samples <span class="op">=</span> <span class="va">n_mcmc_samples</span>,</span>
<span>seed <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Running 4000 MCMC iterations
MCMCmetrop1R iteration 1 of 4000
function value = -216.54581
theta =
   1.94255
  -0.47988
Metropolis acceptance rate = 1.00000

MCMCmetrop1R iteration 1001 of 4000
function value = -216.21549
theta =
   1.81272
  -0.47418
Metropolis acceptance rate = 0.56643

MCMCmetrop1R iteration 2001 of 4000
function value = -215.86791
theta =
   1.85433
  -0.52118
Metropolis acceptance rate = 0.57221

MCMCmetrop1R iteration 3001 of 4000
function value = -216.32347
theta =
   1.93196
  -0.52205
Metropolis acceptance rate = 0.55948



@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The Metropolis acceptance rate was 0.56875
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</code></pre>
</div>
<p>Revise los resultados.</p>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise la convergencia de las cadenas MCMC </span></span>
<span><span class="va">converg_diag_lnorm</span> <span class="op">&lt;-</span> <span class="fu">check_cdt_samples_convergence</span><span class="op">(</span><span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Gelman-Rubin MCMC convergence diagnostic was successful.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">converg_diag_lnorm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Guarde las muestras de MCMC en un dataframe</span></span>
<span><span class="va">si_samples_lnorm</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>type <span class="op">=</span> <span class="st">'Symptom onset'</span>,</span>
<span>meanlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>,</span>
<span>sdlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span>,</span>
<span>p50 <span class="op">=</span> <span class="fu">qlnorm</span><span class="op">(</span></span>
<span>p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>meanlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>, </span>
<span>sdlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">mutate</span><span class="op">(</span> <span class="co"># La ecuación para la conversión está aquí https://en.wikipedia.org/wiki/Log-normal_distribution</span></span>
<span>mean <span class="op">=</span> <span class="fu">exp</span><span class="op">(</span><span class="va">meanlog</span> <span class="op">+</span> <span class="op">(</span><span class="va">sdlog</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>sd <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">sdlog</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">meanlog</span> <span class="op">+</span> <span class="va">sdlog</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga la media, desviación estándar e intervalo de credibilidad del 95% </span></span>
<span><span class="va">si_summary_lnorm</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">si_samples_lnorm</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>mean_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>mean_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>mean_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sd_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sd_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sd_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">si_summary_lnorm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.780719  6.692829  9.300588 5.189349 3.936678 7.289224</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga las estadísticas resumen para los parámetros de la distribución</span></span>
<span><span class="va">si_samples_lnorm</span> <span class="op">|&gt;</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>meanlog_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">meanlog</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>meanlog_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">meanlog</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>meanlog_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">meanlog</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sdlog_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sdlog</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sdlog_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sdlog</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sdlog_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sdlog</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  meanlog_mean meanlog_l_ci meanlog_u_ci sdlog_mean sdlog_l_ci sdlog_u_ci
1     1.866779     1.724069     2.015255  0.6086726  0.5107204   0.725803</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lognorm_meanlog</span> <span class="op">&lt;-</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'meanlog'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">lognorm_sdlog</span> <span class="op">&lt;-</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'sdlog'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="ajuste-de-una-distribución-weibull-para-el-intervalo-serial">8.2.4. Ajuste de una distribución Weibull para el intervalo
serial<a class="anchor" aria-label="anchor" href="#ajuste-de-una-distribuci%C3%B3n-weibull-para-el-intervalo-serial"></a>
</h4>
<p>Finalmente, ajuste de una distribución Weibull para los datos del
intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb81">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ejecutaremos el modelo durante 4000 iteraciones, descartando las primeras 1000 muestras como burning</span></span>
<span><span class="va">n_mcmc_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># número de muestras a extraer de la posterior (después del burning)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="st">"W"</span>, <span class="co"># Ajustando una distribución Weibull para el Intervalo Serial (SI)</span></span>
<span>  method <span class="op">=</span> <span class="st">"MCMC"</span>, <span class="co"># MCMC usando coarsedatatools</span></span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># número de muestras de burning (muestras descartadas al comienzo de MCMC) </span></span>
<span>  n1 <span class="op">=</span> <span class="fl">50</span>, <span class="co"># n1 es el número de pares de media y desviación estándar de SI que se extraen</span></span>
<span>  n2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># n2 es el tamaño de la muestra posterior extraída para cada par de media y desviación estándar de SI</span></span>
<span></span>
<span><span class="va">mcmc_control</span> <span class="op">&lt;-</span> <span class="fu">make_mcmc_control</span><span class="op">(</span></span>
<span>seed <span class="op">=</span> <span class="va">MCMC_seed</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">burnin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">dist</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span></span>
<span><span class="fu">list</span><span class="op">(</span></span>
<span>si_parametric_distr <span class="op">=</span> <span class="va">dist</span>,</span>
<span>mcmc_control <span class="op">=</span> <span class="va">mcmc_control</span>,</span>
<span>seed <span class="op">=</span> <span class="va">overall_seed</span>,</span>
<span>n1 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>n2 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ajuste el intervalo serial </span></span>
<span><span class="va">si_fit_weibull</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu">dic.fit.mcmc</span><span class="op">(</span></span>
<span>dat <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>init.pars <span class="op">=</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">burnin</span>,</span>
<span>n.samples <span class="op">=</span> <span class="va">n_mcmc_samples</span>,</span>
<span>seed <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span></code></pre>
</div>
<p>Revise los resultados.</p>
<div class="codewrapper sourceCode" id="cb82">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise covengencia</span></span>
<span><span class="va">converg_diag_weibull</span> <span class="op">&lt;-</span> <span class="fu">check_cdt_samples_convergence</span><span class="op">(</span><span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Gelman-Rubin MCMC convergence diagnostic was successful.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">converg_diag_weibull</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb86">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Guarde las muestra MCMC en un dataframe</span></span>
<span><span class="va">si_samples_weibull</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>type <span class="op">=</span> <span class="st">'Symptom onset'</span>,</span>
<span>shape <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>,</span>
<span>scale <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span>,</span>
<span>p50 <span class="op">=</span> <span class="fu">qweibull</span><span class="op">(</span></span>
<span>p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>shape <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>, </span>
<span>scale <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">mutate</span><span class="op">(</span> <span class="co"># La ecuación para conversión está aquí https://en.wikipedia.org/wiki/Weibull_distribution</span></span>
<span>mean <span class="op">=</span> <span class="va">scale</span><span class="op">*</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span>,</span>
<span>sd <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">scale</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb87">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga las estadísticas resumen</span></span>
<span><span class="va">si_summary_weibull</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">si_samples_weibull</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>mean_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>mean_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>mean_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sd_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sd_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sd_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">si_summary_weibull</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.692701  6.677548  8.809715 4.418743 3.797158 5.456492</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb89">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga las estadísticas resumen para los parámetros de la distribución.</span></span>
<span><span class="va">si_samples_weibull</span> <span class="op">|&gt;</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>shape_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>shape_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>shape_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>scale_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>scale_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>scale_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  shape_mean shape_l_ci shape_u_ci scale_mean scale_l_ci scale_u_ci
1   1.791214    1.50812   2.090071   8.631295   7.481234   9.943215</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb91">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weibull_shape</span> <span class="op">&lt;-</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'shape'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">weibull_scale</span> <span class="op">&lt;-</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'scale'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="grafique-los-resultados-para-el-intervalo-serial">8.2.5. Grafique los resultados para el intervalo serial<a class="anchor" aria-label="anchor" href="#grafique-los-resultados-para-el-intervalo-serial"></a>
</h4>
<p>Ahora, grafique el ajuste de las tres distribuciones. Asegúrese que
la distribución ajuste bien los datos del intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">contacts</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">diff</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"#FFAD05"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">10</span>,<span class="fl">12</span>,<span class="fl">14</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    linewidth<span class="op">=</span><span class="fl">.8</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span><span class="op">(</span><span class="fu">dgamma</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">gamma_shape</span>, rate <span class="op">=</span> <span class="va">gamma_rate</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>linetype  <span class="op">=</span> <span class="st">'Gamma'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    linewidth<span class="op">=</span><span class="fl">.8</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">meanlog</span>, <span class="va">sdlog</span><span class="op">)</span><span class="op">(</span><span class="fu">dlnorm</span><span class="op">(</span><span class="va">z</span>, <span class="va">meanlog</span>, <span class="va">sdlog</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>meanlog <span class="op">=</span> <span class="va">lognorm_meanlog</span>, sdlog <span class="op">=</span> <span class="va">lognorm_sdlog</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span><span class="st">'Log normal'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    linewidth<span class="op">=</span><span class="fl">.8</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">scale</span><span class="op">)</span><span class="op">(</span><span class="fu">dweibull</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">scale</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">weibull_shape</span>, scale <span class="op">=</span> <span class="va">weibull_scale</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span><span class="st">'Weibull'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'solid'</span>,<span class="st">'twodash'</span>,<span class="st">'dotted'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days"</span>, y <span class="op">=</span> <span class="st">"Number of case pairs"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">5.2</span>,<span class="fl">.2</span>,<span class="fl">.2</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ADVERTENCIA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-plot%20dist-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Ahora calcule el WAIC y LOOIC. <code>coarseDataTools</code> no tiene
una forma integrada de hacer esto, por lo que se necesita calcular la
verosimilitud a partir de las cadenas MCMC y utilizar el paquete
<code>loo</code> en R.</p>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cargue las funciones de verosimilitud de coarseDataTools</span></span>
<span><span class="va">calc_looic_waic</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">symp</span>, <span class="va">symp_si</span>, <span class="va">dist</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="co"># Prepare los datos y parámetros para el paquete loo</span></span>
<span><span class="co"># Se necesita: una matriz de tamaño S por N, donde S es el tamaño de la muestra posterior (con todas las cadenas fusionadas)</span></span>
<span><span class="co"># y N es el número de puntos de datos</span></span>
<span></span>
<span>  </span>
<span>  <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fu">length</span><span class="op">(</span><span class="va">symp_si</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">si_data</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">nrow</span><span class="op">(</span><span class="va">symp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span><span class="op">(</span><span class="va">symp_si</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu">diclik2</span><span class="op">(</span>par1 <span class="op">=</span> <span class="va">symp_si</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>                 par2 <span class="op">=</span> <span class="va">symp_si</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, </span>
<span>                 EL <span class="op">=</span> <span class="va">symp</span><span class="op">$</span><span class="va">EL</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, ER <span class="op">=</span> <span class="va">symp</span><span class="op">$</span><span class="va">ER</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, SL <span class="op">=</span> <span class="va">symp</span><span class="op">$</span><span class="va">SL</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, SR <span class="op">=</span> <span class="va">symp</span><span class="op">$</span><span class="va">SR</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                 dist <span class="op">=</span> <span class="va">dist</span><span class="op">)</span></span>
<span>    <span class="va">mat</span><span class="op">[</span><span class="va">j</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">L</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>waic <span class="op">=</span> <span class="fu">waic</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              looic <span class="op">=</span> <span class="fu">loo</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># now we have to take the log to get log likelihood</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">compare_gamma</span> <span class="op">&lt;-</span> <span class="fu">calc_looic_waic</span><span class="op">(</span>symp <span class="op">=</span> <span class="va">si_data</span>, symp_si <span class="op">=</span> <span class="va">si_fit_gamma</span>, dist <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span></span>
<span><span class="va">compare_lnorm</span> <span class="op">&lt;-</span> <span class="fu">calc_looic_waic</span><span class="op">(</span>symp <span class="op">=</span> <span class="va">si_data</span>, symp_si <span class="op">=</span> <span class="va">si_fit_lnorm</span>, dist <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span></span>
<span><span class="va">compare_weibull</span> <span class="op">&lt;-</span> <span class="fu">calc_looic_waic</span><span class="op">(</span>symp <span class="op">=</span> <span class="va">si_data</span>, symp_si <span class="op">=</span> <span class="va">si_fit_weibull</span>, dist <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Imprima resultados</span></span>
<span><span class="va">compare_gamma</span><span class="op">[[</span><span class="st">"waic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Estimate         SE
elpd_waic -202.009546  7.0118463
p_waic       1.936991  0.4409454
waic       404.019093 14.0236925</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb96">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_lnorm</span><span class="op">[[</span><span class="st">"waic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Estimate         SE
elpd_waic -202.215546  7.0178113
p_waic       1.874728  0.4106866
waic       404.431092 14.0356226</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb98">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_weibull</span><span class="op">[[</span><span class="st">"waic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Estimate         SE
elpd_waic -203.941362  6.9020056
p_waic       2.083623  0.6633186
waic       407.882723 13.8040112</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb100">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_gamma</span><span class="op">[[</span><span class="st">"looic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Estimate         SE
elpd_loo -202.015856  7.0144149
p_loo       1.943301  0.4437589
looic     404.031713 14.0288297</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb102">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_lnorm</span><span class="op">[[</span><span class="st">"looic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Estimate         SE
elpd_loo -202.218954  7.0182826
p_loo       1.878136  0.4114664
looic     404.437909 14.0365651</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb104">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_weibull</span><span class="op">[[</span><span class="st">"looic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Estimate         SE
elpd_loo -203.956018  6.9097884
p_loo       2.098279  0.6725387
looic     407.912036 13.8195768</code></pre>
</div>
<p>Incluya lo siguiente cuando reporte el intervalo serial:</p>
<ul>
<li><p>Media e intervalo de credibilidad del 95%</p></li>
<li><p>Desviación estándar y e intervalo de credibilidad del
95%</p></li>
<li><p>Los parámetros de la distribución ajustada (e.g., shape y scale
para distribución gamma)</p></li>
</ul>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (7)</strong></em></p>
<ul>
<li>¿Qué distribución tiene el menor WAIC y LOOIC??</li>
</ul>
</div>
<div class="codewrapper sourceCode" id="cb106">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_gamma</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.659641   6.65395  8.707372 4.342087 3.602425 5.481316</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb108">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_lnorm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.780719  6.692829  9.300588 5.189349 3.936678 7.289224</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb110">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_weibull</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.692701  6.677548  8.809715 4.418743 3.797158 5.456492</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="pausa-3-_________">
<em><code>_______Pausa 3 _________</code></em><a class="anchor" aria-label="anchor" href="#pausa-3-_________"></a>
</h1>
<div class="section level2">
<h2 id="medidas-de-control">9. Medidas de control<a class="anchor" aria-label="anchor" href="#medidas-de-control"></a>
</h2>
<div class="section level3">
<h3 id="analicemos-el-resultado-juntos">9.1 Analicemos el resultado juntos<a class="anchor" aria-label="anchor" href="#analicemos-el-resultado-juntos"></a>
</h3>
<div class="alert alert-secondary">
<p>Ahora ha finalizado el análisis estadístico 🥳</p>
<ul>
<li><p>Compare el período de incubación y el intervalo serial.</p></li>
<li><p>¿Cuál es más largo?</p></li>
<li><p>¿Ocurre la transmisión pre-sintomática con la Enfermedad
X?</p></li>
</ul>
<!-- --><ul>
<li><p>¿Serán medidas efectivas aislar a los individuos sintomáticos y
rastrear y poner en cuarentena a sus contactos?</p></li>
<li><p>Si no lo son, ¿qué otras medidas se pueden implementar para
frenar el brote?</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="diseño-de-una-estrategía-de-rastreo-de-contactos">9.2 Diseño de una estrategía de rastreo de contactos<a class="anchor" aria-label="anchor" href="#dise%C3%B1o-de-una-estrateg%C3%ADa-de-rastreo-de-contactos"></a>
</h3>
<p>Basado en los rezagos estimados así como la demografía de los casos,
diseñe una estrategia de rastreo de contactos para el brote, incluyendo
un plan de comunicaciones (Pista: piense sobre la logística).</p>
</div>
</div>
<div class="section level2">
<h2 id="valores-verdaderos">10. Valores verdaderos<a class="anchor" aria-label="anchor" href="#valores-verdaderos"></a>
</h2>
<p>Los valores verdaderos usados para simular las epidemías fueron:</p>
<table style="width:96%;" class="table">
<caption>Tabla 2. Valores verdaderos del <strong><em>período de
incubación.</em></strong>
</caption>
<colgroup>
<col width="19%">
<col width="21%">
<col width="19%">
<col width="33%">
<col width="2%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>Distribución</td>
<td colspan="3">Media (días) | Desviación estándar (días)</td>
</tr>
<tr class="even">
<td>Grupo 1</td>
<td>Log normal</td>
<td>5.7</td>
<td>4.6</td>
<td></td>
</tr>
<tr class="odd">
<td>Grupo 2</td>
<td>Weibull</td>
<td>7.1</td>
<td>3.7</td>
<td></td>
</tr>
</tbody>
</table>
<table style="width:96%;" class="table">
<caption>Tabla 3. Valores verdaderos del <strong><em>intervalo
serial</em></strong>.</caption>
<colgroup>
<col width="18%">
<col width="22%">
<col width="18%">
<col width="34%">
<col width="2%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>Distribución</td>
<td colspan="3">Media (días) | Desviación estándar (días)</td>
</tr>
<tr class="even">
<td>Group 1</td>
<td>Gamma</td>
<td>8.4</td>
<td>4.9</td>
<td></td>
</tr>
<tr class="odd">
<td>Group 2</td>
<td>Gamma</td>
<td>4.8</td>
<td>3.3</td>
<td></td>
</tr>
</tbody>
</table>
<p>¿Cómo se comparan sus estimaciones con los valores verdaderos?
Discuta las posibles razones para las diferencias.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<p>Revise si al final de esta lección adquirió estas competencias:</p>
<ul>
<li><p>Comprender los conceptos clave de las distribuciones de retrasos
epidemiológicos para la Enfermedad X.</p></li>
<li><p>Entender las estructuras de datos y las herramientas para el
análisis de datos de rastreo de contactos.</p></li>
<li><p>Aprender cómo ajustar las estimaciones del intervalo serial y del
período de incubación de la Enfermedad X teniendo en cuenta la censura
por intervalo usando un marco de trabajo Bayesiano.</p></li>
<li><p>Aprender a utilizar estos parámetros para informar estrategias de
control en un brote de un patógeno desconocido.</p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="recursos-adicionales">11. Recursos adicionales<a class="anchor" aria-label="anchor" href="#recursos-adicionales"></a>
</h2>
<p>En este práctica, en gran medida se ignoraron los sesgos de
truncamiento a la derecha y sesgo dinámico, en parte debido a la falta
de herramientas fácilmente disponibles que implementen las mejores
prácticas. Para aprender más sobre cómo estos sesgos podrían afectar la
estimación de las distribuciones de retraso epidemiológico en tiempo
real, recomendamos un tutorial sobre el paquete
<code>dynamicaltruncation</code> en R de Sam Abbott y Sang Woo Park (<a href="https://github.com/parksw3/epidist-paper" class="external-link uri">https://github.com/parksw3/epidist-paper</a>).</p>
</div>
<div class="section level2">
<h2 id="contribuidores">12. Contribuidores<a class="anchor" aria-label="anchor" href="#contribuidores"></a>
</h2>
<p>Kelly Charniga, Zachary Madewell, Zulma M. Cucunubá</p>
</div>
<div class="section level2">
<h2 id="referencias">13. Referencias<a class="anchor" aria-label="anchor" href="#referencias"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Reich NG et al. Estimating incubation period distributions with
coarse data. Stat Med. 2009;28:2769–84. PubMed <a href="https://doi.org/10.1002/sim.3659" class="external-link uri">https://doi.org/10.1002/sim.3659</a>
</li>
<li>Miura F et al. Estimated incubation period for monkeypox cases
confirmed in the Netherlands, May 2022. Euro Surveill.
2022;27(24):pii=2200448. <a href="https://doi.org/10.2807/1560-7917.ES.2022.27.24.2200448" class="external-link uri">https://doi.org/10.2807/1560-7917.ES.2022.27.24.2200448</a>
</li>
<li>Abbott S, Park Sang W. Adjusting for common biases in infectious
disease data when estimating distributions. 2022 [cited 7 November
2023]. <a href="https://github.com/parksw3/dynamicaltruncation" class="external-link uri">https://github.com/parksw3/dynamicaltruncation</a>
</li>
<li>Lessler J et al. Incubation periods of acute respiratory viral
infections: a systematic review, The Lancet Infectious Diseases.
2009;9(5):291-300. <a href="https://doi.org/10.1016/S1473-3099(09)70069-6" class="external-link uri">https://doi.org/10.1016/S1473-3099(09)70069-6</a>.</li>
<li>Cori A et al. Estimate Time Varying Reproduction Numbers from
Epidemic Curves. 2022 [cited 7 November 2023]. <a href="https://github.com/mrc-ide/EpiEstim" class="external-link uri">https://github.com/mrc-ide/EpiEstim</a>
</li>
<li>Lambert B. A Student’s Guide to Bayesian Statistics. Los Angeles,
London, New Delhi, Singapore, Washington DC, Melbourne: SAGE, 2018.</li>
<li>Vehtari A et al. Rank-normalization, folding, and localization: An
improved R-hat for assessing convergence of MCMC. Bayesian Analysis
2021: Advance publication 1-28. <a href="https://doi.org/10.1214/20-BA1221" class="external-link uri">https://doi.org/10.1214/20-BA1221</a>
</li>
<li>Nishiura H et al. Serial interval of novel coronavirus (COVID-19)
infections. Int J Infect Dis. 2020;93:284-286. <a href="https://doi.org/10.1016/j.ijid.2020.02.060" class="external-link uri">https://doi.org/10.1016/j.ijid.2020.02.060</a>
</li>
</ol>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div></section><section id="aio-Sivirep-tutorial"><p>Content from <a href="Sivirep-tutorial.html">Generar reportes a partir de bases de datos de vigilancia epidemiológica usando sivirep</a></p>
<hr>
<p>Última actualización: 2025-03-13 |

        <a href="https://github.com/epiverse-trace/epimodelac/edit/main/episodes/Sivirep-tutorial.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo obtener un informe automatico de datos de SIVIGILA usando
<code>sivirep</code>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<p>Al final de este taller usted podrá:</p>
<ul>
<li><p>Conocer el paquete <code>sivirep</code></p></li>
<li><p>Identificar las funcionalidades principales de
<code>sivirep</code> para generar un reporte básico.</p></li>
<li><p>Hacer uso de <code>sivirep</code> para el análisis de una de las
enfermedades con mayor impacto en la región, como herramienta para la
toma de decisiones y análisis.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introducción">Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>Colombia ha mejorado a lo largo de los años la calidad, la
accesibilidad y la transparencia de su sistema oficial de vigilancia
epidemiológica, SIVIGILA. Este sistema está regulado por el Instituto
Nacional de Salud de Colombia y es operado por miles de trabajadores de
la salud en las secretarías de salud locales, hospitales y unidades
primarias generadoras de datos.</p>
<p>Sin embargo, todavía existen desafíos, especialmente a nivel local,
en cuanto a la oportunidad y la calidad del análisis epidemiológico y de
los informes epidemiológicos. Estas tareas pueden requerir una gran
cantidad de trabajo manual debido a limitaciones en el entrenamiento
para el análisis de datos, el tiempo que se requiere invertir, la
tecnología y la calidad del acceso a internet en algunas regiones de
Colombia.</p>
</section><section><h2 class="section-heading" id="objetivos">Objetivos<a class="anchor" aria-label="anchor" href="#objetivos"></a>
</h2>
<hr class="half-width">
<ul>
<li>Conocer el paquete <code>sivirep</code>
</li>
<li>Identificar las funcionalidades principales de <code>sivirep</code>
para generar un reporte básico.</li>
<li>Hacer uso de <code>sivirep</code> para el análisis de una de las
enfermedades con mayor impacto en la región, como herramienta para la
toma de decisiones y análisis.</li>
</ul></section><section><h2 class="section-heading" id="conceptos-básicos-a-desarrollar">Conceptos básicos a desarrollar<a class="anchor" aria-label="anchor" href="#conceptos-b%C3%A1sicos-a-desarrollar"></a>
</h2>
<hr class="half-width">
<p>En esta práctica se desarrollarán los siguientes conceptos:</p>
<ul>
<li><p>Función: conjunto de instrucciones que se encargan de transformar
las entradas en los resultados deseados.</p></li>
<li><p>Modulo: cojunto de funciones que son agrupadas debido a su
relación conceptual, resultados proporcionados y definición de
responsabilidades.</p></li>
<li><p>R Markdown: es una extensión del formato Markdown que permite
combinar texto con código R incrustado en el documento. Es una
herramienta para generar informes automatizados y documentos técnicos
interactivos.</p></li>
<li><p>SIVIGILA: Sistema de Notificación y Vigilancia en Salud Pública
de Colombia.</p></li>
<li><p>Microdatos: Son los datos sobre las características de las
unidades de estudio de una población (individuos, hogares,
establecimientos, entre otras) que se encuentran consolidados en una
base de datos.</p></li>
<li><p>Evento: Conjunto de sucesos o circunstancias que pueden modificar
o incidir en la situación de salud de una comunidad.</p></li>
<li><p>Incidencia: Es la cantidad de casos nuevos de un evento o una
enfermedad que se presenta durante un período de tiempo específico.
Usualmente, se presentá como el número de casos por población a riesgo,
y por ello el denominador podría variar dependiendo del evento o
enfermedad.</p></li>
<li><p>Departamento: En Colombia, existen 32 unidades geográficas
administrativas (adm1) llamadas departamentos.</p></li>
<li><p>Municipio: Corresponden al segundo nivel de división
administrativa en Colombia, que mediante agrupación conforman los
departamentos. Colombia posee 1104 municipios registrados.</p></li>
<li><p>Reporte: análisis descriptivo de una enfermedad o evento del
SIVIGILA.</p></li>
</ul></section><section><h2 class="section-heading" id="contenido-del-taller">Contenido del taller<a class="anchor" aria-label="anchor" href="#contenido-del-taller"></a>
</h2>
<hr class="half-width">
<p>Ha llegado el momento de explorar <code>sivirep</code>, de conocer
cómo generar reportes automatizados con el paquete y sus funcionalidades
principales.</p>
<p>El evento que analizaremos es <strong>Dengue</strong> en el
departamento del <strong>Cauca</strong> para el año
<strong>2022</strong>, ya que ha sido una de las regiones más afectadas
en Colombia a lo largo del tiempo por esta enfermedad.</p>
<p>Iniciaremos instalando e importando el paquete a través de los
siguientes comandos:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remove.packages</span><span class="op">(</span><span class="st">"sivirep"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu">pak</span><span class="op">(</span><span class="st">"epiverse-trace/sivirep"</span><span class="op">)</span> <span class="co"># Comando para instalar sivirep</span></span>
<span><span class="fu">rm</span><span class="op">(</span>list <span class="op">=</span> <span class="fu">ls</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Comando para limpiar el ambiente de R</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">sivirep</span><span class="op">)</span> <span class="co"># Comando para importar sivirep</span></span></code></pre>
</div>
<p>Verificar que el evento o enfermedad se encuentren disponibles para
su descarga en la lista que provee <code>sivirep</code>, la cual se
puede obtener ejecutando el siguiente comando:</p>
<div class="section level3">
<h3 id="reporte-automatizado">Reporte automatizado<a class="anchor" aria-label="anchor" href="#reporte-automatizado"></a>
</h3>
<p>Ahora generaremos un reporte automatizado a partir de la plantilla
que provee el paquete llamada <code>Reporte Básico {sivirep}</code>, la
cual contiene seis secciones y recibe los siguientes parámetros de
entrada: el nombre del evento o enfermedad, el año, el nombre de
departamento (opcional) y nombre del municipio (opcional) para descargar
los datos de la fuente de SIVIGILA.</p>
<p>Para hacer uso de la plantilla se deben seguir los siguientes
pasos:</p>
<ol style="list-style-type: decimal">
<li>En RStudio hacer click <strong>‘File/New File/R’</strong>
Markdown:</li>
</ol>
<figure><img src="https://github.com/epiverse-trace/sivirep/raw/main/man/figures/file_rmarkdown.png" class="rmarkdown-img figure mx-auto d-block" style="margin-left: 2.8em; margin-top: 0.8em; margin-bottom: 0.8em;" align="center" width="560"></figure><ol start="2" style="list-style-type: decimal">
<li>Selecciona la opción del panel izquierdo: <strong>‘From
Template’</strong>, después haz clic en el template llamado
<code>Reporte Básico {sivirep}</code>, indica el nombre que deseas para
el reporte (i.e. Reporte_Laura), la ubicación donde deseas guardarlo y
presiona <strong>‘Ok’</strong>.</li>
</ol>
<figure><img src="https://github.com/epiverse-trace/sivirep/raw/main/man/figures/reporte_basico.png" class="rmarkdown-img figure mx-auto d-block" style="margin-left: 2.8em; margin-top: 0.8em; margin-bottom: 0.8em;" align="center" width="520"></figure><ol start="3" style="list-style-type: decimal">
<li>En la parte superior de **‘RStudio’*, presiona el botón
<strong>‘Knit’</strong>, despliega las opciones y selecciona
<strong>‘Knit with parameters’</strong>.</li>
</ol>
<figure><img src="https://github.com/epiverse-trace/sivirep/raw/main/man/figures/button_knit.png" class="rmarkdown-img figure mx-auto d-block" style="margin-left: 2.8em; margin-top: 0.8em; margin-bottom: 0.8em;" align="center" width="560"></figure><ol start="4" style="list-style-type: decimal">
<li>A continuación, aparecerá una pantalla donde podrás indicar el
nombre de la enfermedad o evento, el año y el departamento del reporte.
Esta acción descargará los datos deseados y también proporcionará la
plantilla en un archivo R Markdown (.Rmd), al hacer clic en el botón
<strong>‘Knit’</strong>.</li>
</ol>
<figure><img src="./reference/figures/params_knit.png" class="rmarkdown-img figure mx-auto d-block" style="margin-left: 2.8em; margin-top: 0.8em; margin-bottom: 0.8em;" align="center" width="560"></figure><ol start="5" style="list-style-type: decimal">
<li>Espera unos segundos mientras el informe se genera en un archivo
HTML.</li>
</ol>
<p><strong>!Felicitaciones has generado tu primer reporte automatizado
con sivirep!</strong></p>
</div>
<div class="section level3">
<h3 id="actividad-exploratoria">Actividad exploratoria<a class="anchor" aria-label="anchor" href="#actividad-exploratoria"></a>
</h3>
<p>Para conocer las funciones principales del paquete realizaremos una
actividad exploratoria siguiendo el flujo de datos de
<code>sivirep</code>.</p>
<p>Construiremos un informe en R Markdown para Dengue, departamento del
Cauca, año 2022 (no se debe utilizar la plantilla de reporte vista en la
sección anterior) que de respuesta a las siguientes preguntas:</p>
<ol style="list-style-type: decimal">
<li>¿Cómo es la distribución por sexo y semana epidemiológica de la
enfermedad?</li>
<li>¿Esta distribución sugiere que la enfermedad afecta más a un sexo o
a otro? ¿sí, no y por qué?</li>
<li>¿Cómo afecta la enfermedad los distintos grupos etarios?</li>
<li>¿Cuál es el municipio que más se ve afectado por la enfermedad en la
región?</li>
</ol>
</div>
<div class="section level3">
<h3 id="preparación-y-configuración-del-documento-r-markdown">1. Preparación y configuración del documento R Markdown<a class="anchor" aria-label="anchor" href="#preparaci%C3%B3n-y-configuraci%C3%B3n-del-documento-r-markdown"></a>
</h3>
<p>Realizaremos la configuración y preparación del documento en R
Markdown a través de los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li>Crear un documento en R Mardown vacio:</li>
<li>Insertar un chunk en el documento con las siguientes opciones de
configuración:</li>
</ol>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va">opts_chunk</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comment <span class="op">=</span> <span class="st">"#&gt;"</span>,</span>
<span>  fig.path <span class="op">=</span> <span class="st">"figures/"</span>,</span>
<span>  include <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    error <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warning <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="importación-de-datos-de-sivigila">2. Importación de datos de SIVIGILA<a class="anchor" aria-label="anchor" href="#importaci%C3%B3n-de-datos-de-sivigila"></a>
</h3>
<p>Iniciaremos con la importación de los datos del evento o enfermedad
utilizando la función <code>import_data_event</code> la cual permite
descargar los datos desde la fuente de SIVIGILA utilizando un formato
parametrizado basado en el nombre del evento y el año.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_dengue</span> <span class="op">&lt;-</span>  <span class="fu">import_data_event</span><span class="op">(</span>nombre_event <span class="op">=</span> <span class="st">"dengue"</span>,</span>
<span>                                  year <span class="op">=</span> <span class="fl">2022</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="exploración-de-la-base-de-datos">3. Exploración de la base de datos<a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-la-base-de-datos"></a>
</h3>
<p>Recomendamos explorar la base de datos, sus variables, tipos de
datos, registros y otras caracteristicas que pueden ser relavantes para
su análisis y permitan responder correctamente a las preguntas
planteadas en la actividad.</p>
<p>Si tiene alguna duda respecto a las variables o desconoce su
significado puede dirigirse al <a href="https://www.dssa.gov.co/images/documentos/sivigila2017/Anexo%202%20Diccionario%20datos.pdf" class="external-link">diccionario
de datos del SIVIGILA</a>.</p>
</div>
<div class="section level3">
<h3 id="limpieza-de-datos-de-sivigila">4. Limpieza de datos de SIVIGILA<a class="anchor" aria-label="anchor" href="#limpieza-de-datos-de-sivigila"></a>
</h3>
<p>Para limpiar los datos utilizaremos una función genérica que
proporciona <code>sivirep</code> llamada
<code>limpiar_data_sivigila</code>, la cual envuelve diversas tareas
para identificar y corregir errores, inconsistencias y discrepancias en
los conjuntos de datos con el fin de mejorar su calidad y precisión.
Este proceso puede incluir la corrección de errores tipográficos, el
reemplazo de valores faltantes y la validación de datos, entre otras
tareas, como eliminar fechas improbables, limpiar códigos de
geolocalización y estandarizar los nombres de las columnas y las
categorías de edad.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_limpia</span> <span class="op">&lt;-</span> <span class="fu">limpiar_data_sivigila</span><span class="op">(</span>data_event <span class="op">=</span> <span class="va">data_dengue</span><span class="op">)</span></span>
<span><span class="va">data_limpia</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="filtrar-casos">5. Filtrar casos<a class="anchor" aria-label="anchor" href="#filtrar-casos"></a>
</h3>
<p>Ahora debemos filtrar los datos del evento o enfermedad por el
departamento de <code>Cauca</code>, utilizando la función de
<code>sivirep</code> llamada <code>geo_filtro</code>. Esta función
permite al usuario crear informes a nivel subnacional, seleccionando
casos específicos basados en la ubicación geográfica.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_filtrada</span> <span class="op">&lt;-</span> <span class="fu">geo_filtro</span><span class="op">(</span>data_event <span class="op">=</span> <span class="va">data_limpia</span>, dpto <span class="op">=</span> <span class="st">"Cauca"</span><span class="op">)</span></span>
<span><span class="va">data_filtrada</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="variable-de-sexo">6. Variable de sexo<a class="anchor" aria-label="anchor" href="#variable-de-sexo"></a>
</h3>
<p>Agruparemos los datos de la enfermedad por la variable sexo para
poder visualizar su distribución y obtener los porcentajes a través de
la función que proporciona <code>sivirep</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">casos_sex</span> <span class="op">&lt;-</span> <span class="fu">agrupar_sex</span><span class="op">(</span>data_event <span class="op">=</span> <span class="va">data_filtrada</span>,</span>
<span>                         porcentaje <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">casos_sex</span></span></code></pre>
</div>
<p>Además, <code>sivirep</code> cuenta con una función para generar el
gráfico por esta variable llamada <code>plot_sex</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_sex</span><span class="op">(</span>data_agrupada <span class="op">=</span> <span class="va">casos_sex</span><span class="op">)</span></span></code></pre>
</div>
<p>La distribución de casos por sexo y semana epidemiológica se puede
generar utilizando la función <code>agrupar_sex_semanaepi</code>
proporcionada por <code>sivirep</code>.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">casos_sex_semanaepi</span> <span class="op">&lt;-</span> <span class="fu">agrupar_sex_semanaepi</span><span class="op">(</span>data_event <span class="op">=</span> <span class="va">data_filtrada</span><span class="op">)</span></span>
<span><span class="va">casos_sex_semanaepi</span></span></code></pre>
</div>
<p>La función de visualización correspondiente es
<code>plot_sex_semanaepi</code>, que <code>sivirep</code> proporciona
para mostrar la distribución de casos por sexo y semana
epidemiológica.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_sex_semanaepi</span><span class="op">(</span>data_agrupada <span class="op">=</span> <span class="va">casos_sex_semanaepi</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="variable-de-edad">7. Variable de edad<a class="anchor" aria-label="anchor" href="#variable-de-edad"></a>
</h3>
<p><code>sivirep</code> proporciona una función llamada
<code>agrupar_edad</code>, que puede agrupar los datos de enfermedades
por grupos de edad. De forma predeterminada, esta función produce rangos
de edad con intervalos de 10 años.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">casos_edad</span> <span class="op">&lt;-</span> <span class="fu">agrupar_edad</span><span class="op">(</span>data_event <span class="op">=</span> <span class="va">data_limpia</span>, interval_edad <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">casos_edad</span></span></code></pre>
</div>
<p>La función de visualización correspondiente es
<code>plot_edad</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_edad</span><span class="op">(</span>data_agrupada <span class="op">=</span> <span class="va">casos_edad</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="distribución-espacial-de-casos">8. Distribución espacial de casos<a class="anchor" aria-label="anchor" href="#distribuci%C3%B3n-espacial-de-casos"></a>
</h3>
<p>Obtener la distribución espacial de los casos es útil para
identificar áreas con una alta concentración de casos, agrupaciones de
enfermedades y factores de riesgo ambientales o sociales.</p>
<p>En Colombia, existen 32 unidades geográficas administrativas (adm1)
llamadas departamentos. <code>sivirep</code> proporciona una función
llamada <code>agrupar_mpio</code> que permite obtener un data.frame de
casos agrupados por departamento o municipio.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_esp_dept</span> <span class="op">&lt;-</span> <span class="fu">agrupar_mpio</span><span class="op">(</span>data_event <span class="op">=</span> <span class="va">data_filtrada</span><span class="op">)</span></span>
<span><span class="va">dist_esp_dept</span></span></code></pre>
</div>
<p>Con la función llamada <code>plot_map</code>, podremos generar un
mapa estático que muestra la distribución de casos por municipios.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapa</span> <span class="op">&lt;-</span> <span class="fu">plot_map</span><span class="op">(</span>data_agrupada <span class="op">=</span> <span class="va">dist_esp_dept</span><span class="op">)</span></span>
<span><span class="va">mapa</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="análisis-de-resultados">9. Análisis de resultados<a class="anchor" aria-label="anchor" href="#an%C3%A1lisis-de-resultados"></a>
</h3>
<p>Analiza los resultados obtenidos en la ejecución de las funciones y
responde las preguntas planteadas en el enunciado de la actividad
exploratoria.</p>
<p>Dentro del R Markdown desarrolla dos (2) conclusiones pertinentes a
la enfermedad teniendo en cuenta el contexto de la región y las
estrategias que podrían contribuir a su mitigación.</p>
</div>
</section><section><h2 class="section-heading" id="reflexión">Reflexión<a class="anchor" aria-label="anchor" href="#reflexi%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>Conformaremos grupos de 4-5 personas y discutiremos sobre la
disponibilidad de los datos y el impacto que esto tiene en la
construcción de análisis y en las acciones que se pueden emprender para
mitigar el efecto de esta enfermedad sobre la población.</p>
</section><section><h2 class="section-heading" id="desafio">Desafio<a class="anchor" aria-label="anchor" href="#desafio"></a>
</h2>
<hr class="half-width">
<p>En el siguiente enlace podrán encontrar el desafío que debérán
desarrollar con <code>sivirep</code>: - <a href="https://docs.google.com/document/d/1_79eyXHTaQSPSvUzlikx9DKpBvICaiqy/edit?usp=sharing&amp;ouid=113064166206309718856&amp;rtpof=true&amp;sd=true" class="external-link uri">https://docs.google.com/document/d/1_79eyXHTaQSPSvUzlikx9DKpBvICaiqy/edit?usp=sharing&amp;ouid=113064166206309718856&amp;rtpof=true&amp;sd=true</a></p>
<hr>
<div class="section level3">
<h3 id="sobre-este-documento">Sobre este documento<a class="anchor" aria-label="anchor" href="#sobre-este-documento"></a>
</h3>
<p>Este documento ha sido diseñado por Geraldine Gómez Millán para el
Curso Internacional: Análisis de Brotes y Modelamiento en Salud Pública,
Bogotá 2023. TRACE-LAC/Javeriana.</p>
<div class="section level4">
<h4 id="recursos">Recursos<a class="anchor" aria-label="anchor" href="#recursos"></a>
</h4>
<ul>
<li><a href="https://www.canva.com/design/DAFzKDqZT0E/uwZABHMIn14qq_LT9uSKEA/edit?utm_content=DAFzKDqZT0E&amp;utm_campaign=designshare&amp;utm_medium=link2&amp;utm_source=sharebutton" class="external-link">Presentación
del taller</a></li>
<li><a href="https://forms.office.com/r/bRpPuAh8hF?origin=lprLink" class="external-link">Encuesta</a></li>
<li><a href="https://epiverse-trace.github.io/sivirep/" class="external-link">Página de
sivirep</a></li>
<li><a href="https://epiverse-trace.github.io/sivirep/reference/index.html" class="external-link">Documentación
de las funciones de sivirep</a></li>
<li><a href="https://github.com/epiverse-trace/sivirep" class="external-link">Repositorio de
sivirep</a></li>
</ul>
</div>
<div class="section level4">
<h4 id="contribuciones">Contribuciones<a class="anchor" aria-label="anchor" href="#contribuciones"></a>
</h4>
<ul>
<li>Geraldine Gómez Millán</li>
<li>Jaime Pavlich-Mariscal</li>
<li>Andrés Moreno</li>
</ul>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>
</section></section><section id="aio-Serofoi-tutorial"><p>Content from <a href="Serofoi-tutorial.html">Estima la fuerza de infección a partir de encuestas serológicas usando serofoi</a></p>
<hr>
<p>Última actualización: 2025-03-13 |

        <a href="https://github.com/epiverse-trace/epimodelac/edit/main/episodes/Serofoi-tutorial.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo estimar retrospectivamente la <em>Fuerza de Infección</em> de
un patógeno a partir de <em>encuestas serológicas poblacionales de
prevalencia desagregadas por edad</em> mediante la implementación de
<em>modelos Bayesianos</em> usando <strong>serofoi</strong>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<p>Al final de este taller usted podrá:</p>
<ul>
<li><p>Explorar y analizar una encuesta serológica típica.</p></li>
<li><p>Aprender a estimar la Fuerza de Infección en un caso de uso
específico.</p></li>
<li><p>Visualizar e interpretar los resultados.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introducción">1. Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<!-- Aquí se espera que usted comparta información sobre un problema de salud pública. La metodología es de resolución de casos.
(También es posible pedir a los participantes que describan la base de datos)
--><p><strong>serofoi</strong> es un paquete de R para estimar
retrospectivamente la <em>Fuerza de Infección</em> de un patógeno a
partir de <em>encuestas serológicas poblacionales de prevalencia
desagregadas por edad</em> mediante la implementación de <em>modelos
Bayesianos</em>. Para ello, <strong>serofoi</strong> utiliza el paquete
<em>Rstan</em>, que proporciona una interfaz para el lenguaje de
programación estadística <em>Stan</em>, mediante el cual se implementan
métodos de Monte-Carlo basados en cadenas de Markov.</p>
<p>Como un caso particular, estudiaremos un brote de Chikungunya, una
enfermedad viral descubierta en Tanzania en el año 1952 que se
caracteriza por causar fuertes fiebres, dolor articular, jaqueca,
sarpullidos, entre otros síntomas. Desde el año 2013, casos de esta
enfermedad comenzaron a ser reportados en América y desde entonces la
enfermedad ha sido endémica en varios países latinoamericanos. Durante
este tutorial, vamos a analizar una encuesta serológica realizada entre
octubre y diciembre de 2015 en Bahía, Brasil, la cual fue realizada poco
tiempo después de una epidemia de esta enfermedad, con el fin de
caracterizar los patrones endémicos o epidémicos en la zona.</p>
</section><section><h2 class="section-heading" id="objetivos">2. Objetivos<a class="anchor" aria-label="anchor" href="#objetivos"></a>
</h2>
<hr class="half-width">
<!-- Aquí se espera que usted incluya los objetivos del taller. ¿Qué es lo que usted espera que los estudiantes aprendan del taller? ¿Qué se espera que los estudiantes puedan hacer al terminar el taller? Los objetivos deben empezar con un verbo en infinitivo. --><ul>
<li><p>Explorar y analizar una encuesta serológica típica.</p></li>
<li><p>Aprender a estimar la Fuerza de Infección en un caso de uso
específico.</p></li>
<li><p>Visualizar e interpretar los resultados.</p></li>
</ul></section><section><h2 class="section-heading" id="conceptos-básicos-a-desarrollar">3. Conceptos básicos a desarrollar<a class="anchor" aria-label="anchor" href="#conceptos-b%C3%A1sicos-a-desarrollar"></a>
</h2>
<hr class="half-width">
<!-- En esta práctica se desarrollarán los siguientes conceptos: --><!-- Aquí se espera que usted mencione los conceptos más importantes del taller (deben ser conceptos técnicos que se puedan encontrar en la literatura) --><p>En esta práctica se desarrollarán los siguientes conceptos:</p>
<ul>
<li><p>Encuestas serologícas (<em>sero</em>)</p></li>
<li><p>Fuerza de infección (<em>foi</em>)</p></li>
<li><p>Modelos serocatalíticos</p></li>
<li><p>Estadística Bayesiana</p></li>
<li><p>Visualización e interpretación de resultados de modelos
FoI</p></li>
</ul>
<p>La Fuerza de Infección (FoI, por sus siglas en inglés), también
conocida cómo la tasa de riesgo o la presión de infección, representa la
tasa a la que los individuos susceptibles se infectan dado que
estuvieron expuestos a un patógeno. En otras palabras, la FoI cuantifica
el riesgo de que un individuo susceptible se infecte en un periodo de
tiempo.</p>
<p>Como veremos a continuación, este concepto es clave en el
modelamiento de enfermedades infecciosas. Para ilustrar el concepto,
consideremos una población expuesta a un patógeno y llamemos <span class="math inline">\(P(t)\)</span> a la proporción de individuos que
han sido infectados al tiempo <span class="math inline">\(t\)</span>.
Suponiendo que no hay sero-reversión, la cantidad <span class="math inline">\(1 - P(t)\)</span> representa la cantidad de
individuos susceptibles a la enfermedad, de tal forma que la velocidad
de infección está dada por:</p>
<p><span class="math display">\[ \tag{1}
\frac{dP(t)}{d t} = \lambda(t) (1- P(t)),\]</span></p>
<p>en donde <span class="math inline">\(\lambda(t)\)</span> representa
la tasa a la que los individuos susceptibles se infectan por unidad de
tiempo (días, meses, años, …), es decir la FoI. La ecuación diferencial
(1) se asemeja a la de una reacción química en donde <span class="math inline">\(P(t)\)</span> representa la proporción de sustrato
que no ha entrado en contacto con un reactivo catalítico, por lo que
este tipo de modelos se conocen como <strong>modelos
serocatalíticos</strong> (Muench, 1959).</p>
<p>A pesar de la simpleza del modelo representado por la ecuación (1),
en comparación con modelos compartimentales (por ejemplo), la dificultad
para conocer una condición inicial para la seropositividad en algún
punto del pasado imposibilita su uso práctico. Para sortear esta
limitación, es común aplicar el modelo para cohortes de edad en lugar de
para el total de la población. Para ello, etiquetemos cada cohorte de
edad de acuerdo con su año de nacimiento <span class="math inline">\(\tau\)</span>, y supongamos que los individuos son
seronegativos al nacer: <span class="math display">\[
\frac{dP^\tau (t)}{dt} = \lambda(t) (1 - P^\tau(t)).
\]</span> Con condiciones iniciales dadas por <span class="math inline">\(P^\tau(\tau) = 0\)</span>. Esta ecuación se puede
resolver analíticamente, dando como resultado (Hens et al, 2010):</p>
<p><span class="math display">\[
P^{\tau} (t) = 1 - \exp\left(-\int_{\tau}^{t} \lambda (t') dt'
\right).
\]</span></p>
<p>Suponiendo que la FoI se mantiene constante a lo largo de cada año,
la versión discreta de esta ecuación es:</p>
<p><span class="math display">\[
\tag{2}
P^\tau(t) = 1 - \exp\left(-\sum_{i = \tau}^{t} \lambda_i \right),
\]</span> Como un ejemplo, consideremos la FoI representada en la
siguiente figura:</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>A partir de esta FoI, es posible calcular la seroprevalencia para
distintas cohortes por medio de la ecuación (2):</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Cuando conocemos los datos de una encuesta serológica, la información
a la que tenemos acceso es a una fotografía de la seroprevalencia en el
momento su realización <span class="math inline">\(t_{sur}\)</span> como
función de la edad de los individuos en ese momento, la cual coincide
con la ecuación (2) ya que los individuos envejecen al mismo ritmo al
que pasa el tiempo; es decir:</p>
<p><span class="math display">\[
\tag{3}
P^{t_{sur}}(a^\tau) = 1 - \exp\left(-\sum_{i = \tau}^{t_{sur}} \lambda_i
\right).
\]</span> En el caso del ejemplo, esto nos da la siguiente gráfica:
<img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure">
Note que los valores de seroprevalencia de cada edad en esta gráfica
corresponden a los valores de seroprevalencia al momento de la encuesta
(2020) en la gráfica anterior.</p>
<p>La misión que cumple <strong>serofoi</strong> es estimar la fuerza de
infección histórica <span class="math inline">\(\lambda(t)\)</span> a
partir de esta fotografía del perfil serológico de la población al
momento de la encuesta. para lo cual se requieren encuestas serológicas
que cumplan con los siguientes criterios de inclusión:</p>
<ul>
<li>Basadas en poblacionales (no hospitalaria).</li>
<li>Estudio de tipo transversal (un solo tiempo) .</li>
<li>Que indique la prueba diagnóstica utilizada.</li>
<li>Que identifique la edad del paciente en el momento de la
encuesta.</li>
</ul>
<p>En casos donde la FoI pueda considerarse constante, la ecuación (3)
da como resultado:</p>
<p><span class="math display">\[
\tag{4}
P_{sur}(a^\tau(t_{sur})) = 1 - \exp (-\lambda a^\tau),
\]</span></p>
<p>en donde se tuvo en cuenta qué, al momento de la introducción del
patógeno (<span class="math inline">\(t = 0\)</span>), la proporción de
individuos infectados fue <span class="math inline">\(P(0) = 0\)</span>
(condición inicial). Note que el término de la suma en la ecuación (3)
da como resultado la edad de cada cohorte al considerar la fuerza de
infección constante.</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>Figura 1.</strong> Curvas de prevalencia en función de la
edad para distintos valores de FoI constante.</p>
<p>En este ejemplo hemos escogido, por simplicidad, que la FoI fuese
constante; sin embargo, este no es necesariamente el caso. Identificar
si la FoI sigue una tendencia constante o variante en el tiempo puede
ser de vital importancia para la identificación y caracterización de la
propagación de una enfermedad. Es acá donde el paquete de R
<strong>serofoi</strong> juega un papel importante, ya que este permite
estimar retrospectivamente la FoI de un patógeno, recuperando así su
evolución temporal, por medio de modelos Bayesianos
pre-establecidos.</p>
<p>Los modelos actuales del paquete <strong>serofoi</strong> asumen los
siguientes supuestos biológicos:</p>
<ul>
<li>No hay sero-reversión (sin pérdida de inmunidad).</li>
<li>La FoI no depende de la edad.</li>
<li>Bajos o nulos niveles de migración en las poblaciones.</li>
<li>Diferencias pequeñas entre las tasas de mortalidad de susceptibles e
infectados.</li>
</ul></section><section><h2 class="section-heading" id="modelos-bayesianos">3.2. Modelos Bayesianos<a class="anchor" aria-label="anchor" href="#modelos-bayesianos"></a>
</h2>
<hr class="half-width">
<p>A diferencia del enfoque frecuentista, donde la probabilidad se
asocia con la frecuencia relativa de la ocurrencia de los eventos, la
estadística Bayesiana se basa en el uso de la probabilidad condicional
de los eventos respecto al conocimiento (o estado de información) que
podamos tener sobre los datos o sobre los parámetros que queramos
estimar.</p>
<p>Por lo general, cuando proponemos un modelo lo que buscamos es
disminuir la incertidumbre sobre algún parámetro, de tal forma que nos
aproximemos a su valor tan óptimamente como nos lo permita nuestro
conocimiento previo del fenómeno y de las mediciones realizadas
(datos).</p>
<p>La inferencia Bayesiana se sustenta en el teorema de Bayes, el cual
establece que: dado un conjunto de datos <span class="math inline">\(\vec{y} = (y_1, …, y_N)\)</span>, el cual
representa un único evento, y la variable aleatoria <span class="math inline">\(\theta\)</span>, que representa un parámetro de
interés para nosotros (en nuestro caso, la FoI <span class="math inline">\(\lambda\)</span>), la distribución de probabilidad
conjunta de las variables aleatorias asociadas está dada por:</p>
<p><span class="math display">\[ \tag{4}
p(\vec{y}, \theta) = p(\vec{y} | \theta) p(\theta) = p(\theta | \vec{y})
p(\vec{y}),
\]</span></p>
<p>de donde se desprende la distribución aposteriori de <span class="math inline">\(\theta\)</span>, es decir una versión actualizada
de la distribución de probabilidad de la FoI condicionada a nuestros
datos:</p>
<p><span class="math display">\[\tag{5}
p(\theta, \vec{y}) =  \frac{p(\vec{y} | \theta)
p(\theta)}{p(\vec{y})},\]</span></p>
<p>La distribución <span class="math inline">\(p(\vec{y} |
\theta)\)</span>, que corresponde a la información interna a los datos
condicionada al valor del parámetro <span class="math inline">\(\theta\)</span>, suele estar determinada por la
naturaleza del experimento: no es lo mismo escoger pelotas dentro de una
caja reemplazándolas que dejándolas por fuera de la caja (e.g.). En el
caso particular de la FoI, contamos con datos como el número total de
encuestas por edad y el número de casos positivos, por lo que es
razonable asignar una distribución binomial a la probabilidad, como
veremos a continuación.</p>
<div class="section level3">
<h3 id="modelo-foi-constante">3.3.1. Modelo FoI constante<a class="anchor" aria-label="anchor" href="#modelo-foi-constante"></a>
</h3>
<p>En nuestro caso particular, el parámetro que queremos estimar es la
FoI (<span class="math inline">\(\lambda\)</span>). La distribución de
probabilidad apriori de <span class="math inline">\(\lambda\)</span>
representa nuestras suposiciones informadas o el conocimiento previo que
tengamos sobre el comportamiento de la FoI. En este contexto, el estado
de mínima información sobre <span class="math inline">\(\lambda\)</span>
está representado por una distribución uniforme:</p>
<p><span class="math display">\[\tag{6}
\lambda \sim U(0, 2),\]</span></p>
<p>lo que significa que partimos de la premisa de que todos los valores
de la fuerza de infección entre <span class="math inline">\(0\)</span> y
<span class="math inline">\(2\)</span> son igualmente probables. Por
otro lado, de la teoría de modelos sero-catalíticos sabemos que la
seroprevalencia en un año dado está descrita por un proceso cumulativo
con la edad (Hens et al, 2010):</p>
<p><span class="math display">\[\tag{7}
P(a, t) = 1 - \exp\left(  -\sum_{i=t-a+1}^{t} \lambda_i  \right),
\]</span> en donde <span class="math inline">\(\lambda_i\)</span>
corresponde a la FoI al tiempo <span class="math inline">\(t\)</span>.
Como en este caso la FoI es constante, la ec. (7) se reduce a:</p>
<p><span class="math display">\[\tag{8}
P(a, t) = 1 - \exp\left(  -\lambda a \right),\]</span></p>
<p>Si <span class="math inline">\(n(a, t_{sur})\)</span> es el número de
muestras positivas por edad obtenidas en un estudio serológico
desarrollado en el año <span class="math inline">\(t_{sur}\)</span>,
entonces podemos estimar la distribución de los casos seropositivos por
edad condicionada al valor de <span class="math inline">\(\lambda\)</span> como una distribución
binomial:</p>
<p><span class="math display">\[\tag{9}
p(a, t) \sim Binom(n(a, t), P(a, t)) \\
\lambda \sim U(0, 2)\]</span></p>
</div>
<div class="section level3">
<h3 id="modelo-foi-dependientes-del-tiempo">3.3.2. Modelo FOI dependientes del tiempo<a class="anchor" aria-label="anchor" href="#modelo-foi-dependientes-del-tiempo"></a>
</h3>
<p>Actualmente, <strong>serofoi</strong> permite la implementación de
dos modelos dependientes del tiempo: uno de variación lenta de la FoI
(<strong>tv-normal</strong>) y otro de variación rápida
(<strong>tv-normal-log</strong>) de la FoI.</p>
<p>Cada uno de ellos se basa en distintas distribuciones previas para
<span class="math inline">\(\lambda\)</span>, las cuales se muestran en
la tabla 1.</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="41%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="left">Model Option</th>
<th align="left">Probability of positive case at age <span class="math inline">\(a\)</span>
</th>
<th align="left">Prior distribution</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>constant</code></td>
<td align="left"><span class="math inline">\(\sim binom(n(a,t),
P(a,t))\)</span></td>
<td align="left"><span class="math inline">\(\lambda\sim
uniform(0,2)\)</span></td>
</tr>
<tr class="even">
<td align="left"><code>tv_normal</code></td>
<td align="left"><span class="math inline">\(\sim binom(n(a,t),
P(a,t))\)</span></td>
<td align="left"><span class="math inline">\(\lambda\sim
normal(\lambda(t-1),\sigma)\\ \lambda(t=1)\sim normal(0,1)\)</span></td>
</tr>
<tr class="odd">
<td align="left"><code>tv_normal_log</code></td>
<td align="left"><span class="math inline">\(\sim binom(n(a,t),
P(a,t))\)</span></td>
<td align="left"><span class="math inline">\(\lambda\sim
normal(log(\lambda(t-1)),\sigma)\\ \lambda(t=1)\sim
normal(-6,4)\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Tabla 1.</strong> Distribuciones a priori de los distintos
modelos soportados por <strong>serofoi</strong>. <span class="math inline">\(\sigma\)</span> representa la desviación
estándar.</p>
<p>Como se puede observar, las distribuciones previas de <span class="math inline">\(\lambda\)</span> en ambos casos están dadas por
distribuciones Gaussianas con desviación estándar <span class="math inline">\(\sigma\)</span> y centradas en <span class="math inline">\(\lambda\)</span> (modelo de variación lenta -
<code>tv_normal</code>) y <span class="math inline">\(\log(\lambda)\)</span> (modelo de variación rápida
- <code>tv_normal_log</code>). De esta manera, la FoI en un tiempo <span class="math inline">\(t\)</span> está distribuida de acuerdo a una
distribución normal alrededor del valor que esta tenía en el tiempo
inmediatamente anterior. El logaritmo en el modelo
<code>tv_normal_log</code> permite identificar cambios drásticos en la
tendencia temporal de la FoI.</p>
</div>
<div class="section level3">
<h3 id="contenido-del-taller">4. Contenido del taller<a class="anchor" aria-label="anchor" href="#contenido-del-taller"></a>
</h3>
<!-- Aquí debe agregar el contenido del taller. Sea claro. Pruebe los códigos. Recuerde que si bien estará usted para dirigir el taller, el taller debe ser claro para poder ser ejecutado. -->
<div class="section level4">
<h4 id="instalación-de-serofoi">4.1 Instalación de <strong>serofoi</strong>
<a class="anchor" aria-label="anchor" href="#instalaci%C3%B3n-de-serofoi"></a>
</h4>
<p>Previo a la instalación de <strong>serofoi</strong>, cree un proyecto
en R en la carpeta de su escogencia en su máquina local; esto con el fin
de organizar el espacio de trabajo en donde se guardarán los códigos que
desarrolle durante la sesión.</p>
<p>Antes de realizar la instalación de <strong>serofoi</strong>, es
necesario instalar y configurar C++ Toolchain (instrucciones para <a href="https://github.com/stan-dev/rstan/wiki/Configuring-C---Toolchain-for-Windows" class="external-link">windows</a>/
<a href="https://github.com/stan-dev/rstan/wiki/Configuring-C---Toolchain-for-Mac" class="external-link">mac</a>/<a href="https://github.com/stan-dev/rstan/wiki/Configuring-C-Toolchain-for-Linux" class="external-link">linux</a>).
Después de haber configurado C++ Toolchain, ejecute las siguientes
líneas de código para instalar el paquete:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu">pak</span><span class="op">(</span><span class="st">"epiverse-trace/serofoi"</span><span class="op">)</span></span></code></pre>
</div>
<p>Opcionalmente, es posible modificar la configuración de R para que
los modelos a implementar corran en paralelo, aprovechando los núcleos
del procesador de su computador. Esto tiene el efecto de disminuir los
tiempos de cómputo de las implementaciones en Stan. Para activar esta
opción ejecute:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">options</span><span class="op">(</span>mc.cores<span class="op">=</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Finalmente, cargue el paquete ejecutando:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">serofoi</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="caso-de-uso-chikungunya">4.2 Caso de uso: Chikungunya<a class="anchor" aria-label="anchor" href="#caso-de-uso-chikungunya"></a>
</h4>
<p>En esta sección vamos a analizar una encuesta serológica realizada
entre octubre y diciembre de 2015 en Bahía, Brasil, la cual fue
realizada poco tiempo después de una epidemia de esta enfermedad en la
zona. Nuestro objetivo es caracterizar la propagación de la enfermedad
por medio de la implementación de los distintos modelos y determinar
cuál de estos describe mejor la situación. Primero, carguemos y
preparemos los datos que utilizaremos en este análisis. La base
<code>chik2015</code> contiene los datos correspondientes a esta
encuesta serológica:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data</span><span class="op">(</span><span class="va">chik2015</span><span class="op">)</span></span>
<span><span class="va">chik2015p</span> <span class="op">&lt;-</span> <span class="fu">prepare_serodata</span><span class="op">(</span><span class="va">chik2015</span><span class="op">)</span></span>
<span><span class="fu">str</span><span class="op">(</span><span class="va">chik2015p</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	4 obs. of  16 variables:
 $ survey        : chr  "BRA 2015(S019)" "BRA 2015(S019)" "BRA 2015(S019)" "BRA 2015(S019)"
 $ total         : int  45 109 144 148
 $ counts        : num  17 55 63 69
 $ age_min       : num  1 20 40 60
 $ age_max       : num  19 39 59 79
 $ tsur          : num  2015 2015 2015 2015
 $ country       : Factor w/ 256 levels "ABW","AFG","AGO",..: 33 33 33 33
 $ test          : chr  "ELISA" "ELISA" "ELISA" "ELISA"
 $ antibody      : chr  "IgG anti-CHIKV" "IgG anti-CHIKV" "IgG anti-CHIKV" "IgG anti-CHIKV"
 $ reference     : chr  "Dias et al. 2018" "Dias et al. 2018" "Dias et al. 2018" "Dias et al. 2018"
 $ age_mean_f    : num  10 29 49 69
 $ sample_size   : int  446 446 446 446
 $ birth_year    : num  2005 1986 1966 1946
 $ prev_obs      : num  0.378 0.505 0.438 0.466
 $ prev_obs_lower: num  0.238 0.407 0.355 0.384
 $ prev_obs_upper: num  0.535 0.602 0.523 0.55</code></pre>
</div>
<p>Para correr el modelo de FoI constante y visualizar los resultados
del mismo, corra las siguientes líneas de código:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chik_constant</span> <span class="op">&lt;-</span> <span class="fu">run_seromodel</span><span class="op">(</span>serodata <span class="op">=</span> <span class="va">chik2015p</span>,</span>
<span>                               foi_model <span class="op">=</span> <span class="st">"constant"</span>,</span>
<span>                               iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chik_constant_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_seromodel</span><span class="op">(</span><span class="va">chik_constant</span>, </span>
<span>                                     serodata <span class="op">=</span> <span class="va">chik2015p</span>, </span>
<span>                                     size_text <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre>
</div>
<p>Ahora, corra los modelos dependientes del tiempo con
<code>iter =1500</code>. Luego visualice conjuntamente las tres gráficas
por medio de la función <code>plot_grid()</code> del paquete
<code>cowplot</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"cowplot"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">chik_constant_plot</span>, </span>
<span>                   <span class="va">chik_normal_plot</span>, </span>
<span>                   <span class="va">chik_normal_log_plot</span>,</span>
<span>                   ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p><strong>NOTA:</strong> Debido a que el número de trayectorias es
relativamente alto, con el fin de asegurar la convergencia de los
modelos, el tiempo de cómputo de los modelos dependientes del tiempo
puede tardar varios minutos.</p>
<p><em>Pista: Debería obtener la siguiente gráfica:</em></p>
<figure><img src="fig/Serofoi-tutorial-rendered-chik2015_vis-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Explicación de <em>elpd</em> (<em>expected log pointwise predictive
density</em>)</p>
</div>
</div>
</section><section><h2 class="section-heading" id="reflexión">5. Reflexión<a class="anchor" aria-label="anchor" href="#reflexi%C3%B3n"></a>
</h2>
<hr class="half-width">
<!-- Aquí se espera que incluya preguntas/actividades que permita reflexionar al grupo sobre los alcances y limitaciones de lo aprendido en la resolución del problema expuesto en el taller. Así como reflexiones que conlleven a un mejor aprendizaje y aplicación al campo de la salud pública. --><p>Según los criterios explicados anteriormente, responda:</p>
<p>¿Cuál de los tres modelos se ajusta mejor a esta encuesta
serológica?<br><br><br><br><br></p>
<p>¿Cómo interpreta estos resultados?<br><br><br></p>
<hr>
<p><a href="https://docs.google.com/document/d/11j99fA8SBMUn1FD6oJBOvc-Nmr9aq5hd/edit?usp=sharing&amp;ouid=108718106243006326200&amp;rtpof=true&amp;sd=true" class="external-link">Reto</a></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<p>Revise si al final de esta lección adquirió estas competencias:</p>
<ul>
<li><p>Explorar y analizar una encuesta serológica típica.</p></li>
<li><p>Aprender a estimar la Fuerza de Infección en un caso de uso
específico.</p></li>
<li><p>Visualizar e interpretar los resultados.</p></li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="sobre-este-documento">Sobre este documento<a class="anchor" aria-label="anchor" href="#sobre-este-documento"></a>
</h3>
<p>Este documento ha sido diseñado por NOMBRE_DE_AUTORES para el Curso
Internacional: Análisis de Brotes y Modelamiento en Salud Pública,
Bogotá 2023. TRACE-LAC/Javeriana.</p>
<div class="section level4">
<h4 id="contribuciones">Contribuciones<a class="anchor" aria-label="anchor" href="#contribuciones"></a>
</h4>
<ul>
<li>Nicolás Torres Domínguez</li>
<li>Zulma M. Cucunuba</li>
</ul>
<p>Contribuciones son bienvenidas vía <a href="https://github.com/reconhub/learn/pulls" class="external-link">pull requests</a>.</p>
</div>
</div>
</section><section><h2 class="section-heading" id="referencias">Referencias<a class="anchor" aria-label="anchor" href="#referencias"></a>
</h2>
<hr class="half-width">
<p>Muench, H. (1959). Catalytic models in epidemiology. Harvard
University Press.</p>
<p>Hens, N., Aerts, M., Faes, C., Shkedy, Z., Lejeune, O., Van Damme,
P., &amp; Beutels, P. (2010). Seventy-five years of estimating the force
of infection from current status data. Epidemiology &amp; Infection,
138(6), 802–812.</p>
<p>Cucunubá, Z. M., Nouvellet, P., Conteh, L., Vera, M. J., Angulo, V.
M., Dib, J. C., … Basáñez, M. G. (2017). Modelling historical changes in
the force-of-infection of Chagas disease to inform control and
elimination programmes: application in Colombia. BMJ Global Health,
2(3). <a href="doi:10.1136/bmjgh-2017-000345" class="uri">doi:10.1136/bmjgh-2017-000345</a></p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-Vaccineff-tutorial"><p>Content from <a href="Vaccineff-tutorial.html">Introducción al cálculo de efectividad vacunal con cohortes usando vaccineff</a></p>
<hr>
<p>Última actualización: 2025-03-13 |

        <a href="https://github.com/epiverse-trace/epimodelac/edit/main/episodes/Vaccineff-tutorial.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo realizar el cálculo de efectividad vacunal con cohortes usando
vaccineff?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<p>Al final de este taller usted podrá:</p>
<ul>
<li><p>Estudiar algunos de los conceptos claves para la implementación
de estudios observacionales con diseño de cohortes</p></li>
<li><p>Calcular las métricas claves para llevar a cabo un estudio de
cohortes</p></li>
<li><p>Discutir las ventajas y desventajas de los métodos de estimación
no paramétricos y semi-paramétricos de modelos de
superviviencia</p></li>
<li><p>Aplicar estrategias de emparejamiento de casos y control y
discutir su potencial efecto sobre los estudios de cohortes</p></li>
<li><p>Estimar la efectividad vacunal haciendo uso de un diseño de
cohortes</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introducción">1. Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>En esta sesión se espera que los participantes se familiaricen con
uso del paquete de R<code>vaccineff</code>. Utilizaremos el diseño de
cohortes para estimar la efectividad vacunal de un conjunto de datos de
prueba y analizaremos los resultados obtenidos.</p>
</section><section><h2 class="section-heading" id="objetivos">2. Objetivos<a class="anchor" aria-label="anchor" href="#objetivos"></a>
</h2>
<hr class="half-width">
<ul>
<li><p>Estudiar algunos de los conceptos claves para la implementación
de estudios observacionales con diseño de cohortes</p></li>
<li><p>Calcular las métricas claves para llevar a cabo un estudio de
cohortes</p></li>
<li><p>Discutir las ventajas y desventajas de los métodos de estimación
no paramétricos y semi-paramétricos de modelos de
superviviencia</p></li>
<li><p>Aplicar estrategias de emparejamiento de casos y control y
discutir su potencial efecto sobre los estudios de cohortes</p></li>
<li><p>Estimar la efectividad vacunal haciendo uso de un diseño de
cohortes</p></li>
</ul></section><section><h2 class="section-heading" id="conceptos-básicos-a-desarrollar">3. Conceptos básicos a desarrollar<a class="anchor" aria-label="anchor" href="#conceptos-b%C3%A1sicos-a-desarrollar"></a>
</h2>
<hr class="half-width">
<p>En esta práctica se desarrollarán los siguientes conceptos:</p>
<ul>
<li><p>Eficacia y Efectividad vacunal</p></li>
<li><p>Tiempo de inducción o “delays” en el análisis de efectividad de
vacunas</p></li>
<li><p>Diseños observacionales para el estudio de la efectividad
vacunal</p></li>
<li><p>Diseño de cohortes para estimación de la efectividad
vacunal</p></li>
<li><p>Estimador no paramétrico Kaplan-Meier</p></li>
<li><p>Modelo semi-paramétrico de Cox</p></li>
<li><p>Riesgos proporcionales</p></li>
</ul>
<div class="section level3">
<h3 id="eficacia-vs-efectividad-vacunal">
<strong>3.1. Eficacia vs Efectividad vacunal</strong><a class="anchor" aria-label="anchor" href="#eficacia-vs-efectividad-vacunal"></a>
</h3>
<p><strong>Eficacia:</strong></p>
<ul>
<li><p>Se refiere a la capacidad de lograr un efecto deseado o esperado
bajo condiciones ideales o controladas.</p></li>
<li><p>Es una medida teórica. En experimentos clínicos, por ejemplo, la
eficacia de un medicamento se evalúa en condiciones controladas, donde
todos los factores externos están cuidadosamente regulados para
determinar el rendimiento puro del medicamento.</p></li>
<li><p>Puede considerarse como “lo que puede hacer” una intervención en
las mejores circunstancias posibles.</p></li>
</ul>
<p><strong>Efectividad:</strong></p>
<ul>
<li><p>Se refiere a qué tan bien funciona una intervención en
condiciones “reales” o prácticas, fuera de un entorno
controlado.</p></li>
<li><p>Es una medida práctica. En el contexto de los medicamentos, la
efectividad se refiere a qué tan bien funciona un medicamento en el
“mundo real”, donde las condiciones no están tan controladas y hay
muchos factores variables.</p></li>
<li><p>Puede considerarse como “lo que realmente hace” una intervención
en circunstancias típicas o cotidianas.</p></li>
</ul>
<table class="table">
<colgroup><col width="100%"></colgroup>
<tbody><tr class="odd">
<td>Un ejemplo podría ser un medicamento que en experimentos clínicos
(en condiciones ideales) mostró una eficacia del 95% en prevenir el
desenlace. Sin embargo, cuando se usó en el contexto general,
considerando factores como la adherencia al tratamiento, interacciones
con otros medicamentos y variabilidad en la población, su efectividad
fue del 85%. Aquí, la eficacia muestra el potencial del medicamento bajo
condiciones ideales, mientras que la efectividad muestra cómo funciona
en situaciones cotidianas.</td>
</tr></tbody>
</table>
<p>En el caso de las vacunas la efectividad hace referencia a la
disminución proporcional de casos de una enfermedad o evento en una
población vacunada comparada con una población no vacunada, en
condiciones del mundo real.</p>
</div>
<div class="section level3">
<h3 id="tiempo-de-inducción">
<strong>3.2. Tiempo de inducción</strong><a class="anchor" aria-label="anchor" href="#tiempo-de-inducci%C3%B3n"></a>
</h3>
<p>El tiempo de inducción o <em>“delay”</em> se refiere al periodo
necesario para que la vacuna administrada induzca una respuesta inmune
protectora frente a la infección o la enfermedad provocada por un
patógeno. Si ocurre una infección entre el momento de la vacunación y el
momento donde se prevé exista una respuesta inmune protectora, ocurrirá
la infección de manera natural y no se considera un fallo de la vacuna
en cuestión, puesto que la persona inmunizada aún no contaba con la
protección conferida por la vacuna.</p>
</div>
<div class="section level3">
<h3 id="diseños-observacionales-para-el-estudio-de-la-efectividad-vacunal">
<strong>3.3. Diseños observacionales para el estudio de la
efectividad vacunal</strong><a class="anchor" aria-label="anchor" href="#dise%C3%B1os-observacionales-para-el-estudio-de-la-efectividad-vacunal"></a>
</h3>
<p>Por múltiples razones, los estudios observacionales son los más
utilizados en la estimación de la efectividad vacunal. Existen múltiples
diseños, entre ellos: diseño de cohortes, diseño de casos y controles,
diseño de test-negativo, diseño “screening-method”. La elección del
diseño, dependerá de la disponibilidad de información y los recursos
disponibles para llevar a cabo el estudio.</p>
</div>
<div class="section level3">
<h3 id="diseño-de-cohorte-para-el-estudio-de-la-efectividad-vacunal">
<strong>3.4. Diseño de cohorte para el estudio de la efectividad
vacunal</strong><a class="anchor" aria-label="anchor" href="#dise%C3%B1o-de-cohorte-para-el-estudio-de-la-efectividad-vacunal"></a>
</h3>
<p>El término cohorte se refiere a un grupo de personas que comparten
una característica común. En los estudios con diseño de cohorte, existen
dos o más poblaciones que difieren en una característica o exposición y
se realiza un seguimiento a ambos grupos para evaluar la aparición de
uno o más desenlaces de interés y comparar la incidencia de los eventos
entre ambos grupos. Para el caso de los estudios de la efectividad de
vacunas, la exposición de interés corresponde a la aplicación de la
vacuna y los desenlaces pueden incluir:</p>
<ul>
<li><p>Infección: contagio con el patógeno de interés tras una
exposición a alguien infeccioso</p></li>
<li><p>Enfermedad: desarrollo de signos y síntomas relacionados con la
infección con un patógeno. Puede tener diferentes grados de severidad,
requerir ingreso a hospitalización, UCI o incluso conducir a la
muerte.</p></li>
<li><p>A la hora de llevar a cabo estos estudios se debe garantizar que
las personas incluidas en cada población no tengan el desenlace de
interés que será evaluado durante el seguimiento. Así mismo, es
importante que el seguimiento se lleve a cabo de manera igual de
rigurosa y por el mismo tiempo en ambos grupos.</p></li>
</ul>
<p>La efectividad vacunal corresponde a la reducción relativa del riesgo
de desarrollar la infección y/o enfermedad. En los estudios de cohorte
se puede estimar el riesgo relativo, los <em>odds ratio</em> o los
<em>hazard ratio</em> que expresa el riesgo que tiene la cohorte no
expuesta comparado con la cohorte de los expuestos. La efectividad
vacunal será, por lo tanto, el complemento del riesgo proporcional en la
cohorte de expuestos.</p>
<p>Veamos esto con un ejemplo: para evaluar la efectividad de una vacuna
para prevenir el desarrollo de enfermedad en una población, al cabo del
seguimiento la incidencia en la cohorte vacunada fue de 1 por 1000
habitantes y en la cohorte no vacunada fue de 5 por 1000 habitantes. En
este caso, tenemos que el riesgo relativo en la población vacunada fue
0.001/0.005 = 0,2. Es decir, la población vacunada tuvo una incidencia
correspondiente al 20% de la incidencia de la población no vacunada.
Esta reducción se puede atribuir a la vacuna y para estimarla usaríamos
el complemento, que corresponde a 1 - 0,2= 0,8. Es decir que la
reducción que se observó corresponde a un 80% y se puede atribuir a la
vacuna, por lo tanto, la efectividad de la vacunación fue del 80% para
evitar la enfermedad.</p>
</div>
<div class="section level3">
<h3 id="métodos-estadísticos-para-análisis-de-efectividad-vacunal">
<strong>3.5. Métodos estadísticos para análisis de efectividad
vacunal</strong><a class="anchor" aria-label="anchor" href="#m%C3%A9todos-estad%C3%ADsticos-para-an%C3%A1lisis-de-efectividad-vacunal"></a>
</h3>
<p>En el diseño de cohortes se utilizan principalmente dos métodos:
Estimación no paramétrica de Kapplan-Meier y Modelo semi-paramétrico de
Cox</p>
<div class="section level5">
<h5 id="estimador-kaplan-meier">
<strong>Estimador Kaplan-Meier</strong><a class="anchor" aria-label="anchor" href="#estimador-kaplan-meier"></a>
</h5>
<p>El estimador Kaplan-Meier utiliza las tasas de incidencia de un
evento para cuantificar la probabilidad de supervivencia <span class="math inline">\(S(t)\)</span> de forma no paramétrica, es decir,
sin una representación matemática funcional. En general, la incidencia
acumulada de cada grupo permite cuantificar el riesgo de presentar el
evento como <span class="math inline">\(1 - S(t)\)</span>. Asimismo, la
comparación entre el riesgo de ambos grupos en un punto del tiempo
determina el riesgo relativo entre grupos (<span class="math inline">\(RR\)</span>). A partir de esta se estima la
efectividad vacunal como: <span class="math display">\[V_{EFF} = 1 -
RR\]</span></p>
</div>
<div class="section level5">
<h5 id="modelo-de-regresión-de-cox">
<strong>Modelo de Regresión de Cox</strong><a class="anchor" aria-label="anchor" href="#modelo-de-regresi%C3%B3n-de-cox"></a>
</h5>
<p>El modelo Cox, permite estimar de forma semi-paramétrica la función
de riesgo instantáneo <span class="math inline">\(\lambda(t|x_i)\)</span> de un individuo <span class="math inline">\(i\)</span> en terminos de sus características, las
cuales se asocian a un conjunto de covariables <span class="math inline">\(x_1, x_2, ..., x_n\)</span>, con lo cual se
tiene:</p>
<p><span class="math display">\[\lambda(t|x_i) = \lambda_0(t)
\exp(\beta_1 x_{i1} + \beta_2 x_{i2} + ....+\beta_n x_{in})\]</span>
donde <span class="math inline">\(\beta_1, \beta_2, ...,
\beta_n\)</span> son los coeficientes de la regresión y <span class="math inline">\(\lambda_0\)</span> es una función basal no
especificada, por lo que el modelo se asume como semi-paramétrico. En el
caso en el que la función de riesgo instantáneo es completamente
especificada, es decir, se conoce la forma funcional de <span class="math inline">\(\lambda_0(t)\)</span>, es posible calcular
matemáticamente la probabilidad de supervivencia. Sin embargo, ninguna
de estas funciones puede ser estimada directamente del modelo de Cox.
Por el contrario, con este se busca estimar el <em>hazard ratio</em>,
una medida de riesgos comparativa entre dos individuos <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span> con características <span class="math inline">\(x_{i1}, x_{i2}, ..., x_{in}\)</span> y <span class="math inline">\(x_{j1}, x_{j2}, ..., x_{jn}\)</span>,
respectivamente. En este orden, al evaluar el riesgo de un individuo con
respecto al otro se tiene:</p>
<p><span class="math display">\[HR =
\frac{\lambda(t|x_i)}{\lambda(t|x_j)} = \frac{\lambda_0(t)\exp(\beta
x_{i})}{\lambda_0(t)\exp(\beta x_{j})} = \exp(\beta(x_i-x_j))\]</span>
<strong>Riesgos proporcionales:</strong> Nótese que la dependencia
temporal de las funciones de riesgo instantáneo individuales se canceló
dentro de la expresion anterior para el Hazard ratio, por tanto se dice
que los individuos <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span> exhiben <em>riesgos proporcionales</em>
en el tiempo. Esta hipótesis constituye un pilar importante de los
estudios de efectividad bajo diseño de cohorte.</p>
<p>En el contexto de los estudios de cohorte, el modelo de Cox puede
utilizarse para estimar el riesgo comparativo entre ambos grupos de
presentar un desenlace de interés. En este sentido la pertenecia a un
grupo se utiliza como covariable dentro de la regresión.
Particularmente, para el cálculo de la efectividad vacunal se puede
utilizar el <span class="math inline">\(HR\)</span> de forma análoga al
caso discutido para el estimador Kaplan-Meier, con lo que se define:</p>
<p><span class="math display">\[V_{EFF} = 1 - HR\]</span></p>
</div>
</div>
</section><section><h2 class="section-heading" id="caso-de-uso-del-paquete">4. Caso de uso del paquete<a class="anchor" aria-label="anchor" href="#caso-de-uso-del-paquete"></a>
</h2>
<hr class="half-width">
<p>Para esta sesión se trabajará con el conjunto de datos de ejemplo
incluido en el paquete <code>vaccineff</code>. Adicionalmente, se
utilizarán algunas funciones de los paquetes <code>ggplot2</code> y
<code>cowplot</code> para vizualizar algunos resultados.</p>
<p>Para installar <code>vaccineff</code> ejecute las siguientes líneas
en R:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if(!require("pak")) install.packages("pak")</span></span>
<span><span class="co"># pak::pak("epiverse-trace/vaccineff@dev")</span></span></code></pre>
</div>
<p>Posteriormente, para cargar los paquetes en el espacio de trabajo y
el set de datos de ejemplo del <code>vaccineff</code> ejecute:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"vaccineff"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"cowplot"</span><span class="op">)</span></span>
<span><span class="fu">data</span><span class="op">(</span><span class="va">cohortdata</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">cohortdata</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        id sex age death_date death_other_causes vaccine_date_1 vaccine_date_2
1 afade1b2   F  37       &lt;NA&gt;               &lt;NA&gt;           &lt;NA&gt;           &lt;NA&gt;
2 556c8c76   M  19       &lt;NA&gt;               &lt;NA&gt;           &lt;NA&gt;           &lt;NA&gt;
3 04edf85a   M  50       &lt;NA&gt;               &lt;NA&gt;           &lt;NA&gt;           &lt;NA&gt;
4 7e51a18e   F   8       &lt;NA&gt;               &lt;NA&gt;           &lt;NA&gt;           &lt;NA&gt;
5 c5a83f56   M  66       &lt;NA&gt;               &lt;NA&gt;           &lt;NA&gt;           &lt;NA&gt;
6 7f675ec3   M  29       &lt;NA&gt;               &lt;NA&gt;     2044-04-09     2044-04-30
  vaccine_1 vaccine_2
1      &lt;NA&gt;      &lt;NA&gt;
2      &lt;NA&gt;      &lt;NA&gt;
3      &lt;NA&gt;      &lt;NA&gt;
4      &lt;NA&gt;      &lt;NA&gt;
5      &lt;NA&gt;      &lt;NA&gt;
6    BRAND1    BRAND1</code></pre>
</div>
<p>Este tabla contiene información de una epidemia simulada ocurrida en
2044 sobre una población hipotética, compuesta por 100.000 habitantes,
que recibió dos dosis de una vacuna para disminuir el riesgo de muerte
por una enfermedad respiratoria viral. Sobre esta población se realizó
seguimiento por 1 año, entre el 1 de enero y 31 de diciembre de 2044. En
el conjunto de datos se presenta la información desagregada para cada
uno de los participantes.</p>
<div class="section level3">
<h3 id="funciones-básicas-de-exploración-de-datos">
<strong>4.1 Funciones básicas de exploración de datos</strong><a class="anchor" aria-label="anchor" href="#funciones-b%C3%A1sicas-de-exploraci%C3%B3n-de-datos"></a>
</h3>
<div class="section level4">
<h4 id="grupo-etario">
<strong>4.1.2 Grupo etario</strong><a class="anchor" aria-label="anchor" href="#grupo-etario"></a>
</h4>
<p>Para agrupar la población por grupo etario y graficar la distribución
por edad utilizaremos la función “get_age_group”. Para esto, ejectute el
siguiente comando en R:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohortdata</span><span class="op">$</span><span class="va">age_group</span> <span class="op">&lt;-</span> <span class="fu">get_age_group</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>  col_age <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  max_val <span class="op">=</span> <span class="fl">80</span>,</span>
<span>  min_val <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></code></pre>
</div>
<p>Esta función permite agrupar la población en intervalos etarios a
partir de la variable “age” del conjunto de datos. En particular, para
construir la agrupación por decenios se asigna el ancho del intervalo
con step = 9, el mínimo valor de edad en 0 con “min_val” y el máximo
valor en 80 con “max_val”. Esto significa que cualquier registro con
edad mayor o igual a 80 años se agrupará en “&gt;80”</p>
<p>Puede graficar de forma rápida la distribución etaria asociada a la
variable “age_group” utilizando la función “geom_bar” de la librería
ggplot2. Para esto, ejecute el siguiente comando en R:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Vaccineff-tutorial-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level4">
<h4 id="cobertura-vacunal-en-las-cohortes">
<strong>4.1.2. Cobertura vacunal en las cohortes</strong><a class="anchor" aria-label="anchor" href="#cobertura-vacunal-en-las-cohortes"></a>
</h4>
<p>En un conjunto de datos típico de un estudio de cohorte se tiene
información desagregada por persona de la(s) dosis aplicada(s) durante
el seguimiento. En este sentido, es importante dimensionar el nivel de
cobertura en la vacunación alcanzado durante el seguimiento. vaccineff
ofrece la función “plot_coverage” que permite llevar a cabo esta tarea
con facilidad. Para esto, ejecute el siguiente comando en R:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_coverage</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>  vacc_date_col <span class="op">=</span> <span class="st">"vaccine_date_1"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>  doses_count_color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  coverage_color <span class="op">=</span> <span class="st">"mediumpurple"</span>,</span>
<span>  date_interval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cumulative <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Vaccineff-tutorial-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Esta función calcula la cobertura con base en alguna dosis, la cual
se especifica en el parámetro “vacc_date_col”. En particular, en el
ejemplo anterior se utiliza la <u>primera dosi</u>s del conjunto de
datos de ejemplo (“vaccine_date_1”). Además, es posible agrupar el
conteo de dosis y el cálculo de cobertura en días, meses y años
utilizando el parámetro “unit” y personalizar los colores de la gráfica
con los parámetros “doses_count_color” y “coverage_color”. El parámetro
“date_interval” se utiliza para personalizar el intervalo de datos que
se quiere observar, en caso de usar “FALSE” la función toma las fechas
mínima y máxima de la tabla. Finalmente, el parámetro “cumulative”
permite graficar el conteo de dosis de forma acumulada en el tiempo.</p>
</div>
</div>
<div class="section level3">
<h3 id="seguimiento-de-la-cohorte-y-tiempos-al-evento">
<strong>4.2 Seguimiento de la cohorte y tiempos al
evento</strong><a class="anchor" aria-label="anchor" href="#seguimiento-de-la-cohorte-y-tiempos-al-evento"></a>
</h3>
<p>Para llevar a cabo la estimación de la efectividad vacunal primero
debe definir la fecha de inicio y fin del seguimiento de cohortes, esto
con base en su exploración de las bases de datos. Para el caso
particular del conjunto de datos ejemplo contenidos es
<code>vaccineff</code> se utiliza:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start_cohort</span> <span class="op">&lt;-</span> <span class="fu">as.Date</span><span class="op">(</span><span class="st">"2044-01-01"</span><span class="op">)</span></span>
<span><span class="va">end_cohort</span> <span class="op">&lt;-</span> <span class="fu">as.Date</span><span class="op">(</span><span class="st">"2044-12-31"</span><span class="op">)</span></span></code></pre>
</div>
<p>Para determinar la fecha de immunización, de un individuo
<code>vaccineff</code> cuenta con la función
<code>get_immunization_date()</code>. Esta calcula la fecha de
inmunización seleccionando la vacuna que cumpla con el criterio de
<em>fecha límite</em> presentado en la siguiente figura.</p>
<figure><img src="fig/limit_imm.png" alt="Esquema de fecha límite para selección de vacunas" class="figure mx-auto d-block"><div class="figcaption">Esquema de fecha límite para selección de
vacunas</div>
</figure><div class="section level4">
<h4 id="tiempo-de-inducción-del-efecto-delay">
<strong>4.2.2 Tiempo de inducción del efecto
<em>(delay)</em></strong><a class="anchor" aria-label="anchor" href="#tiempo-de-inducci%C3%B3n-del-efecto-delay"></a>
</h4>
<p>En la figura anterior se introdujo el concepto de <em>delay</em>. El
<em>delay del desenlace</em> hace referencia al tiempo característico al
desenlace desde que se un individuo se infecta. Por otra parte, el
<em>delay de la immunización</em> se refiere al tiempo que se espera que
transcurra antes de considerar que existe inmunidad protectora. Cada uno
de estas variables puede controlarse en la función mediante los
parámetros <code>outcome_delay</code> e <code>immunization_delay</code>,
respectivamente. El valor que se asigne a estas depende de la naturaleza
del estudio. En particular, para nuestra epidemia ejemplo utilizaremos
<code>outcome_delay = 0</code> dado que no es considerado como una
variable relevante para determinar la fecha límite en que la vacuna
podría hacer efecto. Por otra parte, el valor asumido para el de
immunización es de 14 días.</p>
<p>Para calcular la fecha de immunización de cada individiduo escriba la
siguiente instrucción en R y ejecútela:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohortdata</span><span class="op">$</span><span class="va">immunization</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">get_immunization_date</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>    outcome_date_col <span class="op">=</span> <span class="st">"death_date"</span>,</span>
<span>    outcome_delay <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    immunization_delay <span class="op">=</span> <span class="fl">14</span>,</span>
<span>    vacc_date_col <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"vaccine_date_1"</span>, <span class="st">"vaccine_date_2"</span><span class="op">)</span>,</span>
<span>    end_cohort <span class="op">=</span> <span class="va">end_cohort</span>,</span>
<span>    take_first <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>Al ejecutar este comando, se añadirá una columna nueva al conjunto de
datos del caso de estudio, esta columna contiene una variable de tipo
“Date” que corresponde la fecha 14 días posteriores a la última dosis de
cualquiera de las dos vacunas utilizadas en el caso de estudio, que
cumpla con el criterio de <em>fecha límite</em>. Puede evidenciar la
nueva columna en el conjunto de datos.</p>
</div>
<div class="section level4">
<h4 id="definir-la-exposición-cohorte-vacunada-y-cohorte-no-vacunada">
<strong>4.2.3. Definir la exposición: cohorte vacunada y cohorte no
vacunada</strong><a class="anchor" aria-label="anchor" href="#definir-la-exposici%C3%B3n-cohorte-vacunada-y-cohorte-no-vacunada"></a>
</h4>
<p>A continuación, cree una columna nueva donde categorice cada uno de
los sujetos según su estado vacunal, vacunados como “v” y no vacunados
como “u” (unvaccinated, en inglés). Para esto ejecute el siguiente
comando en R:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohortdata</span><span class="op">$</span><span class="va">vaccine_status</span> <span class="op">&lt;-</span> <span class="fu">set_status</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>  col_names <span class="op">=</span> <span class="st">"immunization"</span>,</span>
<span>  status <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"vacc"</span>, <span class="st">"unvacc"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Al ejecutar el comando encontrará que se ha creado una nueva columna
en el conjunto de datos con los valores “vacc” o “unvacc”, para cada uno
de los registros de acuerdo con su estado de vacunación, el cual se
determina a partir de la variable <code>"immunization"</code>.</p>
</div>
<div class="section level4">
<h4 id="definir-el-desenlace-estado-vivo-vs-estado-fallecido">
<strong>4.2.3 Definir el desenlace: estado vivo vs estado
fallecido</strong><a class="anchor" aria-label="anchor" href="#definir-el-desenlace-estado-vivo-vs-estado-fallecido"></a>
</h4>
<p>El desenlace para este ejercicio va a ser la condición vital al final
del estudio. En otros ejercicios el desenlace de interés podría ser la
hospitalización o la infección, dependiendo del conjunto de datos
utilizado.</p>
<p>Tenga en cuenta que en conjunto de datos del caso de estudio todas
las defunciones son debidas a la infección por el virus de interés. Para
definir el desenlace de interés de acuerdo a la condición vital de los
participantes en la cohorte, ejecute el siguiente comando en R:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohortdata</span><span class="op">$</span><span class="va">death_status</span> <span class="op">&lt;-</span> <span class="fu">set_status</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>  col_names <span class="op">=</span> <span class="st">"death_date"</span><span class="op">)</span></span></code></pre>
</div>
<p>Al ejecutar este comando, nuevamente aparecerá una nueva columna en
el conjunto de datos con el que se está realizando el caso de estudio.
Al explorar la base de datos completa, se verifica que en la nueva
columna aparece 0 = vivo y 1 = fallecido.</p>
</div>
<div class="section level4">
<h4 id="calcular-el-tiempo-al-evento-desde-exposición-hasta-desenlace">
<strong>4.2.4. Calcular el tiempo al evento (desde exposición hasta
desenlace)</strong><a class="anchor" aria-label="anchor" href="#calcular-el-tiempo-al-evento-desde-exposici%C3%B3n-hasta-desenlace"></a>
</h4>
<p>Ahora, calcule para cada una de las personas el tiempo que fue
seguido en el estudio. Recuerde que el seguimiento se hace igual para
ambas cohortes (vacunada y no vacunada) y finaliza cuando termina el
estudio o cuando se presenta el desenlace de interés. Para obtener este
dato ejecute el siguiente comando en R:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohortdata</span><span class="op">$</span><span class="va">time_to_death</span> <span class="op">&lt;-</span> <span class="fu">get_time_to_event</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>  outcome_date_col <span class="op">=</span> <span class="st">"death_date"</span>,</span>
<span>  start_cohort <span class="op">=</span> <span class="va">start_cohort</span>,</span>
<span>  end_cohort <span class="op">=</span> <span class="va">end_cohort</span>,</span>
<span>  start_from_immunization <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>Nuevamente, al ejecutar este comando se creará una nueva variable en
el conjunto de datos y como se puede evidenciar al explorar los datos
completos, la nueva variable estima los días de seguimiento para cada
una de las personas. Esta función permite crear tiempos al evento desde
el inicio del seguimiento en el caso de estudio, en este caso se utiliza
la opción “start_from_immunization = FALSE” o desde la fecha de
inmunización. Para este último caso es necesario asignar
“start_from_immunization = TRUE” y pasar el nombre de la columna con la
información sobre la fecha de inmunización en el parámetro
“immunization_date_col”. En la figura a continuación se presenta un
esquema de los dos métodos de cálculo del tiempo al evento.</p>
<figure><img src="fig/time-to-event.png" alt="a) Tiempo al evento evaludado desde inicio de la cohorte. b) tiempo al evento desde la fecha de immunización" class="figure mx-auto d-block"><div class="figcaption">a) Tiempo al evento evaludado desde inicio de la
cohorte. b) tiempo al evento desde la fecha de immunización</div>
</figure>
</div>
</div>
<div class="section level3">
<h3 id="curvas-de-riesgo-acumulado-y-supervivencia-al-desenlace-en-cada-cohorte">4.3. Curvas de riesgo acumulado y supervivencia al desenlace en cada
cohorte<a class="anchor" aria-label="anchor" href="#curvas-de-riesgo-acumulado-y-supervivencia-al-desenlace-en-cada-cohorte"></a>
</h3>
<p>Como primera aproximación a la efectividad vacunal, graficaremos la
curva de riesgos acumulados (1 menos la supervivencia de las
poblaciones). Esta nos permite entender de forma cualitativa cuál de las
poblaciones acumula mayor riesgo durante el estudio de cohorte. Y por
tanto, evaluar hipótesis sobre el potencial efecto de la vacunación
sobre la cohorte. Para graficar el riesgo acumulado ejecute el siguiente
comando en R:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_survival</span><span class="op">(</span>data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>  outcome_status_col <span class="op">=</span> <span class="st">"death_status"</span>,</span>
<span>  time_to_event_col <span class="op">=</span> <span class="st">"time_to_death"</span>,</span>
<span>  vacc_status_col <span class="op">=</span> <span class="st">"vaccine_status"</span>,</span>
<span>  vaccinated_status <span class="op">=</span> <span class="st">"vacc"</span>,</span>
<span>  unvaccinated_status <span class="op">=</span> <span class="st">"unvacc"</span>,</span>
<span>  vaccinated_color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  unvaccinated_color <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>  start_cohort <span class="op">=</span> <span class="va">start_cohort</span>,</span>
<span>  end_cohort <span class="op">=</span> <span class="va">end_cohort</span>,</span>
<span>  percentage <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cumulative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Vaccineff-tutorial-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>A partir de la función anterior también es posible realizar la
gráfica de supervivencia de las cohortes o gráfica de Kaplan-Meier en la
cual se parte del 100% de ambas cohortes en el eje de las ordenadas y en
el eje de las abscisas se representa el tiempo y se observa la
disminución que hay debido a las defunciones en cada cohorte. Tenga en
cuenta que este no es el estimador de Kaplan-Meir, es sólo la gráfica
sobre las curvas de supervivencia y de riesgo acumulado. Para obtener
este gráfico, se ejecuta la misma función y se cambia el argumento
“percentage” por FALSE:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt_surv</span> <span class="op">&lt;-</span> <span class="fu">plot_survival</span><span class="op">(</span>data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>  outcome_status_col <span class="op">=</span> <span class="st">"death_status"</span>,</span>
<span>  time_to_event_col <span class="op">=</span> <span class="st">"time_to_death"</span>,</span>
<span>  vacc_status_col <span class="op">=</span> <span class="st">"vaccine_status"</span>,</span>
<span>  vaccinated_status <span class="op">=</span> <span class="st">"vacc"</span>,</span>
<span>  unvaccinated_status <span class="op">=</span> <span class="st">"unvacc"</span>,</span>
<span>  vaccinated_color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  unvaccinated_color <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>  start_cohort <span class="op">=</span> <span class="va">start_cohort</span>,</span>
<span>  end_cohort <span class="op">=</span> <span class="va">end_cohort</span>,</span>
<span>  percentage <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cumulative <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">plt_surv</span></span></code></pre>
</div>
<figure><img src="fig/Vaccineff-tutorial-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="evaluación-de-la-hipótesis-riesgos-proporcionales">
<strong>4.4. Evaluación de la hipótesis riesgos
proporcionales</strong><a class="anchor" aria-label="anchor" href="#evaluaci%C3%B3n-de-la-hip%C3%B3tesis-riesgos-proporcionales"></a>
</h3>
<p>Previo a la estimación de la efectividad vacunal es importante
testear la hipótesis de riesgos proporcionales entre las cohortes de
vacunados y no vacunados, con el fin de identificar posibles sesgos
muestrales que afecten la validez de los resultados y definir
estrategias de cálculo de cohortes dinámicas, emparejamiento o
estratificación, entre otras, que permitar contrarestar este efecto. Un
método cualitativo utilizado ampliamente en la literatura es la
transformación de la probabilidad de supervivencia mediante la función
logaritmo natural como <span class="math inline">\(\log[-\log[S(t)]]\)</span>. Al graficar esta
función contra el logaritmo del tiempo al evento, es posible identificar
si los grupos representan riesgos proporcionales cuando sus curvas se
comportan de forma aproximadamente paralela.</p>
<p>A continuación se presentan las gráficas loglog obtenidas al
construir los tiempos al evento de forma dinámica (panel de la izquiera)
y con punto de inicio fijo (panel de la derecha). Particularmente, se
observa que el cálculo dinámico de los tiempos no satisface riesgos
proporcionales, por lo que pontencialmente necesitará algún tipo de
estrategia para contrarestar los posibles sesgos muestrales.</p>
<figure><img src="fig/Vaccineff-tutorial-rendered-unnamed-chunk-13-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="estimación-de-la-efectividad-vacunal">
<strong>4.5. Estimación de la efectividad vacunal</strong><a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-la-efectividad-vacunal"></a>
</h3>
<div class="section level4">
<h4 id="modelo-de-cox">
<strong>Modelo de Cox</strong><a class="anchor" aria-label="anchor" href="#modelo-de-cox"></a>
</h4>
<p>En todos los estudios observacionales de efectividad vacunal de
cohorte se compara el riesgo (o tasa de incidencia) entre los vacunados
y no vacunados de desarrollar el desenlace de interés (infección,
enfermedad, muerte, etc). La medida de riesgo a utilizar dependerá de
las características de la cohorte y puede expresarse en términos de
<em>relative risk</em> (RR) o <em>hazard ratio</em> (HR).</p>
<p>En este ejercicio utilizaremos el modelo de regresión de riesgos
proporcionales de Cox para estimar el <em>hazar ratio</em> y con esta
medida estimar la efectividad mediante</p>
<p><code>VE= 1-HR</code></p>
<p>Para estimar la efectividad vacunal en términos de HR, ejecute el
siguiente comando en R:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">coh_eff_noconf</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cohortdata</span>,</span>
<span>  outcome_status_col <span class="op">=</span> <span class="st">"death_status"</span>,</span>
<span>  time_to_event_col <span class="op">=</span> <span class="st">"time_to_death"</span>,</span>
<span>  status_vacc_col <span class="op">=</span> <span class="st">"vaccine_status"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      HR HR_low HR_high  V_eff V_eff_low V_eff_high     PH      p_value
1 0.2684 0.1855  0.3884 0.7316    0.6116     0.8145 reject 0.0009088627</code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="cohorte-dinámica---emparejamiento-poblacional">
<strong>4.6 Cohorte dinámica - Emparejamiento
poblacional</strong><a class="anchor" aria-label="anchor" href="#cohorte-din%C3%A1mica---emparejamiento-poblacional"></a>
</h3>
<p>El comando anterior arrojó la efectividad vacunal obtenida mediante
el model de Cox. Sin embargo, en la columna PH aparece la palabra
rejected. Esto significa que pese a que las curvas de ambos grupos son
paralelas la evaluación de la hipótesis de riesgos proporcionales
haciendo uso del test de <em>Schoenfeld</em> no es satisfactoria. Esto
debido a los potenciales sesgos muestrales inducidos por la estrategia
de vacunación desplegada sobre la población. Una estrategia para
contrarestas dichos sesgos es el emparejamiento dinámico de la
población. En la siguiente figura se presenta un esquema de
emparejamiento orientado a disminuir los sesgos muestrales.</p>
<figure><img src="fig/matching.png" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="próximos-características">
<strong>4.7 Próximos características</strong><a class="anchor" aria-label="anchor" href="#pr%C3%B3ximos-caracter%C3%ADsticas"></a>
</h3>
<ul>
<li><p>Estimador Kaplan-Meier</p></li>
<li><p>Curva loglog para evaluación de riesgos proporcionales</p></li>
<li><p>Matching dinámico</p></li>
<li><p>Censura</p></li>
</ul>
</div>
</section><section><h2 class="section-heading" id="reflexión">5. Reflexión<a class="anchor" aria-label="anchor" href="#reflexi%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>En esta sesión se llevó a cabo una estimación básica de la
efectividad vacunal mediante un estudio de cohorte, haciendo uso de los
estimador Kaplan-Meier y del modelo de Cox. Adicionalmente, se estudió
la hipótesis de riesgos proporcionales para los grupos vacunado y no
vacunado comparando la construcción de tiempos al evento de forma
dinámica y fija. Se observó que pese a que la hipótesis de riesgos
proporcionales se corrobora gráficamente en la consrucción de los
tiempos al evento con fecha de inicio fija, al evaluar el modelo de
riesgos proporcionales de Cox el test de Schoenfeld rechaza esta
hipótesis. En general la decisión sobre aceptar o no los resultados es
altamente dependiente del acceso a información adicional relevante que
permita realizar ajustes a la estimación y capturar dinámicas
relevantes.</p>
<hr></section><section><h2 class="section-heading" id="reto">Reto<a class="anchor" aria-label="anchor" href="#reto"></a>
</h2>
<hr class="half-width">
<p><a href="https://docs.google.com/document/d/1_33E0LufZP7FNO9Q491aFquV26eS4p2h/edit?usp=sharing&amp;ouid=108718106243006326200&amp;rtpof=true&amp;sd=true" class="external-link">Reto</a></p>
<hr>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li><p>Estudiar algunos de los conceptos claves para la implementación
de estudios observacionales con diseño de cohortes</p></li>
<li><p>Calcular las métricas claves para llevar a cabo un estudio de
cohortes</p></li>
<li><p>Discutir las ventajas y desventajas de los métodos de estimación
no paramétricos y semi-paramétricos de modelos de
superviviencia</p></li>
<li><p>Aplicar estrategias de emparejamiento de casos y control y
discutir su potencial efecto sobre los estudios de cohortes</p></li>
<li><p>Estimar la efectividad vacunal haciendo uso de un diseño de
cohortes</p></li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="sobre-este-documento">Sobre este documento<a class="anchor" aria-label="anchor" href="#sobre-este-documento"></a>
</h3>
<p>Este documento ha sido diseñado por David Santiago Quevedo para el
Curso Internacional: Análisis de Brotes y Modelamiento en Salud Pública,
Bogotá 2023. TRACE-LAC/Javeriana.</p>
<div class="section level4">
<h4 id="contribuciones">Contribuciones<a class="anchor" aria-label="anchor" href="#contribuciones"></a>
</h4>
<ul>
<li><p>David Santiago Quevedo</p></li>
<li><p>Santiago Loaiza</p></li>
<li><p>Zulma Cucunubá</p></li>
</ul>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>
</section></section><section id="aio-epiCo-tutorial"><p>Content from <a href="epiCo-tutorial.html">Indicadores demográficos, canales endémicos y clusters de incidencia usando epiCo</a></p>
<hr>
<p>Última actualización: 2025-03-13 |

        <a href="https://github.com/epiverse-trace/epimodelac/edit/main/episodes/epiCo-tutorial.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo simular una sala de análisis de riesgo?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<p>Al final de este taller usted podrá:</p>
<ol style="list-style-type: decimal">
<li>Navegar por la codificación de la División Política Administrativa
de Colombia (DIVIPOLA).</li>
<li>Consultar, visualizar e interpretar pirámides poblacionales a
distintas escalas administrativas.</li>
<li>Familiarizarse con la información epidemiológica proporcionada por
el SIVIGILA.</li>
<li>Describir las características demográficas de la información
epidemiológica.</li>
<li>Estimar tasas de incidencia acumulada a distintas escalas espaciales
y temporales.</li>
<li>Realizar una evaluación del riesgo etario integrando información
epidemiológica con información sobre la estructura poblacional de una
región.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="epico">
<strong>epiCo</strong><a class="anchor" aria-label="anchor" href="#epico"></a>
</h1>
<p><strong>epiCo</strong> ofrece herramientas estadísticas y de
visualización para el análisis de indicadores demográficos,
comportamiento espaciotemporal como mapas de riesgo, y caracterización
de los brotes a través de canales endémicos de las ETVs en Colombia.</p>
<div class="section level2">
<h2 id="instalación">Instalación<a class="anchor" aria-label="anchor" href="#instalaci%C3%B3n"></a>
</h2>
<p>Puede descargar la última versión estable de <strong>epiCo</strong> a
través del repositorio en <a href="https://github.com/epiverse-trace/epiCo" class="external-link">GitHub</a> con los
siguientes comandos:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if(!require("remotes")) install.packages("remotes")</span></span>
<span><span class="co"># if(!require("epico")) remotes::install_github("epiverse-trace/epiCo")</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="motivación">Motivación<a class="anchor" aria-label="anchor" href="#motivaci%C3%B3n"></a>
</h2>
<ul>
<li>Incluir evaluaciones de riesgos espaciales y demográficos en
informes epidemiológicos rutinarios para mejorar la identificación de
grupos vulnerables.</li>
<li>Facilitar la comprensión de los diferentes perfiles epidemiológicos
dentro de una región de Colombia en cuanto al inicio, duración, magnitud
y frecuencia de los brotes.</li>
<li>Reforzar la transparencia de los métodos utilizados para el análisis
de brotes.</li>
</ul>
</div>
<div class="section level2">
<h2 id="indicadores-demográficos-en-epico">Indicadores demográficos en <strong>epiCo</strong>
<a class="anchor" aria-label="anchor" href="#indicadores-demogr%C3%A1ficos-en-epico"></a>
</h2>
<p>El módulo demográfico de <strong>epiCo</strong> es una herramienta de
análisis descriptivo y evaluación del riesgo basado en las variables
reportadas por el Sistema de Vigilancia en Salud Pública en Colombia <a href="https://www.ins.gov.co/Direcciones/Vigilancia/Paginas/SIVIGILA.aspx" class="external-link">(SIVIGILA)</a>
y en datos del Departamento Administrativo Nacional de Estadística <a href="https://www.dane.gov.co/" class="external-link">(DANE)</a>.</p>
<div class="section level3">
<h3 id="navegando-por-la-codificación-de-la-división-política-administrativa-de-colombia-divipola">1. Navegando por la codificación de la División Política
Administrativa de Colombia (DIVIPOLA)<a class="anchor" aria-label="anchor" href="#navegando-por-la-codificaci%C3%B3n-de-la-divisi%C3%B3n-pol%C3%ADtica-administrativa-de-colombia-divipola"></a>
</h3>
<p>El sistema DIVIPOLA es una nomenclatura estándar diseñada por el DANE
para la identificación de entidades territoriales (departamentos,
distritos y municipios), áreas no municipalizadas, y centros poblados a
través de un código numérico único.</p>
<p>Colombia posee:</p>
<ul>
<li>32 departamentos (División administrativa nivel 1)</li>
<li>1102 municipios (División administrativa nivel 2)</li>
<li>1 isla</li>
<li>18 áreas no municipalizadas</li>
<li>6678 centros poblados</li>
</ul>
<p>Dos dígitos son usados para codificar los departamentos, y tres
dígitos adicionales son usados para codificar los municipios.
<strong>epiCo</strong> proporciona la lista completa de códigos a través
de un dataset interno llamado <code>divipola_table</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Se cargan las librerías necesarias.</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiCo</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Listado de códigos para cada uno de los municipios.</span></span>
<span><span class="fu">data</span><span class="op">(</span><span class="st">"divipola_table"</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">divipola_table</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  COD_DPTO  NOM_DPTO COD_REG          NOM_REG COD_MPIO   NOM_MPIO  LATITUD
1       05 ANTIOQUIA      03 CENTRO_OCCIDENTE    05001   MEDELLIN 6.257590
2       05 ANTIOQUIA      03 CENTRO_OCCIDENTE    05002  ABEJORRAL 5.803728
3       05 ANTIOQUIA      03 CENTRO_OCCIDENTE    05004   ABRIAQUI 6.627569
4       05 ANTIOQUIA      03 CENTRO_OCCIDENTE    05021 ALEJANDRIA 6.365534
5       05 ANTIOQUIA      03 CENTRO_OCCIDENTE    05030      AMAGA 6.032922
6       05 ANTIOQUIA      03 CENTRO_OCCIDENTE    05031     AMALFI 6.977789
   LONGITUD
1 -75.61103
2 -75.43847
3 -76.08598
4 -75.09060
5 -75.70800
6 -74.98124</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="pirámides-poblacionales">2. Pirámides poblacionales<a class="anchor" aria-label="anchor" href="#pir%C3%A1mides-poblacionales"></a>
</h3>
<p><strong>epiCo</strong> cuenta con datos internos sobre las
proyecciones poblaciones de Colombia a nivel nacional, departamental y
municipal (información proveniente del DANE).</p>
<p>Los usuarios pueden realizar consultas a <strong>epiCo</strong>
utilizando la función <code>population_pyramid</code>, la cual requiere
el codigo DIVIPOLA de la entidad de interés y el año que se desea
consultar.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tolima_codigo</span> <span class="op">&lt;-</span> <span class="st">"73"</span> <span class="co"># Código DIVIPOLA para el departamento del Tolima.</span></span>
<span><span class="va">año</span> <span class="op">&lt;-</span> <span class="fl">2021</span> <span class="co"># Año a consultar.</span></span>
<span><span class="va">tolima_piramide_2021</span> <span class="op">&lt;-</span> <span class="fu">population_pyramid</span><span class="op">(</span><span class="va">tolima_codigo</span>, <span class="va">año</span><span class="op">)</span> <span class="co"># Pirámide </span></span>
<span><span class="co"># poblacional del departamento del tolima para el año 2021.</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">tolima_piramide_2021</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  age population sex
1   0      42889   F
2   5      47378   F
3  10      51141   F
4  15      54694   F
5  20      53866   F
6  25      50014   F</code></pre>
</div>
<p><strong>epiCo</strong> presenta los datos agrupados en intervalos de
5 años <em>de forma predeterminada</em>; sin embargo, puede modificar
parámetros para tener rangos distintos, separar la pirámide por género
binario, obtener los datos como conteos totales o proporciones y/o
desplegar una gráfica de la pirámide.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tolima_codigo</span> <span class="op">&lt;-</span> <span class="st">"73"</span> <span class="co"># Código DIVIPOLA para el departamento del Tolima.</span></span>
<span><span class="va">año</span> <span class="op">&lt;-</span> <span class="fl">2021</span> <span class="co"># Año a consultar.</span></span>
<span><span class="va">rango_edad</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co">#Rango de edades o ventana.</span></span>
<span><span class="co"># Pirámide poblacional del departamento del tolima para el año 2021.</span></span>
<span><span class="va">tolima_piramide_2021</span> <span class="op">&lt;-</span> <span class="fu">population_pyramid</span><span class="op">(</span>divipola_code <span class="op">=</span> <span class="va">tolima_codigo</span>,</span>
<span>                                           year <span class="op">=</span> <span class="va">año</span>,</span>
<span>                                           range <span class="op">=</span> <span class="va">rango_edad</span>,</span>
<span>                                           sex <span class="op">=</span> <span class="cn">TRUE</span>, total <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                           plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/epiCo-tutorial-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="datos-epidemiológicos">3. Datos epidemiológicos<a class="anchor" aria-label="anchor" href="#datos-epidemiol%C3%B3gicos"></a>
</h3>
<p><strong>epiCo</strong> es una herramienta que produce análisis
basados en datos epidemiológicos como los que provee el SIVIGILA. El
paquete cuenta con un data set llamado epi_data, que cuenta con la
información y estructura que requiere la librería para sus funciones y
que utiliza los casos de dengue reportados en el departamento del Tolima
del 2012 al 2021 a manera de ejemplo.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Datos epimdeiológicos.</span></span>
<span><span class="fu">data</span><span class="op">(</span><span class="st">"epi_data"</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">epi_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 16
  fec_not    cod_pais_o cod_dpto_o cod_mun_o cod_pais_r cod_dpto_r cod_mun_r
  &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;
1 2012-02-04 170        73         73671     170        73         73671
2 2012-11-18 170        73         73268     170        73         73268
3 2012-07-12 170        73         73001     170        11         11001
4 2012-11-24 170        73         73275     170        73         73275
5 2012-03-29 170        73         73268     170        73         73268
6 2012-02-19 170        73         73001     170        73         73001
# ℹ 9 more variables: cod_dpto_n &lt;chr&gt;, cod_mun_n &lt;chr&gt;, edad &lt;dbl&gt;,
#   sexo &lt;chr&gt;, per_etn &lt;dbl&gt;, ocupacion &lt;chr&gt;, estrato &lt;chr&gt;, ini_sin &lt;chr&gt;,
#   cod_eve &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="variables-demográficas">4. Variables demográficas<a class="anchor" aria-label="anchor" href="#variables-demogr%C3%A1ficas"></a>
</h3>
<p><strong>epiCo</strong> proporciona un diccionario para consultar las
categorías étnicas usadas por el sistema SIVIGILA a través de la función
<code>describe_ethnicity</code>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Descripción de las etnicidades reportadas en la base de datos.</span></span>
<span><span class="fu">describe_ethnicity</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">epi_data</span><span class="op">$</span><span class="va">per_etn</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  code
1    1
2    2
3    3
4    4
5    5
6    6
                                                                                                                                                                                                                                                  description
1                                  A person of Amerindian descent who shares feelings of identification with their aboriginal past, maintaining traits and values of their traditional culture, as well as their own forms of organization and social control
2                                                                                      They are communities that have their own ethnic and cultural identity; They are characterized by a nomadic tradition, and have their own language, which is Romanesque
3 Population located in the Archipelago of San Andres, Providencia and Santa Catalina, with Afro-Anglo-Antillean cultural roots, whose members have clearly differentiated sociocultural and linguistic traits from the rest of the Afro-Colombian population
4                                                                                                                     Population located in the municipality of San Basilio de Palenque, department of Bolivar, where palenquero is spoken, a Creole language
5                                                                                                               Person of Afro-Colombian descent who have their own culture, and have their own traditions and customs within the rural-populatedrelationship
6                                                                                                                                                                                                                                                        &lt;NA&gt;</code></pre>
</div>
<p>Para calcular la distribución de las ocupaciones en estos años,
<strong>epiCo</strong> usa la columna que nos indica la ocupación de
cada uno de los casos presentados en estos años. Esta ocupación está
codificada por el sistema ISCO-88 como se puede observar en la tabla
<code>isco88_table</code>, y epiCo cuenta con la función
<code>occupation_plot</code> para visualizar de forma proporcional el
número de casos pertenecientes a una labor.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tabla de ocupaciones del sistema ISCO-88.</span></span>
<span><span class="fu">data</span><span class="op">(</span><span class="st">"isco88_table"</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">isco88_table</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  major                                 major_label sub_major
1     1 Legislators, Senior Officials and Managers         11
2     1 Legislators, Senior Officials and Managers         11
3     1 Legislators, Senior Officials and Managers         11
4     1 Legislators, Senior Officials and Managers         11
5     1 Legislators, Senior Officials and Managers         11
6     1 Legislators, Senior Officials and Managers         11
                    sub_major_label minor
1 Legislators and Senior Officials    111
2 Legislators and Senior Officials    112
3 Legislators and Senior Officials    113
4 Legislators and Senior Officials    114
5 Legislators and Senior Officials    114
6 Legislators and Senior Officials    114
                                          minor_label unit
1                                        Legislators  1110
2                        Senior Government Officials  1120
3           Traditional Chiefs and Heads of Villages  1130
4 Senior Officials of Special-Interest Organisations  1141
5 Senior Officials of Special-Interest Organisations  1142
6 Senior Officials of Special-Interest Organisations  1143
                                                                           unit_label
1                                                                        Legislators
2                                                        Senior government officials
3                                           Traditional chiefs and heads of villages
4                                  Senior officials of political-party organisations
5 Senior officials of employers', workers' and other economic-interest organisations
6          Senior officials of humanitarian and other special-interest organisations </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Se calcula la distribución de ocupaciones.</span></span>
<span><span class="va">occupation</span> <span class="op">&lt;-</span> <span class="fu">describe_occupation</span><span class="op">(</span>isco_codes <span class="op">=</span> <span class="fu">as.integer</span><span class="op">(</span><span class="va">epi_data</span><span class="op">$</span><span class="va">ocupacion</span><span class="op">)</span>, sex <span class="op">=</span> <span class="va">epi_data</span><span class="op">$</span><span class="va">sexo</span>, plot <span class="op">=</span> <span class="st">"treemap"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ADVERTENCIA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in describe_occupation(isco_codes = as.integer(epi_data$ocupacion), :
NAs introduced by coercion</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>59870 codes are invalid.</code></pre>
</div>
<figure><img src="fig/epiCo-tutorial-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="estimación-de-las-tasas-de-incidencia">5. Estimación de las tasas de incidencia<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-las-tasas-de-incidencia"></a>
</h3>
<p>La función <code>incidence_rate</code> de <strong>epiCo</strong>
requiere del paquete <em>incidence</em> para producir un objeto
incidence modificado. En lugar de un vector (o matriz) de conteos,
transforma el objeto para proporcionar un elemento de tasa que
representa el número de casos en el periodo dividido por el número total
de habitantes en la región en las fechas específicas.</p>
<p><strong>epiCo</strong> usa como denominadores las proyecciones
poblacionales del DANE; por lo que es necesario proporcionar el nivel de
administración en el que se calculan las incidencias.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Se crea el objeto incidence a partir de las fechas y municiíos presentadas en</span></span>
<span><span class="co"># epi_data.</span></span>
<span><span class="va">incidence_objecto</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="op">(</span></span>
<span>  dates <span class="op">=</span> <span class="va">epi_data</span><span class="op">$</span><span class="va">fec_not</span>,</span>
<span>  groups <span class="op">=</span> <span class="va">epi_data</span><span class="op">$</span><span class="va">cod_mun_o</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"1 epiweek"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Calcular la tasa de incidencia para cada uno de los municipios del Tolima.</span></span>
<span><span class="va">incidence_tasa_objecto</span> <span class="op">&lt;-</span> <span class="fu">incidence_rate</span><span class="op">(</span><span class="va">incidence_objecto</span>, level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">incidence_tasa_objecto</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     73001 73024 73026 73030 73043 73055 73067 73124 73148 73152 73168 73200
[1,]     7     0     0     0     0     0     0     0     0     0     2     0
[2,]    20     0     0     0     0     0     0     1     2     0     2     3
[3,]    17     0     1     1     0     0     0     0     2     0     3     0
[4,]    15     0     0     0     0     0     1     0     2     0     3     0
[5,]    18     0     0     0     0     0     0     0     4     0     8     0
[6,]    25     0     0     0     0     1     1     0     2     0     5     0
     73217 73226 73236 73268 73270 73275 73283 73319 73347 73349 73352 73408
[1,]     0     0     0     5     0     0     0     5     0     0     0     0
[2,]     1     0     0    10     0     2     2     6     0     1     0     1
[3,]     1     1     0    20     0     3     0     3     0     5     0     5
[4,]     0     0     0    16     0     4     0     2     0     1     0     3
[5,]     0     1     0    18     0     4     0     3     0     0     0     2
[6,]     0     0     0    12     0     1     0     4     0     2     0     5
     73411 73443 73449 73461 73483 73504 73520 73547 73555 73563 73585 73616
[1,]     0     1     1     0     0     1     0     0     0     0     0     0
[2,]     0     1     2     0     0     0     0     1     0     0     0     0
[3,]     0     1     1     0     1     0     0     0     0     0     0     0
[4,]     1     1     3     0     0     0     0     9     0     2     0     0
[5,]     0     1     2     0     2     2     0     0     0     0     0     0
[6,]     1     1     1     0     0     0     0     0     0     0     0     1
     73622 73624 73671 73675 73678 73686 73770 73854 73861 73870 73873
[1,]     0     0     0     0     0     0     0     0     0     0     0
[2,]     0     2     0     0     0     0     1     1     0     0     0
[3,]     0     1     0     1     0     0     0     0     4     0     0
[4,]     0     0     0     1     0     0     0     0     6     0     0
[5,]     0     0     2     0     0     0     0     0     1     0     0
[6,]     0     0     1     0     0     0     0     0     1     0     0</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="estimación-del-riesgo-etario">6. Estimación del riesgo etario<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-riesgo-etario"></a>
</h3>
<p>La normalización de los datos es un aspecto clave de la
epidemiología. <strong>epiCo</strong> utiliza la distribución por edades
de los casos y normaliza los datos epidemiológicos con la estructura de
edades de una población a tarvés de la función <code>age_risk</code>.
Esta normalización nos permite estimar el riesgo por edad de sufrir una
enfermedad según la estructura de edad de la población general de un
municipio, departamento o país en un año determinado.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Se filtran los datos del SIVIGILA para el año 2021.</span></span>
<span><span class="va">data_tolima_2021</span> <span class="op">&lt;-</span>  <span class="va">epi_data</span><span class="op">[</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu">year</span><span class="op">(</span><span class="va">epi_data</span><span class="op">$</span><span class="va">fec_not</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2021</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Se calcula las tasas por edades para el año 2021.</span></span>
<span><span class="va">incidence_rate_2019</span> <span class="op">&lt;-</span> <span class="fu">age_risk</span><span class="op">(</span>age <span class="op">=</span> <span class="fu">as.integer</span><span class="op">(</span><span class="va">data_tolima_2021</span><span class="op">$</span><span class="va">edad</span><span class="op">)</span>,</span>
<span>                                population_pyramid <span class="op">=</span> <span class="va">tolima_piramide_2021</span>,</span>
<span>                                sex <span class="op">=</span> <span class="va">data_tolima_2021</span><span class="op">$</span><span class="va">sexo</span>,</span>
<span>                                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/epiCo-tutorial-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
<div class="section level2">
<h2 id="construir-un-canal-endémico-con-epico">Construir un canal endémico con <strong>epiCo</strong>
<a class="anchor" aria-label="anchor" href="#construir-un-canal-end%C3%A9mico-con-epico"></a>
</h2>
<p>El módulo de canal endémico de <strong>epiCo</strong> es una
herramienta que permite estimar una línea de tendencia central y los
límites superior e inferior del número esperado de casos de una
enfermedad a partir de los datos históricos proporcionados por el
usuario y un conjunto de parámetros personalizados.</p>
<p>En el siguiente tutorial, los usuarios aprenderán:</p>
<ol style="list-style-type: decimal">
<li>Qué es un canal endémico y cuáles son sus ventajas, inconvenientes y
precauciones.</li>
<li>Un ejemplo de los datos históricos necesarios para construir un
canal endémico.</li>
<li>Cómo utilizar la función <code>endemic_channel</code>.</li>
</ol>
<div class="section level3">
<h3 id="qué-es-un-canal-endémico">1. ¿Qué es un canal endémico?<a class="anchor" aria-label="anchor" href="#qu%C3%A9-es-un-canal-end%C3%A9mico"></a>
</h3>
<p>El uso de un canal endémico es una estrategia visual para representar
el comportamiento histórico de una enfermedad en una región específica
en una curva epidémica que define la tendencia central de los casos
durante un año y los límites superior e inferior donde se espera que
varíen los casos. Este gráfico proporciona tres zonas denominadas “<span class="math inline">\(\color{green}{\text{Safety -
Seguridad}}\)</span>”, “<span class="math inline">\(\color{yellow}{\text{Warning -  Alerta}}\)</span>”
y “<span class="math inline">\(\color{red}{\text{Epidemic -
Epidemia}}\)</span>”, que posteriormente se utilizan para definir la
situación epidemiológica de la región en función de los casos
actuales.</p>
<p>La definición más amplia y la metodología para el canal endémico
fueron proporcionadas por <a href="https://iris.paho.org/handle/10665.2/8562" class="external-link">Bormant (1999)</a>.</p>
<p>Los datos necesarios para construir un canal endémico son la
incidencia semanal o mensual de la enfermedad durante los años
anteriores en la región de interés. <strong>epiCo</strong> pide al menos
un año de datos, pero los canales endémicos suelen tener entre <em>5 y 7
años de información</em>. Es natural suponer que más años proporcionan
mejores estimaciones ya que los análisis estadísticos serán más
robustos, pero es importante disponer de información contextual para
asegurar que las condiciones de transmisión, vigilancia o demográficas
(entre otros factores) no han cambiado durante este periodo de tiempo.
En cuanto a la frecuencia de los datos, la incidencia semanal puede
proporcionar información más útil sobre el comportamiento de la
enfermedad y el momento en que se debe plantear una alerta
epidemiológica; sin embargo, depende de la experiencia de los usuarios y
de su contexto que se pueda lograr esta resolución de los datos. Otra
decisión común mientras se construye un canal endémico es ignorar los
años epidémicos anteriores para evitar tergiversar la dinámica de
transmisión tradicional. <strong>epiCo</strong> no sugiere años
epidémicos automáticamente, pero su función <code>endemic_channel</code>
ofrece la opción de anotar los años atípicos y decidir si incluirlos,
ignorarlos o ajustarlos. Más adelante en esta viñeta se ofrecen más
consejos y fuentes para la recopilación de datos.</p>
</div>
<div class="section level3">
<h3 id="datos-históricos-necesarios-para-construir-un-canal-endémico">2. Datos históricos necesarios para construir un canal endémico<a class="anchor" aria-label="anchor" href="#datos-hist%C3%B3ricos-necesarios-para-construir-un-canal-end%C3%A9mico"></a>
</h3>
<p>En esta sección se presentan algunas estrategias para obtener,
manejar y recopilar los datos históricos necesarios para construir un
canal endémico. Se asume que el usuario cuenta con los datos de
incidencia de la enfermedad de interés o tiene la posibilidad de
consultar datos históricos del SIVIGILA.</p>
<p>Independientemente del caso del usuario, el objetivo de esta sección
es crear un objeto <code>incidence</code> con datos históricos de la
enfermedad. Este objeto debe dar cuenta de la incidencia de una sola
región (no se permiten grupos en la función
<code>endemic_channel</code>), debe tener un intervalo semanal o mensual
(también se permiten semanas epidemiológicas) y debe representar al
menos un año de información.</p>
<p>Para comprender mejor el paquete de <code>incidence</code>, consulte
sus <a href="https://www.repidemicsconsortium.org/incidence/" class="external-link">viñetas</a>.</p>
<div class="section level4">
<h4 id="incidencia-histórica-a-partir-de-los-datos-propios-o-de-los-datos-sivigila">Incidencia histórica a partir de los datos propios o de los datos
SIVIGILA<a class="anchor" aria-label="anchor" href="#incidencia-hist%C3%B3rica-a-partir-de-los-datos-propios-o-de-los-datos-sivigila"></a>
</h4>
<p>El canal endémico es más útil cuando se dispone de datos hasta el año
inmediatamente anterior; sin embargo, esto no siempre es posible para
los usuarios ajenos a las instituciones de vigilancia. Como opción, los
usuarios pueden acceder a los datos del SIVIGILA que normalmente se
hacen públicos hasta el segundo semestre del año (es decir, los datos de
2022 se publicaron en el segundo semestre de 2023). Para este ejemplo se
utilizarán los datos suministrados en la carpeta de datos del paquete.
Estos datos presentan los casos de dengue para todos los municipios del
Tolima para los años 2012 a 2021. En este caso, utilizaremos los casos
del municipio de Espinal para calcular el respectivo canal endémico.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Se cargan las librerías necesarias.</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiCo</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Se cargan los datos epidemiológicos del paquete.</span></span>
<span><span class="fu">data</span><span class="op">(</span><span class="st">"epi_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_espinal</span> <span class="op">&lt;-</span> <span class="va">epi_data</span><span class="op">[</span><span class="va">epi_data</span><span class="op">$</span><span class="va">cod_mun_o</span> <span class="op">==</span> <span class="fl">73268</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Se construyen el objeto incidence para el municipio del Espinal.</span></span>
<span><span class="va">incidencia_espinal</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="op">(</span><span class="va">data_espinal</span><span class="op">$</span><span class="va">fec_not</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"1 epiweek"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Se filtra el objeto incidence para obtener el historico de los 7 años </span></span>
<span><span class="co"># anteriores al año de interes. En este caso el 2021.</span></span>
<span><span class="va">incidencia_historica</span> <span class="op">&lt;-</span> <span class="va">incidencia_espinal</span><span class="op">[</span></span>
<span>  <span class="va">incidencia_espinal</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;=</span> <span class="fu">as.Date</span><span class="op">(</span><span class="st">"2020-12-31"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>    <span class="va">incidencia_espinal</span><span class="op">$</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="fu">as.Date</span><span class="op">(</span><span class="st">"2014-01-01"</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">incidencia_historica</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;incidence object&gt;
[4808 cases from days 2014-01-05 to 2020-12-27]
[4808 cases from MMWR weeks 2014-W02 to 2020-W53]

$counts: matrix with 365 rows and 1 columns
$n: 4808 cases in total
$dates: 365 dates marking the left-side of bins
$interval: 1 week
$timespan: 2549 days
$cumulative: FALSE</code></pre>
</div>
<p>Cuando los usuarios tienen sus propios datos, el objetivo es el
mismo: limpiar y manejar los datos para construir el objeto
<code>incidence</code> (llamado <code>incidencia_histórica</code> en el
ejemplo anterior). El mensaje clave es que se necesita una lista de
fechas que den cuenta del evento de interés para luego utilizarla en el
paquete <a href="https://www.repidemicsconsortium.org/incidence/" class="external-link"><code>incidence</code></a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="uso-de-la-función-canal_endémico-de-epico">3. Uso de la función canal_endémico de <strong>epico</strong>
<a class="anchor" aria-label="anchor" href="#uso-de-la-funci%C3%B3n-canal_end%C3%A9mico-de-epico"></a>
</h3>
<p>Tras recopilar los datos de incidencia, los usuarios están listos
para pedir a <strong>epiCo</strong> que construya un canal endémico.</p>
<p>La función <code>endemic_channel</code> tiene los siguientes
parámetros:</p>
<ul>
<li><p><code>incidence_historic</code>: Un objeto de incidencia con los
recuentos de casos de los años anteriores.</p></li>
<li><p><code>observations</code>: Un vector numérico con las
observaciones actuales <em>(por defecto = NULL)</em>.</p></li>
<li><p><code>method</code>: Una cadena con el método de cálculo de la
media de preferencia (“<code>median</code>”, “<code>mean</code>” o
“<code>geometric</code>”) o método “<code>unusual_behavior</code>”
(Prueba de distribución de Poisson) <em>(por defecto =
“geométrica”)</em>.</p></li>
<li><p><code>geom_method</code>: Una cadena con el método seleccionado
para el cálculo de la media geométrica (véase la función
<code>geom_mean</code> de <strong>epiCo</strong>) <em>(por defecto =
“shifted”)</em>.</p></li>
<li><p><code>outlier_years</code>: Un vector numérico con los años
atípicos (epidémicos) <em>(por defecto = NULL)</em>.</p></li>
<li>
<p><code>outliers_handling</code>: Una cadena con la decisión de
tratamiento de los años atípicos:</p>
<ul>
<li>ignored = los datos de los años atípicos no se tendrán en cuenta
<em>(por defecto)</em>.</li>
<li>included = se tendrán en cuenta los datos de los años atípicos.</li>
<li>replaced_by_median = los datos de los años atípicos se sustituirán
por la mediana y se tendrán en cuenta.</li>
<li>replaced_by_mean = los datos de los años atípicos se sustituirán por
la media y se tendrán en cuenta.</li>
<li>replaced_by_geom_mean = los datos de los años atípicos se
sustituirán por la media geométrica y se tendrán en cuenta.</li>
</ul>
</li>
<li><p><code>ci</code>: Un valor numérico para especificar el intervalo
de confianza a utilizar con el método geométrico <em>(por defecto =
0.95)</em>.</p></li>
<li><p><code>plot</code>: Un booleano para mostrar un gráfico <em>(por
defecto = FALSE)</em>.</p></li>
</ul>
<p>La salida de la función <code>endemic_channel</code> de
<strong>epiCo</strong> es una tabla de datos con las observaciones, la
media histórica y los intervalos de confianza, y un gráfico que muestra
las tres bandas epidemiológicas, las observaciones actuales (si se
proporcionan) y los métodos y el manejo de valores atípicos establecidos
por el usuario.</p>
<div class="section level4">
<h4 id="ejemplo">Ejemplo<a class="anchor" aria-label="anchor" href="#ejemplo"></a>
</h4>
<p>El siguiente ejemplo utiliza la incidencia histórica a la que se ha
accedido previamente desde la fuente de datos SIVIGILA para construir el
canal endémico 2021 para el municipio del Espinal.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Se toman el conteo de casos del 2020 como las observaciones.</span></span>
<span><span class="va">observaciones</span> <span class="op">&lt;-</span> <span class="va">incidencia_espinal</span><span class="op">[</span></span>
<span>  <span class="va">incidencia_espinal</span><span class="op">$</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="fu">as.Date</span><span class="op">(</span><span class="st">"2021-01-01"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>    <span class="va">incidencia_espinal</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;=</span> <span class="fu">as.Date</span><span class="op">(</span><span class="st">"2021-12-31"</span><span class="op">)</span>, <span class="op">]</span><span class="op">$</span><span class="va">counts</span></span>
<span></span>
<span><span class="co"># Se especifican los años hiper endemicos que deben ser ignorados en la </span></span>
<span><span class="co"># constucción del canal endémico.</span></span>
<span><span class="va">años_atipicos</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">2019</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Se construye el canal endémico y se plotea el resultado.</span></span>
<span><span class="va">espinal_endemic_chanel</span> <span class="op">&lt;-</span> <span class="fu">endemic_channel</span><span class="op">(</span></span>
<span>  incidence_historic <span class="op">=</span> <span class="va">incidencia_historica</span>,</span>
<span>  observations <span class="op">=</span> <span class="va">observaciones</span>,</span>
<span>  outlier_years <span class="op">=</span> <span class="va">años_atipicos</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Data prior to 2015-01-04 were not used for the endemic channel calculation.</code></pre>
</div>
<figure><img src="fig/epiCo-tutorial-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
<div class="section level2">
<h2 id="análisis-espaciotemporales-con-epico">Análisis espaciotemporales con <strong>epico</strong>
<a class="anchor" aria-label="anchor" href="#an%C3%A1lisis-espaciotemporales-con-epico"></a>
</h2>
<p>El módulo <em>espaciotemporal</em> de <strong>epico</strong> es una
herramienta que permite analizar la correlación espacial de los casos a
partir de sus coordenadas de notificación y los tiempos reales de
desplazamiento dentro del territorio colombiano.</p>
<p>En el siguiente tutorial aprenderás:</p>
<ol style="list-style-type: decimal">
<li>A utilizar la función <code>morans_index</code> de
<strong>epico</strong>.</li>
<li>Cómo interpretar y comunicar los resultados.</li>
</ol>
<div class="section level3">
<h3 id="la-función-morans_index-de-epico">1. La función <code>morans_index</code> de
<strong>epico</strong>
<a class="anchor" aria-label="anchor" href="#la-funci%C3%B3n-morans_index-de-epico"></a>
</h3>
<p><strong>epiCo</strong> proporciona una función para realizar un
análisis del <a href="https://r-spatial.github.io/spdep/reference/moran.plot.html" class="external-link">índice
de Moran Local</a> a partir de un objeto <code>incidence</code> con
observaciones únicas para un conjunto de municipios colombianos.</p>
<p>Internamente, la función lee los grupos del objeto
<code>incidence</code> como los códigos DIVIPOLA para:</p>
<ol style="list-style-type: decimal">
<li>Estimar las tasas de incidencia utilizando la función
<code>incidence_rate</code> de <strong>epico</strong>.</li>
<li>Evaluarlas en la función <code>neighborhoods</code> de
<strong>epico</strong>.</li>
</ol>
<p>Es necesario que el usuario proporcione el nivel administrativo al
que corresponden los grupos (0: nivel nacional, 1: nivel departamental,
2: nivel municipal), la escala a la que se deben estimar las tasas de
incidencia (casos por número de habitantes) y el umbral de tiempo de
viaje para la definición del barrio. En el siguiente ejemplo se utilizan
los casos de los municipios del Tolima para el año 2021.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Se cargan las librerías necesarias.</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiCo</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">data</span><span class="op">(</span><span class="st">"epi_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Se filtran los datos epidemiológicos para el año de interés.</span></span>
<span><span class="va">data_tolima</span> <span class="op">&lt;-</span> <span class="va">epi_data</span><span class="op">[</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu">year</span><span class="op">(</span><span class="va">epi_data</span><span class="op">$</span><span class="va">fec_not</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2021</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Se crea el objeto incidence para los datos del tolima en el 2021.</span></span>
<span><span class="va">incidence_object</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="op">(</span></span>
<span>  dates <span class="op">=</span> <span class="va">data_tolima</span><span class="op">$</span><span class="va">fec_not</span>,</span>
<span>  groups <span class="op">=</span> <span class="va">data_tolima</span><span class="op">$</span><span class="va">cod_mun_o</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"12 months"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Se realiza el analisis espaciotemporal, especificando la escala de nivel </span></span>
<span><span class="co"># municipal</span></span>
<span><span class="va">monrans_tolima</span> <span class="op">&lt;-</span> <span class="fu">morans_index</span><span class="op">(</span>incidence_object <span class="op">=</span> <span class="va">incidence_object</span>, threshold <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Significant municipalities are:</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>73043 with Low-High (incidence - spatial correlation)
73168 with Low-High (incidence - spatial correlation)
73483 with High-Low (incidence - spatial correlation)
73504 with Low-Low (incidence - spatial correlation)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">monrans_tolima</span><span class="op">$</span><span class="va">plot</span></span></code></pre>
</div>
<!--html_preserve-->
<div id="htmlwidget-8267d70070d4f4991be8" class="leaflet html-widget html-fill-item" style="width:504px;height:504px;">

</div>
<script type="application/json" data-for="htmlwidget-8267d70070d4f4991be8">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addPolygons","args":[[[[{"lng":[-75.07433696899994,-75.05260273799991,-75.05423334999995,-75.06424288599993,-75.06049028899992,-75.05203682399991,-75.04296593599992,-75.0618734329999,-75.06966962399991,-75.0660735589999,-75.04843136799991,-75.02870730099994,-75.00581242399994,-74.99299057899992,-74.99558851299992,-74.98263218999995,-74.96570980399991,-74.96990852399995,-74.9820396049999,-74.98630937999991,-74.99967247399991,-75.00631178599991,-75.02694786399991,-75.03458752899991,-75.02929164699992,-75.07483450699993,-75.08578002699994,-75.08856399699994,-75.10380444399993,-75.11520206299991,-75.12574307499995,-75.13967481799995,-75.14831226199993,-75.17909995999992,-75.18827790499995,-75.22578764799994,-75.23505019099991,-75.24032298599991,-75.2555420189999,-75.2812830279999,-75.30072718999992,-75.31350363199994,-75.33999878399993,-75.35695162499991,-75.37638703399995,-75.40407148699995,-75.41949332399992,-75.42730683299993,-75.45004465199992,-75.46495141199995,-75.49923904499991,-75.51313135799995,-75.51988910799992,-75.51095459199991,-75.49988272399992,-75.49179451299995,-75.48430222899992,-75.47105780699991,-75.46187571699994,-75.4404547879999,-75.42986590299995,-75.4143892109999,-75.40813171099995,-75.3940061209999,-75.37719011799993,-75.37446724699993,-75.36691484099993,-75.36998434599991,-75.38856793499991,-75.40021226699992,-75.40935252799994,-75.40653286599991,-75.41162491099993,-75.43148473999992,-75.4539706459999,-75.46868761299993,-75.47120984199995,-75.48371390599993,-75.48025179399991,-75.48459277499995,-75.47211429399994,-75.46887076199994,-75.45820601799994,-75.4358557409999,-75.42100092699991,-75.41548800899994,-75.42197705599995,-75.42151430599995,-75.41592577899991,-75.40088142899992,-75.38620343199995,-75.38335373599995,-75.36643108299995,-75.34631937799992,-75.32661906099992,-75.29977873899992,-75.29611436999994,-75.28328907499991,-75.28961962999995,-75.26016666299995,-75.24793147399993,-75.22623534899992,-75.21619422299995,-75.20256085999995,-75.18412860699993,-75.15396918899995,-75.14916489299992,-75.13180864799995,-75.12805467699991,-75.10912665599994,-75.08333381099993,-75.07433696899994],"lat":[4.567864869000061,4.542246639000041,4.522628226000052,4.507471991000045,4.476825818000066,4.472162433000051,4.450304411000047,4.436214878000044,4.435961463000069,4.40568339500004,4.403352020000057,4.395673822000049,4.396259999000051,4.388981264000051,4.356019877000051,4.354886115000056,4.360774369000069,4.345742943000062,4.334483907000049,4.313063962000058,4.308229906000065,4.324431115000039,4.32489077200006,4.284901713000068,4.279496809000079,4.284309388000054,4.290400809000062,4.301108381000063,4.306331298000089,4.319680076000054,4.317657531000066,4.325176628000065,4.321393285000056,4.314686080000058,4.300426949000041,4.293326240000056,4.312246453000057,4.333194386000059,4.344730014000049,4.347099954000043,4.339764076000051,4.346542042000067,4.329730282000071,4.307262804000061,4.311163967000084,4.291657118000046,4.294173189000048,4.289264657000047,4.293372213000055,4.283062043000086,4.281820767000056,4.258930970000051,4.256456689000061,4.289888648000044,4.313740800000062,4.321136137000053,4.337530531000084,4.341512014000045,4.350918482000054,4.353967083000043,4.365301393000038,4.366242887000055,4.374472808000064,4.379875112000093,4.401417364000054,4.421350260000054,4.42257806300006,4.444747500000062,4.455038671000068,4.470425921000071,4.494204600000046,4.507612861000041,4.52348386400007,4.528785719000041,4.52278947800005,4.531296049000048,4.54087338000005,4.554222156000037,4.568724971000051,4.581883474000051,4.588236957000049,4.598322771000085,4.602120390000039,4.602948444000049,4.610864252000056,4.622404506000066,4.643465899000091,4.658615797000039,4.670899642000052,4.690424282000038,4.700691309000092,4.68896660200005,4.676127829000052,4.669080072000042,4.657926536000048,4.637034869000047,4.625542069000062,4.613383024000086,4.572748574000059,4.557772244000091,4.563183138000056,4.557336784000086,4.534258410000064,4.53214065800006,4.542353337000065,4.536733051000056,4.542139927000051,4.541075427000067,4.547989051000059,4.560932821000051,4.561108853000064,4.567864869000061]}]],[[{"lng":[-74.8625876829999,-74.87836344699991,-74.89570376899991,-74.93475072599995,-74.95393869899993,-74.9790228999999,-74.99523892499991,-75.00752884199994,-75.01528587999991,-75.02927171599993,-75.04296593599992,-75.05203682399991,-75.06049028899992,-75.06424288599993,-75.05423334999995,-75.05260273799991,-75.07433696899994,-75.06245124299994,-75.0473132919999,-75.02611229399992,-75.04322061999994,-75.04299457099995,-75.04916926999994,-75.01828650199991,-75.01703720599994,-75.01428892899992,-74.97234378999991,-74.95828117399992,-74.95491285399993,-74.94497999099991,-74.94290847299993,-74.92539563999992,-74.90882645799991,-74.8923568219999,-74.8885020969999,-74.8625876829999],"lat":[4.625193792000061,4.608424830000047,4.575150447000055,4.534918519000087,4.524796295000044,4.486491392000062,4.474094403000038,4.472452572000066,4.460531474000049,4.45037872100005,4.450304411000047,4.472162433000051,4.476825818000066,4.507471991000045,4.522628226000052,4.542246639000041,4.567864869000061,4.582911550000063,4.61562211100005,4.641843768000058,4.63989261100005,4.652575141000057,4.662009700000056,4.680097629000045,4.688760398000056,4.693447936000041,4.702868222000063,4.692931596000051,4.674496628000043,4.671445059000064,4.661385801000051,4.640268081000045,4.634311191000052,4.637008218000062,4.629215487000067,4.625193792000061]}]],[[{"lng":[-74.76919328999992,-74.7660847059999,-74.74913082799992,-74.74305798299991,-74.7686459009999,-74.7769437149999,-74.79449342299995,-74.81450326699991,-74.8191027279999,-74.8157831229999,-74.83175417899992,-74.86509042699993,-74.88419479899994,-74.88453785399992,-74.87175736599994,-74.87681148799993,-74.87159944299992,-74.87346414699994,-74.8694182719999,-74.85481449999992,-74.83939160599994,-74.83807884499993,-74.81785995099995,-74.80561405299994,-74.81185181199993,-74.80743961799993,-74.80968157599995,-74.8297358399999,-74.82933273599991,-74.8202636769999,-74.79961289999994,-74.78733791799993,-74.78248932399993,-74.76771578699993,-74.75459037199994,-74.7489830159999,-74.73354576199995,-74.73219305399994,-74.73991338399992,-74.73166516299995,-74.73704300599991,-74.75492513899991,-74.75205475999991,-74.76919328999992],"lat":[4.842121084000041,4.835601943000086,4.829701113000056,4.790287477000049,4.77500759600008,4.752116483000066,4.74760959200006,4.735744018000048,4.725983842000062,4.713573549000046,4.727824640000051,4.712562779000052,4.719650345000048,4.734277595000037,4.74438761600004,4.75544609700006,4.774252683000043,4.789673177000054,4.819239146000086,4.823783651000042,4.835499908000088,4.852662158000044,4.866166045000057,4.870301944000062,4.886811436000073,4.899157463000051,4.913754330000074,4.909776072000057,4.929124091000062,4.93368971600006,4.929417564000062,4.930487380000045,4.938965371000052,4.943188110000051,4.938088977000064,4.951860410000052,4.934604408000041,4.926851086000056,4.902040450000072,4.893990191000057,4.883861381000088,4.885939931000053,4.865847277000057,4.842121084000041]}]],[[{"lng":[-75.05048053299993,-75.03326275199993,-75.01703720599994,-75.01828650199991,-75.04916926999994,-75.04299457099995,-75.04322061999994,-75.02611229399992,-75.0473132919999,-75.06245124299994,-75.07433696899994,-75.08333381099993,-75.10912665599994,-75.12805467699991,-75.13180864799995,-75.14916489299992,-75.15396918899995,-75.18412860699993,-75.20256085999995,-75.21619422299995,-75.22623534899992,-75.24793147399993,-75.26016666299995,-75.28961962999995,-75.28328907499991,-75.29611436999994,-75.29977873899992,-75.32661906099992,-75.34631937799992,-75.36643108299995,-75.38335373599995,-75.38620343199995,-75.3835074669999,-75.36383341199991,-75.35470085599991,-75.32519191799992,-75.30360964099992,-75.2856601119999,-75.27623967699992,-75.25466902199992,-75.24134124699992,-75.20929302899992,-75.18782942699994,-75.15731912399991,-75.14860597199993,-75.13072194499995,-75.11322533299995,-75.09605751999993,-75.08184024199994,-75.07350066699991,-75.05048053299993],"lat":[4.696241422000071,4.701362025000037,4.688760398000056,4.680097629000045,4.662009700000056,4.652575141000057,4.63989261100005,4.641843768000058,4.61562211100005,4.582911550000063,4.567864869000061,4.561108853000064,4.560932821000051,4.547989051000059,4.541075427000067,4.542139927000051,4.536733051000056,4.542353337000065,4.53214065800006,4.534258410000064,4.557336784000086,4.563183138000056,4.557772244000091,4.572748574000059,4.613383024000086,4.625542069000062,4.637034869000047,4.657926536000048,4.669080072000042,4.676127829000052,4.68896660200005,4.700691309000092,4.708344679000049,4.708051212000044,4.701320458000055,4.701825504000055,4.710440173000052,4.709689428000047,4.716018782000049,4.706076479000046,4.711736767000048,4.713984827000047,4.711776911000072,4.683126630000061,4.672007979000057,4.663803599000062,4.667505468000058,4.657131016000051,4.660545545000048,4.684362142000055,4.696241422000071]}]],[[{"lng":[-74.88435851199995,-74.85090654099992,-74.84597753199995,-74.81553981699994,-74.80075723199991,-74.78470042299995,-74.77192664199993,-74.77194449599995,-74.76218443699992,-74.75162802199992,-74.7354119929999,-74.72971531999991,-74.72589762299992,-74.73016743499994,-74.74318211399992,-74.73110465399992,-74.72120573399991,-74.70606054599995,-74.71472739099994,-74.72775943499994,-74.74387368899994,-74.7489830159999,-74.75459037199994,-74.76771578699993,-74.78248932399993,-74.78733791799993,-74.79961289999994,-74.8202636769999,-74.82933273599991,-74.8297358399999,-74.80968157599995,-74.80743961799993,-74.81185181199993,-74.81958981899993,-74.8641856779999,-74.87038654899993,-74.90614913999991,-74.91708710199993,-74.94570645199991,-74.97395713599991,-74.98352639699993,-74.99871404299995,-75.0160922689999,-75.00869387699993,-75.00012525299991,-74.9832968149999,-74.97197002099995,-74.95557418899995,-74.89125987199992,-74.89748366499992,-74.8878870069999,-74.88868907199992,-74.90236131799992,-74.9047736629999,-74.90036718599993,-74.88435851199995],"lat":[5.146773978000056,5.119664327000066,5.101531050000062,5.093329377000089,5.092993991000071,5.100811529000055,5.099666739000043,5.061438550000048,5.039881398000091,5.048022786000047,5.052746013000046,5.068119947000071,5.058422866000058,5.036458680000067,5.008223972000053,4.996768443000065,4.994855733000065,4.98300490400004,4.972211572000049,4.977078927000093,4.966350438000063,4.951860410000052,4.938088977000064,4.943188110000051,4.938965371000052,4.930487380000045,4.929417564000062,4.93368971600006,4.929124091000062,4.909776072000057,4.913754330000074,4.899157463000051,4.886811436000073,4.891218198000047,4.891744060000065,4.88727543400006,4.952736229000038,4.963466058000051,4.958535100000063,4.967151125000044,4.974952465000058,4.979218281000044,4.996283765000044,5.008908750000046,5.008134408000046,5.024351792000061,5.012598347000051,5.019658317000051,5.038476968000055,5.063240242000063,5.072050405000084,5.086203302000058,5.096473650000064,5.110116205000054,5.142293881000057,5.146773978000056]}]],[[{"lng":[-75.23712721999993,-75.24807755699993,-75.24685926799992,-75.26661831699994,-75.28953728599993,-75.29003221399995,-75.27507016299995,-75.2670751739999,-75.25616343099995,-75.25649545499994,-75.26736387999995,-75.27940096099991,-75.30245463299991,-75.28615532499992,-75.27714906599994,-75.27651850899991,-75.26824255899993,-75.27723903899994,-75.30162634099992,-75.31225595599994,-75.3212492429999,-75.32962072099991,-75.34155972899993,-75.3664591939999,-75.37145192799994,-75.37978413299993,-75.3962151209999,-75.4128538569999,-75.42595279099993,-75.43955854799992,-75.44486950499993,-75.46337219199995,-75.4788044259999,-75.48657683799991,-75.48598633299991,-75.49647757799994,-75.51048276799992,-75.52760403299993,-75.52177531899991,-75.53029007599991,-75.54247926699992,-75.55014261299993,-75.56843631299995,-75.57751119199992,-75.59524675599994,-75.60735821299994,-75.60299904099992,-75.60730110599991,-75.61272627699992,-75.61106303299994,-75.62932539799993,-75.64991963299991,-75.66132676899991,-75.6711206299999,-75.68809570399992,-75.69784673699991,-75.7029578179999,-75.73926768699994,-75.72437105199992,-75.71723266899994,-75.71019422299992,-75.69741651899994,-75.6886363079999,-75.68550969599994,-75.67361714999993,-75.67354100599994,-75.65237332099991,-75.6389531609999,-75.6149063279999,-75.60194302499991,-75.5790430909999,-75.5791645779999,-75.54386963299993,-75.5173028019999,-75.49545711999991,-75.48569442199994,-75.47210400899991,-75.46015161899993,-75.45376306999992,-75.43060304199992,-75.42610385699993,-75.41689058399993,-75.42052351799992,-75.39434485299995,-75.36547107199993,-75.36606090299995,-75.35847005399995,-75.3525557509999,-75.3404432559999,-75.32343411599993,-75.3259037979999,-75.3178708399999,-75.30985842599995,-75.29251160899992,-75.28778372399995,-75.27065732299991,-75.26325360099992,-75.23712721999993],"lat":[3.600571655000067,3.590487483000061,3.568881976000057,3.573983543000054,3.562390805000064,3.544687619000058,3.530829638000057,3.514858693000065,3.50705954600005,3.492974092000054,3.478747597000051,3.471530121000058,3.45054622300006,3.436852423000062,3.421385929000053,3.39881673800005,3.382105910000064,3.382816536000064,3.399169482000048,3.414321923000045,3.41823603000006,3.401754887000038,3.40540855100005,3.406583221000062,3.387093348000064,3.375377206000053,3.377380975000051,3.371660513000052,3.352793766000048,3.34741856100004,3.356841229000054,3.354449871000043,3.361144245000048,3.345674299000052,3.332018770000047,3.322007199000041,3.328129908000051,3.317560751000087,3.302114588000052,3.286427332000073,3.275979115000041,3.256712278000066,3.241877529000078,3.221496979000051,3.207789415000093,3.220814585000085,3.245960728000057,3.266309879000062,3.266995163000047,3.298765728000092,3.292146066000043,3.291218077000053,3.279922775000045,3.28289234500005,3.279808562000085,3.286061786000062,3.315471925000054,3.322356109000054,3.348709826000061,3.376506688000063,3.381946137000057,3.421278627000049,3.42964481100006,3.443593212000053,3.452816002000077,3.463114311000083,3.465817377000064,3.459250065000049,3.457298908000041,3.452273489000049,3.453287138000064,3.46360934900008,3.463285742000039,3.474360269000044,3.477919429000053,3.484613937000063,3.484959459000038,3.473338966000085,3.484511467000061,3.511159251000038,3.52900930900006,3.536471299000084,3.559371261000081,3.594806468000058,3.610985271000061,3.62568026200006,3.639225942000053,3.661853328000063,3.659365702000059,3.663748177000059,3.644023349000065,3.620463776000065,3.611347089000049,3.610449368000047,3.602658346000055,3.601320609000084,3.592109356000037,3.600571655000067]}]],[[{"lng":[-75.51988910799992,-75.55212231399992,-75.57012325999995,-75.57783841999992,-75.59718790999995,-75.60425101699991,-75.59307108199994,-75.60032272399991,-75.59307444899991,-75.5922495289999,-75.59044438099994,-75.58296266999992,-75.57907098499993,-75.58270531499994,-75.57594852499994,-75.57753899699992,-75.55567234499995,-75.53560849699994,-75.52452742899993,-75.52768911099992,-75.52201415199994,-75.52432663399992,-75.51503550399991,-75.49012838899995,-75.48459277499995,-75.48025179399991,-75.48371390599993,-75.47120984199995,-75.46868761299993,-75.4539706459999,-75.43148473999992,-75.41162491099993,-75.40653286599991,-75.40935252799994,-75.40021226699992,-75.38856793499991,-75.36998434599991,-75.36691484099993,-75.37446724699993,-75.37719011799993,-75.3940061209999,-75.40813171099995,-75.4143892109999,-75.42986590299995,-75.4404547879999,-75.46187571699994,-75.47105780699991,-75.48430222899992,-75.49179451299995,-75.49988272399992,-75.51095459199991,-75.51988910799992],"lat":[4.256456689000061,4.23760825700009,4.239021687000047,4.245966834000058,4.279399497000043,4.288790945000073,4.31862114900008,4.333856859000093,4.348423539000066,4.361590515000046,4.377206952000051,4.38650595900009,4.409345206000069,4.42420050700008,4.443644753000058,4.452224346000094,4.472134469000082,4.494701545000055,4.498395314000049,4.51386236500008,4.527248456000052,4.539509899000052,4.555587389000038,4.569744127000092,4.581883474000051,4.568724971000051,4.554222156000037,4.54087338000005,4.531296049000048,4.52278947800005,4.528785719000041,4.52348386400007,4.507612861000041,4.494204600000046,4.470425921000071,4.455038671000068,4.444747500000062,4.42257806300006,4.421350260000054,4.401417364000054,4.379875112000093,4.374472808000064,4.366242887000055,4.365301393000038,4.353967083000043,4.350918482000054,4.341512014000045,4.337530531000084,4.321136137000053,4.313740800000062,4.289888648000044,4.256456689000061]}]],[[{"lng":[-74.74508188999994,-74.74612995099994,-74.7196394099999,-74.71145406599993,-74.69073122599991,-74.67125363399992,-74.68891319199992,-74.6922087449999,-74.68459946999991,-74.6928419219999,-74.70416815699991,-74.71479006999994,-74.73561511299994,-74.74415261999991,-74.7805689029999,-74.79865424099995,-74.79843436899995,-74.79396391499995,-74.79615143099994,-74.78497843199995,-74.78479668499995,-74.78995760399994,-74.77711734699994,-74.76678893999991,-74.74476457899993,-74.74508188999994],"lat":[4.236351312000068,4.202959380000038,4.190326823000078,4.174087,4.169328490000055,4.150786366000091,4.123066097000049,4.101627151000059,4.095460091000064,4.087331850000055,4.085847070000057,4.07421626200005,4.063632425000094,4.046173125000053,4.013972167000077,4.026259159000062,4.05601609900009,4.075353643000085,4.09994395800004,4.136985199000094,4.153333271000065,4.17552508700004,4.199677076000057,4.228791206000039,4.247759847000054,4.236351312000068]}]],[[{"lng":[-75.04421772099994,-75.04462420999994,-75.05646362099992,-75.06494471399992,-75.04889619499994,-75.04544880999993,-75.06615402799991,-75.07205483299992,-75.09064545399991,-75.10400470299993,-75.11266728399994,-75.12168574299994,-75.14120031099992,-75.14295222299995,-75.14837850299995,-75.16749959599991,-75.17859264399993,-75.22420691199994,-75.24255255399993,-75.25856525299992,-75.27605428699991,-75.2999393209999,-75.3135593529999,-75.31939858299995,-75.3347652249999,-75.34219235399991,-75.34273487099995,-75.32467476199992,-75.3050442089999,-75.28649381299994,-75.2707836379999,-75.23840563999994,-75.21910821699993,-75.20348296099991,-75.19909523299992,-75.1489412439999,-75.14270824599993,-75.1288944069999,-75.11289954799992,-75.10234069099994,-75.07739323099992,-75.06096507299992,-75.04421772099994],"lat":[5.121686269000065,5.101421689000063,5.091193832000044,5.076133388000073,5.067093698000065,5.05369414200004,5.031602327000087,5.047694667000087,5.04674863200006,5.063196018000042,5.067528376000041,5.053015917000039,5.052004613000065,5.031508278000047,5.017160162000039,4.998404425000047,4.99857574400005,4.972335049000037,4.97303461100006,4.949882210000055,4.933592422000061,4.91875886300005,4.90595260300006,4.893064363000065,4.89964974500009,4.93480904200004,4.948657508000053,4.96754566900006,4.975826193000046,4.978705432000083,4.98941998500004,4.998398414000064,4.997409528000048,5.012672081000062,5.022227994000048,5.068559518000086,5.087495268000055,5.093314207000049,5.102277670000092,5.118886308000071,5.123632144000055,5.116814063000049,5.121686269000065]}]],[[{"lng":[-75.63159294299993,-75.60864304599994,-75.60137379199995,-75.5837776759999,-75.57961659099993,-75.56640458599992,-75.54868079699992,-75.52658555599993,-75.50758517499992,-75.48115429399991,-75.45922225299995,-75.44949025699992,-75.44863791799992,-75.43989181199993,-75.42397921599991,-75.40163180299993,-75.39202784899993,-75.37672586899993,-75.37157973599994,-75.35513487399993,-75.34984918599991,-75.30658458599993,-75.30986044199994,-75.29598559599992,-75.28278790199994,-75.2728838079999,-75.28215382499991,-75.29265293999993,-75.30214408899991,-75.30513269199992,-75.32343411599993,-75.3404432559999,-75.3525557509999,-75.35847005399995,-75.36606090299995,-75.36547107199993,-75.39434485299995,-75.42052351799992,-75.41689058399993,-75.42610385699993,-75.43060304199992,-75.45376306999992,-75.46015161899993,-75.47210400899991,-75.48569442199994,-75.49545711999991,-75.5173028019999,-75.54386963299993,-75.5791645779999,-75.58024961199993,-75.58437559699991,-75.57921262799994,-75.58510179399991,-75.5832981609999,-75.59577843499994,-75.61482648799995,-75.62329690099995,-75.63211156299991,-75.63603291899994,-75.6495292219999,-75.65893285099992,-75.68147110699994,-75.69858418999991,-75.72414911699991,-75.74700600999995,-75.75555431999993,-75.75398461999993,-75.76718336599993,-75.78336675899993,-75.79499994999992,-75.79842637399992,-75.81765241799991,-75.8241435889999,-75.82362962199994,-75.84152317099995,-75.85041283699991,-75.86893456199994,-75.88246893299993,-75.89446141899992,-75.91703254499993,-75.91608975699995,-75.9032585249999,-75.89378564399993,-75.87179380899994,-75.86110211199991,-75.86159055899992,-75.8497951409999,-75.83849027899993,-75.82319698999993,-75.80730592099991,-75.80550360899991,-75.7914673379999,-75.79526276799993,-75.77728608299992,-75.76939170499992,-75.7616755869999,-75.74549779499995,-75.73160379599994,-75.73626773299992,-75.71680013899993,-75.69400114999991,-75.68722647399994,-75.67266516699993,-75.65422162099992,-75.65040258099992,-75.6395522389999,-75.63159294299993],"lat":[3.933063068000081,3.92716200600006,3.898180171000092,3.893837655000084,3.875137699000049,3.858322563000058,3.860668278000048,3.847654681000051,3.841467503000047,3.845900347000054,3.830838671000038,3.846662085000048,3.857783829000084,3.873310870000068,3.863103605000049,3.856604679000043,3.84888526900005,3.826942342000052,3.831553868000071,3.818513947000042,3.807066281000061,3.80185950300006,3.757492882000065,3.755390220000038,3.763502095000092,3.746226882000087,3.73158668800005,3.689409224000087,3.694372454000074,3.674975089000043,3.663748177000059,3.659365702000059,3.661853328000063,3.639225942000053,3.62568026200006,3.610985271000061,3.594806468000058,3.559371261000081,3.536471299000084,3.52900930900006,3.511159251000038,3.484511467000061,3.473338966000085,3.484959459000038,3.484613937000063,3.477919429000053,3.474360269000044,3.463285742000039,3.46360934900008,3.487085112000045,3.501633137000056,3.518961737000041,3.552497861000063,3.566386777000048,3.572418708000043,3.570670300000074,3.577820085000042,3.594384654000066,3.611840380000046,3.622062546000052,3.619169121000084,3.643706123000072,3.652177004000066,3.642621089000045,3.647581151000054,3.664766482000061,3.674251014000049,3.686620695000045,3.676539236000053,3.685432350000042,3.697462905000066,3.712272670000061,3.723865407000062,3.759976106000067,3.777146297000058,3.77425287300008,3.753542042000049,3.752495082000053,3.742843988000061,3.748359865000054,3.758753787000046,3.796609741000054,3.801794484000084,3.82429227700004,3.848984692000045,3.873863201000063,3.889219857000057,3.905504685000039,3.904538765000041,3.930605749000051,3.953059453000037,3.971045968000055,4.005061921000049,4.003457997000055,4.020723113000088,4.024515491000045,4.043176456000083,4.025005213000043,4.013728840000056,3.980777875000058,3.972432412000046,3.96206780600005,3.965386645000081,3.955715539000039,3.937845784000046,3.928220866000061,3.933063068000081]}]],[[{"lng":[-74.79461993799993,-74.8008534299999,-74.80446632799993,-74.81420277299992,-74.82197637499991,-74.83312273999991,-74.8307469639999,-74.8390868429999,-74.85437661899994,-74.85190292499993,-74.85582000699992,-74.86491889199993,-74.88270078199992,-74.88309979099995,-74.89057417999993,-74.89586961499992,-74.90029617899995,-74.9073901889999,-74.90999248399993,-74.91960550499994,-74.9223180919999,-74.94788539899992,-74.96140073799995,-74.9739404959999,-74.98227581899994,-74.99785608399992,-75.02310165999995,-75.02929164699992,-75.03458752899991,-75.02694786399991,-75.00631178599991,-74.99967247399991,-74.98630937999991,-74.9820396049999,-74.96990852399995,-74.96570980399991,-74.9606589679999,-74.9303579029999,-74.9101525019999,-74.90987074299994,-74.90063452599992,-74.89272053099995,-74.89652621199991,-74.90499281199993,-74.88771426699992,-74.86904780599991,-74.84879385599993,-74.83716625599993,-74.83180416499994,-74.80585420699992,-74.79461993799993],"lat":[4.499983761000067,4.484034697000084,4.458928141000058,4.44643609700006,4.445324050000067,4.443373351000048,4.423214121000058,4.382598445000042,4.366366311000093,4.358874555000057,4.334745324000039,4.332104460000039,4.317636074000063,4.300218493000045,4.288952893000044,4.288711504000048,4.257728225000051,4.249962193000044,4.237276757000075,4.235135244000048,4.224606128000062,4.208259232000046,4.215433309000048,4.211197869000046,4.239024837000045,4.248178039000038,4.279474722000089,4.279496809000079,4.284901713000068,4.32489077200006,4.324431115000039,4.308229906000065,4.313063962000058,4.334483907000049,4.345742943000062,4.360774369000069,4.368047048000051,4.359551011000065,4.400133396000058,4.412422632000073,4.450052034000066,4.462055558000088,4.475850472000047,4.480323393000049,4.495337523000046,4.505233864000047,4.500537292000047,4.509427229000039,4.497052867000093,4.493950751000057,4.499983761000067]}]],[[{"lng":[-75.10299480399993,-75.09738469099995,-75.06305404499994,-75.07994903199994,-75.06470394999991,-75.05928892599991,-75.03967937199991,-75.03321563299994,-75.03387983099992,-75.01044820999994,-75.00591035499991,-74.97966293199994,-74.97480882999992,-74.97346552799991,-74.9829668939999,-75.00630725799994,-75.01493254699994,-75.03230982799994,-75.03573625399991,-75.05461727799991,-75.0812862759999,-75.09116579899995,-75.09728577199991,-75.11816792099995,-75.13426122499993,-75.14076748799994,-75.15757972799992,-75.17601350299992,-75.18489916399994,-75.20530436599995,-75.22580580099992,-75.23712721999993,-75.26325360099992,-75.27065732299991,-75.28778372399995,-75.29251160899992,-75.30985842599995,-75.3178708399999,-75.3259037979999,-75.32343411599993,-75.30513269199992,-75.30214408899991,-75.29265293999993,-75.28215382499991,-75.2728838079999,-75.26034295999995,-75.24397845499993,-75.2443506699999,-75.22420896799991,-75.19586059699992,-75.19200899299994,-75.19406621199994,-75.17731519299991,-75.1707532129999,-75.16360575899995,-75.12951882499993,-75.12262965299993,-75.10299480399993],"lat":[3.909388857000067,3.887337406000086,3.865800473000093,3.847698589000061,3.843721045000052,3.835955346000048,3.828363540000055,3.820020309000085,3.81563748700006,3.79358318900006,3.781859981000082,3.747482639000054,3.74548389000006,3.734059215000059,3.706235526000057,3.697716804000038,3.686685578000038,3.684562739000057,3.668037385000048,3.660575391000066,3.660730060000049,3.665574641000092,3.686057039000048,3.69586696500005,3.694511981000062,3.668032193000045,3.659906960000058,3.629879243000062,3.623100281000063,3.633945957000037,3.631852033000087,3.600571655000067,3.592109356000037,3.601320609000084,3.602658346000055,3.610449368000047,3.611347089000049,3.620463776000065,3.644023349000065,3.663748177000059,3.674975089000043,3.694372454000074,3.689409224000087,3.73158668800005,3.746226882000087,3.762053592000086,3.767757223000046,3.77900014100004,3.764972696000086,3.804182858000047,3.820171617000085,3.841502619000039,3.859114154000054,3.858918805000087,3.877069669000093,3.887947069000063,3.884546835000037,3.909388857000067]}]],[[{"lng":[-74.6245368729999,-74.60871499099994,-74.5990067919999,-74.5792572659999,-74.56107818399994,-74.56244874999993,-74.54876209199995,-74.54371763599994,-74.5433559569999,-74.54643973999993,-74.54240417299991,-74.53159213599992,-74.53924535899995,-74.55471185099992,-74.59204559699992,-74.61105748799991,-74.62711885399995,-74.63608942099995,-74.66837870299992,-74.66193036699991,-74.65372122699995,-74.6622159019999,-74.68233424399995,-74.69726536399992,-74.70238120499994,-74.69295258699992,-74.69720587599994,-74.69104902099991,-74.70709662899992,-74.71768548299991,-74.7232274239999,-74.73205899599992,-74.75136237599992,-74.7594822879999,-74.76407464699992,-74.77573400599994,-74.78834514899995,-74.79262817999995,-74.80997444999991,-74.82467122999992,-74.80992098499991,-74.80535242399992,-74.80720563199992,-74.79499616299995,-74.7805689029999,-74.74415261999991,-74.73561511299994,-74.71479006999994,-74.70416815699991,-74.6928419219999,-74.68459946999991,-74.66824756999995,-74.64950931599992,-74.63188940899994,-74.6245368729999],"lat":[4.100699162000069,4.094905204000042,4.084816290000049,4.083269643000051,4.068169581000063,4.055301455000063,4.036170589000051,4.022445860000062,3.997718501000065,3.987382120000063,3.976607921000038,3.975497081000071,3.973393839000039,3.977510307000045,3.981793337000056,3.995570419000046,3.978152762000093,3.974535980000041,3.949266105000049,3.945435175000057,3.919046949000062,3.900106440000059,3.879732306000051,3.877769249000039,3.87137444800004,3.842761427000084,3.821048853000093,3.810281789000044,3.802768752000077,3.805356551000045,3.828923170000053,3.843139516000065,3.854798875000085,3.865684909000038,3.893572195000047,3.905683646000057,3.887909074000049,3.874703065000062,3.881698680000056,3.895465332000072,3.927106821000052,3.950425538000047,3.975141043000065,3.98847431900009,4.013972167000077,4.046173125000053,4.063632425000094,4.07421626200005,4.085847070000057,4.087331850000055,4.095460091000064,4.102162530000044,4.117081753000093,4.126575801000058,4.100699162000069]}]],[[{"lng":[-74.53474407899995,-74.53586404599992,-74.54674314399995,-74.55742496099992,-74.58665533199991,-74.59797384099994,-74.61515065599991,-74.62486543099993,-74.65544447899993,-74.6763064029999,-74.69672515299993,-74.70113012899992,-74.72507940299994,-74.73957670599992,-74.72862579699995,-74.7471267649999,-74.75764528999991,-74.77475764999991,-74.78288144499993,-74.78082763099991,-74.76171134799995,-74.76472139399993,-74.77666179499994,-74.78419277399991,-74.81102432699993,-74.82009483599995,-74.82696065599993,-74.85141081699993,-74.84875553699993,-74.82848957399995,-74.83023633499994,-74.84531971399991,-74.85911799599995,-74.87983120199993,-74.89523757499995,-74.93278547299991,-74.9365259839999,-74.95203055299993,-74.96726386299991,-74.97390255799991,-74.99157719099992,-74.99564737499992,-74.99493862199995,-74.97086916699993,-74.94790845099993,-74.94074401699993,-74.94180010699995,-74.92996088299992,-74.91781639999994,-74.92280518399991,-74.90733031899993,-74.89472963199995,-74.8734736639999,-74.86031786299992,-74.85387380199995,-74.83429614799991,-74.80862068199991,-74.80101751199993,-74.78037606899994,-74.76575189899995,-74.75828515299992,-74.74932130299993,-74.73285347199993,-74.71737180899993,-74.71033304199995,-74.70524693999994,-74.69666896699994,-74.67255314499994,-74.64491637099991,-74.61764264999994,-74.60264993399994,-74.58258027799991,-74.5600535559999,-74.55159685399991,-74.53945977399991,-74.53474407899995],"lat":[3.843206595000083,3.817120869000064,3.802717955000048,3.767878457000052,3.738948428000072,3.722382175000064,3.712010191000047,3.698738429000059,3.681175031000066,3.666333146000056,3.641958542000054,3.615540576000058,3.608895932000053,3.58581419300009,3.551581167000052,3.528032967000058,3.532057448000046,3.524149841000053,3.492652465000049,3.479007477000039,3.454611145000058,3.440583669000091,3.435586329000046,3.425794581000048,3.410649194000086,3.414216599000042,3.432114216000059,3.454113066000048,3.461327494000045,3.486942447000047,3.496142557000042,3.509184861000051,3.511622215000045,3.506518271000061,3.493428108000046,3.49414194700006,3.479693859000065,3.477780774000053,3.487874445000045,3.501480202000039,3.504535432000068,3.51242059100008,3.534468735000075,3.562779521000039,3.57187648200005,3.582652822000057,3.594487153000046,3.618016829000055,3.632457695000085,3.649454989000048,3.667529500000057,3.655838312000071,3.66179502500006,3.653057601000057,3.660676494000086,3.656213875000049,3.662632244000065,3.670996876000061,3.672630217000062,3.693017441000052,3.711386878000042,3.722424569000054,3.727000901000054,3.759153118000086,3.756415765000042,3.730330923000054,3.703254561000051,3.696596119000048,3.714423937000049,3.737321564000069,3.765871049000054,3.794844724000086,3.816201192000051,3.836874093000063,3.844774947000076,3.843206595000083]}]],[[{"lng":[-74.8114771779999,-74.8193363389999,-74.80477403799995,-74.81414911399992,-74.81172206499991,-74.82807850899991,-74.84602172599995,-74.85956561799992,-74.86994958699995,-74.88572313199995,-74.9029437719999,-74.91118353199994,-74.93689438199993,-74.94705806699994,-74.96385706099994,-74.97469550599993,-74.98624778599992,-74.99185617699993,-75.00657783699995,-74.99785608399992,-74.98227581899994,-74.9739404959999,-74.96140073799995,-74.94788539899992,-74.9223180919999,-74.91960550499994,-74.90999248399993,-74.9073901889999,-74.8984378479999,-74.8845866179999,-74.87241249099992,-74.85855247599994,-74.86328981299994,-74.8487222839999,-74.82526991399993,-74.8114771779999],"lat":[4.191709417000084,4.179204057000049,4.154124540000055,4.130900999000062,4.108819603000086,4.09009659600008,4.094323613000086,4.08910783500005,4.096979091000094,4.097453101000042,4.104238243000054,4.11377284200006,4.122376917000054,4.14353314400006,4.166661505000093,4.174121114000059,4.191050980000057,4.208482915000047,4.236532407000084,4.248178039000038,4.239024837000045,4.211197869000046,4.215433309000048,4.208259232000046,4.224606128000062,4.235135244000048,4.237276757000075,4.249962193000044,4.233625793000044,4.242752451000058,4.228665198000044,4.226657009000064,4.205744730000049,4.186613843000089,4.195142547000046,4.191709417000084]}]],[[{"lng":[-74.90036718599993,-74.9047736629999,-74.90236131799992,-74.88868907199992,-74.8878870069999,-74.89748366499992,-74.89125987199992,-74.95557418899995,-74.97197002099995,-74.9832968149999,-75.00012525299991,-75.00869387699993,-75.04307677899993,-75.0487044539999,-75.06615402799991,-75.04544880999993,-75.02672233199991,-75.02239275699992,-74.99484883299993,-74.98215995299995,-74.98619596799995,-74.98397788599993,-74.99465175499995,-74.99458258099992,-74.97790727599994,-74.96633935499995,-74.94866815699993,-74.95047986999992,-74.92898279299993,-74.90148449199995,-74.90036718599993],"lat":[5.142293881000057,5.110116205000054,5.096473650000064,5.086203302000058,5.072050405000084,5.063240242000063,5.038476968000055,5.019658317000051,5.012598347000051,5.024351792000061,5.008134408000046,5.008908750000046,5.015806994000059,5.027281662000064,5.031602327000087,5.05369414200004,5.047264746000053,5.054962543000045,5.058266081000056,5.077398082000059,5.088705835000042,5.124009786000045,5.132755556000063,5.14563306000008,5.152211277000049,5.170023946000072,5.174235964000047,5.161968136000041,5.150380011000038,5.155690575000051,5.142293881000057]}]],[[{"lng":[-74.79676788099994,-74.77700828699994,-74.78147358099994,-74.79463753399995,-74.79639833199991,-74.80101448999994,-74.8114771779999,-74.82526991399993,-74.8487222839999,-74.86328981299994,-74.85855247599994,-74.87241249099992,-74.8845866179999,-74.8984378479999,-74.9073901889999,-74.90029617899995,-74.89586961499992,-74.89057417999993,-74.87895357399992,-74.85475285299992,-74.83365179299994,-74.81302906099995,-74.80753416099992,-74.79676788099994],"lat":[4.288245807000067,4.282209103000071,4.265062322000063,4.246400037000058,4.221272929000065,4.202951080000048,4.191709417000084,4.195142547000046,4.186613843000089,4.205744730000049,4.226657009000064,4.228665198000044,4.242752451000058,4.233625793000044,4.249962193000044,4.257728225000051,4.288711504000048,4.288952893000044,4.266059913000049,4.268506006000052,4.275717072000077,4.294180465000068,4.286203834000048,4.288245807000067]}]],[[{"lng":[-75.00066661299991,-75.0066953139999,-75.00910233799993,-75.00305213699994,-74.98319415899994,-74.97408127099993,-74.9770984299999,-74.96633935499995,-74.97790727599994,-74.99458258099992,-75.01904339499993,-75.04421772099994,-75.06096507299992,-75.07739323099992,-75.10234069099994,-75.11289954799992,-75.1288944069999,-75.12881603999995,-75.14465575999992,-75.16090192399992,-75.15928408899993,-75.14917424099991,-75.13100683999994,-75.11635110999993,-75.11329409799993,-75.09821272099992,-75.08484769299992,-75.0750285709999,-75.06627353099992,-75.05983542999991,-75.05674284199995,-75.03584977899993,-75.02533248199995,-75.00066661299991],"lat":[5.291577050000058,5.271411375000071,5.237258456000063,5.22677402000005,5.220550881000065,5.202256677000094,5.191472959000066,5.170023946000072,5.152211277000049,5.14563306000008,5.140999255000054,5.121686269000065,5.116814063000049,5.123632144000055,5.118886308000071,5.102277670000092,5.093314207000049,5.114914313000043,5.143806558000051,5.141324086000054,5.153259198000057,5.164787981000075,5.155969225000092,5.160510817000045,5.181732398000065,5.211242900000059,5.223703130000047,5.244091924000088,5.247741341000051,5.270428137000067,5.275278411000045,5.276586963000057,5.28821286100009,5.291577050000058]}]],[[{"lng":[-75.00657783699995,-74.99185617699993,-74.98624778599992,-74.97469550599993,-74.96385706099994,-74.94705806699994,-74.93689438199993,-74.91118353199994,-74.9029437719999,-74.88572313199995,-74.86994958699995,-74.85956561799992,-74.84602172599995,-74.82807850899991,-74.83813407799994,-74.83372790399994,-74.84075148799991,-74.85740771299993,-74.86578300699995,-74.87316124799992,-74.8824696989999,-74.8976221069999,-74.91178465599995,-74.92082660799991,-74.92781270799992,-74.91989949499992,-74.9314485239999,-74.9524068149999,-74.9744504869999,-74.98988737199994,-75.0041816509999,-75.00877539499993,-75.02755576499993,-75.06164756999993,-75.06654105299992,-75.08477043599993,-75.0799170869999,-75.07985636099994,-75.07125223299994,-75.05512900399992,-75.06144885299994,-75.07846675499991,-75.07479287099994,-75.08273075199992,-75.0726608729999,-75.0599069619999,-75.05066851499993,-75.04324459899993,-75.04222599199994,-75.03413602099994,-75.02367700299993,-75.00657783699995],"lat":[4.236532407000084,4.208482915000047,4.191050980000057,4.174121114000059,4.166661505000093,4.14353314400006,4.122376917000054,4.11377284200006,4.104238243000054,4.097453101000042,4.096979091000094,4.08910783500005,4.094323613000086,4.09009659600008,4.062515292000057,4.045972701000039,4.034294883000086,4.02906007200005,4.009230331000083,3.99600392900004,3.990978510000048,3.992272932000049,3.978395918000047,3.977234743000054,3.966536685000051,3.955728294000039,3.949233244000084,3.948471816000051,3.944065712000054,3.95561759800006,3.978822820000062,3.99571510800007,4.004799698000056,3.985847322000041,4.002329105000058,4.023604568000053,4.043632996000042,4.061080936000053,4.080992267000056,4.100694203000046,4.10950772700005,4.110421439000049,4.12391774300005,4.138004152000065,4.152604526000061,4.181786235000061,4.216420566000068,4.229712237000058,4.246814660000041,4.245944921000046,4.230655952000063,4.236532407000084]}]],[[{"lng":[-74.5411772459999,-74.51885728299993,-74.51249689199994,-74.50129379399993,-74.48334305799995,-74.48366120599991,-74.4748249029999,-74.47637296999994,-74.4862729969999,-74.5086571729999,-74.52567055599991,-74.53140227899991,-74.52403664099995,-74.53364133699995,-74.53159213599992,-74.54240417299991,-74.54643973999993,-74.5433559569999,-74.54371763599994,-74.54876209199995,-74.56244874999993,-74.56107818399994,-74.5792572659999,-74.5990067919999,-74.60871499099994,-74.6245368729999,-74.61185410399992,-74.59699199399995,-74.57978848899995,-74.56165699899992,-74.5583162339999,-74.5611430319999,-74.56663958699994,-74.56101454199995,-74.55559160999991,-74.55192484399993,-74.54939933999992,-74.5411772459999],"lat":[4.251591653000048,4.24049321800004,4.211221605000048,4.187651050000056,4.176734427000042,4.147237503000042,4.128569455000047,4.120131995000065,4.096391843000049,4.078136740000048,4.052133067000057,4.033718523000061,4.022252596000044,3.993312113000059,3.975497081000071,3.976607921000038,3.987382120000063,3.997718501000065,4.022445860000062,4.036170589000051,4.055301455000063,4.068169581000063,4.083269643000051,4.084816290000049,4.094905204000042,4.100699162000069,4.124794226000063,4.133831418000057,4.15080649500004,4.179445687000054,4.193279873000051,4.224560269000051,4.242349119000039,4.262522189000038,4.267101599000057,4.265060361000053,4.260830583000086,4.251591653000048]}]],[[{"lng":[-74.81185181199993,-74.80561405299994,-74.81785995099995,-74.83807884499993,-74.83939160599994,-74.85481449999992,-74.8694182719999,-74.87346414699994,-74.87159944299992,-74.88678040399992,-74.8964409219999,-74.91672821099991,-74.92361912999991,-74.94138894199995,-74.94666183099991,-74.9561320819999,-74.96416514499992,-75.00029323599995,-75.0077509219999,-75.01752273199992,-74.99639256599994,-74.99364190799992,-74.9776356129999,-74.9666666839999,-74.9681682449999,-74.98556199599994,-74.98735784399992,-75.00048109199992,-74.99940598499995,-74.98017011899992,-74.98383255999994,-74.97395713599991,-74.94570645199991,-74.91708710199993,-74.90614913999991,-74.87038654899993,-74.8641856779999,-74.81958981899993,-74.81185181199993],"lat":[4.886811436000073,4.870301944000062,4.866166045000057,4.852662158000044,4.835499908000088,4.823783651000042,4.819239146000086,4.789673177000054,4.774252683000043,4.777917054000056,4.773812879000047,4.783285034000073,4.790585223000051,4.791651221000052,4.781800252000039,4.78275203600009,4.794268627000065,4.798588521000056,4.811035975000038,4.832283872000062,4.837206004000052,4.847770808000064,4.84961827300009,4.866892677000067,4.895306131000041,4.898142313000051,4.906534453000063,4.92194547400004,4.939843343000064,4.949195825000061,4.960160121000058,4.967151125000044,4.958535100000063,4.963466058000051,4.952736229000038,4.88727543400006,4.891744060000065,4.891218198000047,4.886811436000073]}]],[[{"lng":[-75.0160922689999,-74.99871404299995,-74.98352639699993,-74.97395713599991,-74.98383255999994,-74.98017011899992,-74.99940598499995,-75.00048109199992,-74.98735784399992,-74.98556199599994,-74.9681682449999,-74.9666666839999,-74.9776356129999,-74.99364190799992,-74.99639256599994,-75.01752273199992,-75.0077509219999,-75.01268830399994,-75.03732336599995,-75.0466508479999,-75.04343263199991,-75.05030332199993,-75.07046674199995,-75.08818856599993,-75.09760434899994,-75.10920160199993,-75.11423019099993,-75.10976604399991,-75.11374971499993,-75.10536865899991,-75.10330281799992,-75.11614289699992,-75.10231263199995,-75.10946819299994,-75.09892666099995,-75.10580857699995,-75.07456567899993,-75.05852709499993,-75.04593309899991,-75.0160922689999],"lat":[4.996283765000044,4.979218281000044,4.974952465000058,4.967151125000044,4.960160121000058,4.949195825000061,4.939843343000064,4.92194547400004,4.906534453000063,4.898142313000051,4.895306131000041,4.866892677000067,4.84961827300009,4.847770808000064,4.837206004000052,4.832283872000062,4.811035975000038,4.811585630000081,4.796295783000062,4.787134859000048,4.773322087000054,4.760978631000057,4.752976295000053,4.766954312000053,4.762253537000049,4.768378301000041,4.78802451200005,4.809035080000058,4.83031513800006,4.844673645000057,4.865845197000056,4.880212874000051,4.89037694700005,4.898206587000061,4.923531670000045,4.929917950000061,4.948100513000043,4.979982840000048,4.996016558000065,4.996283765000044]}]],[[{"lng":[-74.86127117399991,-74.84939007599991,-74.83309596599992,-74.82185990199991,-74.81808013799991,-74.82303698399994,-74.8173363329999,-74.80405040099993,-74.7950597549999,-74.81734244399991,-74.83587243999995,-74.86791118799994,-74.86411017899991,-74.88435851199995,-74.90036718599993,-74.90148449199995,-74.92898279299993,-74.95047986999992,-74.94866815699993,-74.96633935499995,-74.9770984299999,-74.97408127099993,-74.98319415899994,-75.00305213699994,-75.00910233799993,-75.0066953139999,-75.00066661299991,-74.98675653399994,-74.96760687799991,-74.95477764099991,-74.9396984359999,-74.90899582499992,-74.89844207699991,-74.87097349399994,-74.86127117399991],"lat":[5.30625849200004,5.307340404000058,5.293781856000066,5.292241464000085,5.280562475000067,5.268912837000073,5.253797706000057,5.23400954400006,5.227338789000044,5.208239913000057,5.187571828000046,5.174664385000085,5.167774573000088,5.146773978000056,5.142293881000057,5.155690575000051,5.150380011000038,5.161968136000041,5.174235964000047,5.170023946000072,5.191472959000066,5.202256677000094,5.220550881000065,5.22677402000005,5.237258456000063,5.271411375000071,5.291577050000058,5.288580739000054,5.300536057000045,5.30148592200004,5.312814451000065,5.308438319000061,5.298969102000058,5.296532023000054,5.30625849200004]}]],[[{"lng":[-74.6245368729999,-74.63188940899994,-74.64950931599992,-74.66824756999995,-74.68459946999991,-74.6922087449999,-74.68891319199992,-74.67125363399992,-74.69073122599991,-74.71145406599993,-74.7196394099999,-74.74612995099994,-74.74508188999994,-74.73076967499992,-74.72189834399995,-74.71124651799994,-74.7004537119999,-74.7016743879999,-74.67679839499993,-74.65647824599995,-74.6550577079999,-74.64047957299994,-74.62713949199991,-74.6188774179999,-74.61986229599995,-74.6045911029999,-74.58854248299991,-74.56253001999994,-74.55559160999991,-74.56101454199995,-74.56663958699994,-74.5611430319999,-74.5583162339999,-74.56165699899992,-74.57978848899995,-74.59699199399995,-74.61185410399992,-74.6245368729999],"lat":[4.100699162000069,4.126575801000058,4.117081753000093,4.102162530000044,4.095460091000064,4.101627151000059,4.123066097000049,4.150786366000091,4.169328490000055,4.174087,4.190326823000078,4.202959380000038,4.236351312000068,4.244765443000063,4.231042436000052,4.232535407000057,4.218373761000066,4.212055443000054,4.20664322500005,4.214603197000088,4.203395936000049,4.210338807000085,4.222836132000054,4.238312872000051,4.251868866000052,4.257077049000088,4.267410677000044,4.272129584000083,4.267101599000057,4.262522189000038,4.242349119000039,4.224560269000051,4.193279873000051,4.179445687000054,4.15080649500004,4.133831418000057,4.124794226000063,4.100699162000069]}]],[[{"lng":[-75.01493254699994,-74.99830536499991,-74.9872909259999,-74.98945747799991,-74.96401015799995,-74.96391090899994,-74.93980828399992,-74.92996088299992,-74.94180010699995,-74.94074401699993,-74.94790845099993,-74.97086916699993,-74.99493862199995,-74.99564737499992,-75.00382075499994,-74.99235628399992,-75.00609138199991,-75.00495768499991,-75.01958768499992,-75.03415979099992,-75.04603343899993,-75.12145130399995,-75.1316724159999,-75.14971765099995,-75.15773324599991,-75.17416142399992,-75.17277344999991,-75.19988382299994,-75.20077720899991,-75.22726536699992,-75.24128039399994,-75.2505215249999,-75.26824255899993,-75.27651850899991,-75.27714906599994,-75.28615532499992,-75.30245463299991,-75.27940096099991,-75.26736387999995,-75.25649545499994,-75.25616343099995,-75.2670751739999,-75.27507016299995,-75.29003221399995,-75.28953728599993,-75.26661831699994,-75.24685926799992,-75.24807755699993,-75.23712721999993,-75.22580580099992,-75.20530436599995,-75.18489916399994,-75.17601350299992,-75.15757972799992,-75.14076748799994,-75.13426122499993,-75.11816792099995,-75.09728577199991,-75.09116579899995,-75.0812862759999,-75.05461727799991,-75.03573625399991,-75.03230982799994,-75.01493254699994],"lat":[3.686685578000038,3.683544956000048,3.671564344000046,3.662021784000046,3.647939654000083,3.634477189000052,3.629374709000047,3.618016829000055,3.594487153000046,3.582652822000057,3.57187648200005,3.562779521000039,3.534468735000075,3.51242059100008,3.499806209000042,3.493993533000094,3.468865475000086,3.45823112000005,3.450491280000051,3.427503718000082,3.431534700000043,3.433127700000057,3.43029408600006,3.434938091000049,3.414533645000063,3.408690381000042,3.378333830000088,3.384554628000046,3.409583265000037,3.415769863000094,3.404300858000056,3.367269972000088,3.382105910000064,3.39881673800005,3.421385929000053,3.436852423000062,3.45054622300006,3.471530121000058,3.478747597000051,3.492974092000054,3.50705954600005,3.514858693000065,3.530829638000057,3.544687619000058,3.562390805000064,3.573983543000054,3.568881976000057,3.590487483000061,3.600571655000067,3.631852033000087,3.633945957000037,3.623100281000063,3.629879243000062,3.659906960000058,3.668032193000045,3.694511981000062,3.69586696500005,3.686057039000048,3.665574641000092,3.660730060000049,3.660575391000066,3.668037385000048,3.684562739000057,3.686685578000038]}]],[[{"lng":[-75.24419552299992,-75.21066891599992,-75.18996776599994,-75.19984236799991,-75.21033578799995,-75.21805643899995,-75.21402882899991,-75.19600607699994,-75.18972429699994,-75.15957652999992,-75.13769024299995,-75.13166069399995,-75.1207389679999,-75.09435073999992,-75.09316101499991,-75.08271517999992,-75.0726247849999,-75.08549316199992,-75.10299480399993,-75.12262965299993,-75.12951882499993,-75.16360575899995,-75.1707532129999,-75.17731519299991,-75.19406621199994,-75.19200899299994,-75.19586059699992,-75.22420896799991,-75.2443506699999,-75.24397845499993,-75.26034295999995,-75.2728838079999,-75.28278790199994,-75.29598559599992,-75.30986044199994,-75.30658458599993,-75.34984918599991,-75.35513487399993,-75.37157973599994,-75.37672586899993,-75.39202784899993,-75.40163180299993,-75.42397921599991,-75.43989181199993,-75.44381716399994,-75.43359420099995,-75.43777537499994,-75.4274250549999,-75.42711365999992,-75.44105525899994,-75.41336597999992,-75.42632594999992,-75.40839660299991,-75.39263581699993,-75.39176493299993,-75.38172836899992,-75.36905060099991,-75.35961365799994,-75.3456224279999,-75.32907089699995,-75.30205449599993,-75.28840590699991,-75.27603271099991,-75.24419552299992],"lat":[4.107485564000058,4.100014056000077,4.108580304000043,4.088033472000063,4.080716629000051,4.053917420000062,4.032476325000061,4.023410813000055,4.012441498000044,3.996237368000038,4.008087085000057,3.98785809900005,3.979077885000038,3.970725977000086,3.960541884000065,3.952951402000053,3.937929035000082,3.918992701000093,3.909388857000067,3.884546835000037,3.887947069000063,3.877069669000093,3.858918805000087,3.859114154000054,3.841502619000039,3.820171617000085,3.804182858000047,3.764972696000086,3.77900014100004,3.767757223000046,3.762053592000086,3.746226882000087,3.763502095000092,3.755390220000038,3.757492882000065,3.80185950300006,3.807066281000061,3.818513947000042,3.831553868000071,3.826942342000052,3.84888526900005,3.856604679000043,3.863103605000049,3.873310870000068,3.87532757200006,3.909990347000075,3.927291976000049,3.944962013000065,3.95863521800004,3.984931900000049,4.024323874000061,4.049772353000037,4.055042694000065,4.056857772000058,4.04540780800005,4.039868421000051,4.041167610000059,4.052617574000067,4.059527528000046,4.084166848000052,4.106072167000093,4.108661020000056,4.119692199000042,4.107485564000058]}]],[[{"lng":[-74.99458258099992,-74.99465175499995,-74.98397788599993,-74.98619596799995,-74.98215995299995,-74.99484883299993,-75.02239275699992,-75.02672233199991,-75.04544880999993,-75.04889619499994,-75.06494471399992,-75.05646362099992,-75.04462420999994,-75.04421772099994,-75.01904339499993,-74.99458258099992],"lat":[5.14563306000008,5.132755556000063,5.124009786000045,5.088705835000042,5.077398082000059,5.058266081000056,5.054962543000045,5.047264746000053,5.05369414200004,5.067093698000065,5.076133388000073,5.091193832000044,5.101421689000063,5.121686269000065,5.140999255000054,5.14563306000008]}]],[[{"lng":[-74.8162493669999,-74.79377694999994,-74.81476655699993,-74.80514067799993,-74.80891905599992,-74.80154221799995,-74.80514067799993,-74.7869684559999,-74.79461993799993,-74.80585420699992,-74.83180416499994,-74.83716625599993,-74.84879385599993,-74.86904780599991,-74.88771426699992,-74.90499281199993,-74.89652621199991,-74.89272053099995,-74.90063452599992,-74.90987074299994,-74.9101525019999,-74.9303579029999,-74.9606589679999,-74.96570980399991,-74.98263218999995,-74.99558851299992,-74.99299057899992,-75.00581242399994,-75.02870730099994,-75.04843136799991,-75.0660735589999,-75.06966962399991,-75.0618734329999,-75.04296593599992,-75.02927171599993,-75.01528587999991,-75.00752884199994,-74.99523892499991,-74.9790228999999,-74.95393869899993,-74.93475072599995,-74.89570376899991,-74.87836344699991,-74.8625876829999,-74.8554765639999,-74.82679454099991,-74.8162493669999],"lat":[4.611092497000072,4.592081894000046,4.586181280000062,4.56701948500006,4.554919664000067,4.543899379000038,4.535982769000043,4.508904360000088,4.499983761000067,4.493950751000057,4.497052867000093,4.509427229000039,4.500537292000047,4.505233864000047,4.495337523000046,4.480323393000049,4.475850472000047,4.462055558000088,4.450052034000066,4.412422632000073,4.400133396000058,4.359551011000065,4.368047048000051,4.360774369000069,4.354886115000056,4.356019877000051,4.388981264000051,4.396259999000051,4.395673822000049,4.403352020000057,4.40568339500004,4.435961463000069,4.436214878000044,4.450304411000047,4.45037872100005,4.460531474000049,4.472452572000066,4.474094403000038,4.486491392000062,4.524796295000044,4.534918519000087,4.575150447000055,4.608424830000047,4.625193792000061,4.619063605000065,4.608655843000065,4.611092497000072]}]],[[{"lng":[-75.57751119199992,-75.57254986999993,-75.58499457099992,-75.58480469199992,-75.58254868699993,-75.60233326699995,-75.60469728999993,-75.6221425949999,-75.61780007499993,-75.6056092689999,-75.6000135189999,-75.60152390699994,-75.61382130599992,-75.62679704099992,-75.63550704599993,-75.64728537999991,-75.65981246299992,-75.68445256299992,-75.69248324099993,-75.69862664899995,-75.71067042399994,-75.72859708699991,-75.74403248699991,-75.76009710099993,-75.76613368999995,-75.76754721599991,-75.78081099699995,-75.78703022799994,-75.80339993599995,-75.82085434099992,-75.8316660129999,-75.86006847999994,-75.88205103999991,-75.89798680699994,-75.9081200469999,-75.92740629999992,-75.95484736899994,-75.95806735199994,-75.98153408199994,-75.98278837999993,-75.99128181899994,-76.0289934729999,-76.0255537569999,-76.02917093099995,-76.02158832799995,-76.04130435799993,-76.03911138099994,-76.04633230299993,-76.06723574799992,-76.07298183499995,-76.0703186529999,-76.08360427999992,-76.10297726999994,-76.10574139899995,-76.0848137829999,-76.07382895399991,-76.07265088299994,-76.08425012299995,-76.0780024959999,-76.09138760499991,-76.09143967099993,-76.07709053999992,-76.05797870899994,-76.03886687999994,-76.0250850409999,-75.99727389999993,-75.9812458479999,-75.9519499239999,-75.92474792999991,-75.91443058699991,-75.89130222299991,-75.87833892099991,-75.8513155359999,-75.84158829799992,-75.82892004799993,-75.81809825699992,-75.81201635799994,-75.7959121639999,-75.7864894999999,-75.76381799599994,-75.73926768699994,-75.7029578179999,-75.69784673699991,-75.68809570399992,-75.6711206299999,-75.66132676899991,-75.64991963299991,-75.62932539799993,-75.61106303299994,-75.61272627699992,-75.60730110599991,-75.60299904099992,-75.60735821299994,-75.59524675599994,-75.57751119199992],"lat":[3.221496979000051,3.200657081000088,3.175626668000064,3.150148368000089,3.123797462000084,3.113010760000066,3.103352174000065,3.075431490000085,3.06240394200006,3.057757293000066,3.04845246900004,3.039152922000085,3.023506980000093,3.002352261000055,2.994122802000049,2.996264323000048,2.986701842000059,2.98930438900004,2.99346844900009,2.975896648000059,2.964221867000049,2.953622941000049,2.953173377000041,2.943511226000055,2.930715354000085,2.915293959000053,2.911744129000056,2.899091602000055,2.885403306000057,2.883242175000078,2.874483333000057,2.873008062000054,2.889469555000062,2.893774904000054,2.909071467000047,2.921416325000052,2.919445210000049,2.935020135000059,2.956102074000057,2.972314014000062,2.982452433000049,2.940490261000093,2.958666537000056,2.971919958000058,3.004889340000091,3.015879171000051,3.023823311000058,3.04386041500004,3.045883787000093,3.049592588000053,3.067187622000063,3.091277074000061,3.096118037000053,3.106781589000093,3.113060248000068,3.122150401000056,3.139632755000093,3.157493289000058,3.16508517200009,3.175423595000041,3.19848195600008,3.180180962000065,3.169825547000073,3.175003253000057,3.169197370000063,3.181399247000058,3.185510953000062,3.180199997000045,3.192420909000077,3.194038944000056,3.218861479000054,3.222725722000064,3.248264816000074,3.252509778000046,3.268180905000065,3.273962999000048,3.288111270000059,3.29169474300005,3.309683463000056,3.310968377000052,3.322356109000054,3.315471925000054,3.286061786000062,3.279808562000085,3.28289234500005,3.279922775000045,3.291218077000053,3.292146066000043,3.298765728000092,3.266995163000047,3.266309879000062,3.245960728000057,3.220814585000085,3.207789415000093,3.221496979000051]}]],[[{"lng":[-74.70756720599991,-74.7066152729999,-74.71737180899993,-74.73285347199993,-74.74932130299993,-74.75828515299992,-74.76575189899995,-74.78037606899994,-74.80101751199993,-74.80862068199991,-74.83429614799991,-74.85387380199995,-74.86031786299992,-74.8734736639999,-74.89472963199995,-74.90733031899993,-74.92280518399991,-74.91781639999994,-74.92996088299992,-74.93980828399992,-74.96391090899994,-74.96401015799995,-74.98945747799991,-74.9872909259999,-74.99830536499991,-75.01493254699994,-75.00630725799994,-74.9829668939999,-74.97346552799991,-74.97480882999992,-74.97775935999994,-74.96908622299992,-74.95365728599995,-74.95208969499993,-74.92875188799991,-74.89665307999991,-74.85773028499995,-74.86420241999991,-74.84447668799993,-74.83580117399993,-74.81455734499991,-74.79896711799995,-74.77917476099992,-74.75547532899992,-74.74617163599993,-74.7165711369999,-74.70756720599991],"lat":[3.789812712000071,3.779975396000054,3.759153118000086,3.727000901000054,3.722424569000054,3.711386878000042,3.693017441000052,3.672630217000062,3.670996876000061,3.662632244000065,3.656213875000049,3.660676494000086,3.653057601000057,3.66179502500006,3.655838312000071,3.667529500000057,3.649454989000048,3.632457695000085,3.618016829000055,3.629374709000047,3.634477189000052,3.647939654000083,3.662021784000046,3.671564344000046,3.683544956000048,3.686685578000038,3.697716804000038,3.706235526000057,3.734059215000059,3.74548389000006,3.751718079000057,3.779688642000053,3.792586414000084,3.80490319200004,3.816839910000056,3.827121198000043,3.817972909000048,3.791632274000051,3.793702409000048,3.815893259000063,3.78585494500004,3.788405727000054,3.776708295000049,3.775114057000053,3.771045178000065,3.77946847000004,3.789812712000071]}]],[[{"lng":[-74.82467122999992,-74.80997444999991,-74.79262817999995,-74.78834514899995,-74.77573400599994,-74.76407464699992,-74.7594822879999,-74.75136237599992,-74.73205899599992,-74.7232274239999,-74.71768548299991,-74.70709662899992,-74.70756720599991,-74.7165711369999,-74.74617163599993,-74.75547532899992,-74.77917476099992,-74.79896711799995,-74.81455734499991,-74.83580117399993,-74.84447668799993,-74.86420241999991,-74.85773028499995,-74.89665307999991,-74.92875188799991,-74.95208969499993,-74.95365728599995,-74.96908622299992,-74.97775935999994,-74.97480882999992,-74.97966293199994,-75.00591035499991,-75.01044820999994,-75.03387983099992,-75.03321563299994,-75.02226644899991,-75.01081665699991,-75.00220606999994,-74.99513091299991,-74.99997413299991,-74.96978285499995,-74.95081916799995,-74.94804305699995,-74.93391344299994,-74.92137773299993,-74.90784965699993,-74.91819828399991,-74.9108557539999,-74.91989949499992,-74.92781270799992,-74.92082660799991,-74.91178465599995,-74.8976221069999,-74.8824696989999,-74.87316124799992,-74.86578300699995,-74.8620714569999,-74.86901948199994,-74.86564065099992,-74.87544403099992,-74.87611027999992,-74.86799631799994,-74.87397471399993,-74.87012830999993,-74.8396474189999,-74.82467122999992],"lat":[3.895465332000072,3.881698680000056,3.874703065000062,3.887909074000049,3.905683646000057,3.893572195000047,3.865684909000038,3.854798875000085,3.843139516000065,3.828923170000053,3.805356551000045,3.802768752000077,3.789812712000071,3.77946847000004,3.771045178000065,3.775114057000053,3.776708295000049,3.788405727000054,3.78585494500004,3.815893259000063,3.793702409000048,3.791632274000051,3.817972909000048,3.827121198000043,3.816839910000056,3.80490319200004,3.792586414000084,3.779688642000053,3.751718079000057,3.74548389000006,3.747482639000054,3.781859981000082,3.79358318900006,3.81563748700006,3.820020309000085,3.829730267000059,3.832753702000048,3.85174137000007,3.858235358000059,3.891210237000053,3.89798944100005,3.89459445600005,3.904243043000065,3.915964407000047,3.916368762000047,3.930960147000064,3.938664059000075,3.947016529000052,3.955728294000039,3.966536685000051,3.977234743000054,3.978395918000047,3.992272932000049,3.990978510000048,3.99600392900004,4.009230331000083,3.999031271000092,3.991988065000044,3.979376924000064,3.976759517000062,3.962911053000084,3.942423894000058,3.925618950000057,3.914493778000065,3.903914697000062,3.895465332000072]}]],[[{"lng":[-75.5791645779999,-75.5790430909999,-75.60194302499991,-75.6149063279999,-75.6389531609999,-75.65237332099991,-75.67354100599994,-75.67361714999993,-75.68550969599994,-75.6886363079999,-75.69741651899994,-75.71019422299992,-75.71723266899994,-75.72437105199992,-75.73926768699994,-75.76381799599994,-75.7864894999999,-75.7959121639999,-75.81201635799994,-75.81809825699992,-75.82892004799993,-75.84158829799992,-75.8513155359999,-75.87833892099991,-75.89130222299991,-75.91443058699991,-75.92474792999991,-75.9519499239999,-75.9812458479999,-75.99727389999993,-76.0250850409999,-76.03886687999994,-76.05797870899994,-76.07709053999992,-76.09143967099993,-76.0839890339999,-76.07056592799995,-76.06046555599994,-76.05541877699994,-76.05499769199992,-76.03984092099995,-76.04802864299995,-76.05054373599995,-76.0378302769999,-76.04489488499991,-76.05602084299994,-76.05197076099995,-76.06121583699991,-76.04737788299991,-76.04695909899993,-76.03144753599992,-76.0420431789999,-76.03864445099993,-76.04129566099994,-76.03685481899993,-76.02888421499995,-76.02172854799994,-76.02743871899992,-76.01466266499995,-76.0014063079999,-75.99405921499994,-75.98395140899993,-75.98928959799991,-75.98458315199991,-75.99373121299993,-75.98662852099994,-75.99358130499991,-75.97708450399995,-75.97537842999992,-75.95801788199992,-75.95011807299994,-75.96069805299993,-75.95983350299991,-75.95556399799995,-75.94520246299993,-75.91703254499993,-75.89446141899992,-75.88246893299993,-75.86893456199994,-75.85041283699991,-75.84152317099995,-75.82362962199994,-75.8241435889999,-75.81765241799991,-75.79842637399992,-75.79499994999992,-75.78336675899993,-75.76718336599993,-75.75398461999993,-75.75555431999993,-75.74700600999995,-75.72414911699991,-75.69858418999991,-75.68147110699994,-75.65893285099992,-75.6495292219999,-75.63603291899994,-75.63211156299991,-75.62329690099995,-75.61482648799995,-75.59577843499994,-75.5832981609999,-75.58510179399991,-75.57921262799994,-75.58437559699991,-75.58024961199993,-75.5791645779999],"lat":[3.46360934900008,3.453287138000064,3.452273489000049,3.457298908000041,3.459250065000049,3.465817377000064,3.463114311000083,3.452816002000077,3.443593212000053,3.42964481100006,3.421278627000049,3.381946137000057,3.376506688000063,3.348709826000061,3.322356109000054,3.310968377000052,3.309683463000056,3.29169474300005,3.288111270000059,3.273962999000048,3.268180905000065,3.252509778000046,3.248264816000074,3.222725722000064,3.218861479000054,3.194038944000056,3.192420909000077,3.180199997000045,3.185510953000062,3.181399247000058,3.169197370000063,3.175003253000057,3.169825547000073,3.180180962000065,3.19848195600008,3.203682899000057,3.196576418000063,3.202684059000092,3.223351860000093,3.237081025000066,3.24795706000009,3.265067763000047,3.282022615000074,3.300975021000056,3.319128746000047,3.328519637000056,3.336274925000055,3.354549753000072,3.36543606400005,3.374497052000038,3.382281649000049,3.39516965200005,3.417257043000063,3.438280589000044,3.452650141000049,3.452574299000048,3.479535978000058,3.487068729000043,3.508023966000053,3.52006097900005,3.546138107000047,3.559920515000044,3.575461261000044,3.58903309100009,3.609329979000051,3.623649575000059,3.635806243000047,3.643751265000049,3.657949508000058,3.663674491000052,3.67701850800006,3.696539477000044,3.704375574000039,3.713634591000073,3.726381221000054,3.748359865000054,3.742843988000061,3.752495082000053,3.753542042000049,3.77425287300008,3.777146297000058,3.759976106000067,3.723865407000062,3.712272670000061,3.697462905000066,3.685432350000042,3.676539236000053,3.686620695000045,3.674251014000049,3.664766482000061,3.647581151000054,3.642621089000045,3.652177004000066,3.643706123000072,3.619169121000084,3.622062546000052,3.611840380000046,3.594384654000066,3.577820085000042,3.570670300000074,3.572418708000043,3.566386777000048,3.552497861000063,3.518961737000041,3.501633137000056,3.487085112000045,3.46360934900008]}]],[[{"lng":[-75.14831226199993,-75.14583185899994,-75.16861394099993,-75.17905196399994,-75.1929265199999,-75.19272937999995,-75.19988341599992,-75.21585018799993,-75.23015383599994,-75.23743127599994,-75.23804852199993,-75.24697290799992,-75.24155053999993,-75.24419552299992,-75.27603271099991,-75.28840590699991,-75.30205449599993,-75.32907089699995,-75.3456224279999,-75.35961365799994,-75.36905060099991,-75.38172836899992,-75.39176493299993,-75.39263581699993,-75.40839660299991,-75.39843069599993,-75.3870024119999,-75.38939338299991,-75.39101186599993,-75.4150318639999,-75.43488487199994,-75.46063491299992,-75.5066481099999,-75.5131996639999,-75.53538551899993,-75.54437555499993,-75.55606122099994,-75.55905768799994,-75.57012325999995,-75.55212231399992,-75.51988910799992,-75.51313135799995,-75.49923904499991,-75.46495141199995,-75.45004465199992,-75.42730683299993,-75.41949332399992,-75.40407148699995,-75.37638703399995,-75.35695162499991,-75.33999878399993,-75.31350363199994,-75.30072718999992,-75.2812830279999,-75.2555420189999,-75.24032298599991,-75.23505019099991,-75.22578764799994,-75.18827790499995,-75.17909995999992,-75.14831226199993],"lat":[4.321393285000056,4.310955019000062,4.297796684000048,4.278653426000062,4.25970886500005,4.247233161000054,4.226012531000038,4.21365578700005,4.190335963000052,4.166234063000047,4.152627661000054,4.133445201000086,4.117092851000052,4.107485564000058,4.119692199000042,4.108661020000056,4.106072167000093,4.084166848000052,4.059527528000046,4.052617574000067,4.041167610000059,4.039868421000051,4.04540780800005,4.056857772000058,4.055042694000065,4.067954601000054,4.11562334100006,4.120321690000083,4.137688604000061,4.150669638000068,4.137467641000057,4.166580857000042,4.185404410000046,4.198481099000048,4.209280069000044,4.208603650000043,4.219957356000066,4.237672279000037,4.239021687000047,4.23760825700009,4.256456689000061,4.258930970000051,4.281820767000056,4.283062043000086,4.293372213000055,4.289264657000047,4.294173189000048,4.291657118000046,4.311163967000084,4.307262804000061,4.329730282000071,4.346542042000067,4.339764076000051,4.347099954000043,4.344730014000049,4.333194386000059,4.312246453000057,4.293326240000056,4.300426949000041,4.314686080000058,4.321393285000056]}]],[[{"lng":[-74.91989949499992,-74.9108557539999,-74.91819828399991,-74.90784965699993,-74.92137773299993,-74.93391344299994,-74.94804305699995,-74.95081916799995,-74.96978285499995,-74.99997413299991,-74.99513091299991,-75.00220606999994,-75.01081665699991,-75.02226644899991,-75.03321563299994,-75.03967937199991,-75.05928892599991,-75.06470394999991,-75.07994903199994,-75.06305404499994,-75.09738469099995,-75.10299480399993,-75.08549316199992,-75.0726247849999,-75.06556482799994,-75.04408830499995,-75.0409212429999,-75.04765511699992,-75.04412161799991,-75.06164756999993,-75.02755576499993,-75.00877539499993,-75.0041816509999,-74.98988737199994,-74.9744504869999,-74.9524068149999,-74.9314485239999,-74.91989949499992],"lat":[3.955728294000039,3.947016529000052,3.938664059000075,3.930960147000064,3.916368762000047,3.915964407000047,3.904243043000065,3.89459445600005,3.89798944100005,3.891210237000053,3.858235358000059,3.85174137000007,3.832753702000048,3.829730267000059,3.820020309000085,3.828363540000055,3.835955346000048,3.843721045000052,3.847698589000061,3.865800473000093,3.887337406000086,3.909388857000067,3.918992701000093,3.937929035000082,3.938684503000047,3.926082216000054,3.939016966000054,3.956030113000054,3.961407695000048,3.985847322000041,4.004799698000056,3.99571510800007,3.978822820000062,3.95561759800006,3.944065712000054,3.948471816000051,3.949233244000084,3.955728294000039]}]],[[{"lng":[-75.38939338299991,-75.3870024119999,-75.39843069599993,-75.40839660299991,-75.42632594999992,-75.41336597999992,-75.44105525899994,-75.42711365999992,-75.4274250549999,-75.43777537499994,-75.43359420099995,-75.44381716399994,-75.43989181199993,-75.44863791799992,-75.44949025699992,-75.45922225299995,-75.48115429399991,-75.50758517499992,-75.52658555599993,-75.54868079699992,-75.56640458599992,-75.57961659099993,-75.5837776759999,-75.60137379199995,-75.60864304599994,-75.63159294299993,-75.63264899099994,-75.61841050399994,-75.6089592859999,-75.5934975479999,-75.58056279899995,-75.55227837699994,-75.53832972399994,-75.5214387389999,-75.51167343099991,-75.47131777399994,-75.47323529599993,-75.45853631499995,-75.45682243199991,-75.4501246129999,-75.43370418599994,-75.40708607199991,-75.4004650839999,-75.38939338299991],"lat":[4.120321690000083,4.11562334100006,4.067954601000054,4.055042694000065,4.049772353000037,4.024323874000061,3.984931900000049,3.95863521800004,3.944962013000065,3.927291976000049,3.909990347000075,3.87532757200006,3.873310870000068,3.857783829000084,3.846662085000048,3.830838671000038,3.845900347000054,3.841467503000047,3.847654681000051,3.860668278000048,3.858322563000058,3.875137699000049,3.893837655000084,3.898180171000092,3.92716200600006,3.933063068000081,3.951632583000048,3.968466762000048,3.96678210400006,3.974206025000058,3.988354298000047,3.98226059700005,3.999698851000062,4.012698070000056,4.009956929000055,4.020359934000055,4.043653059000064,4.063423469000043,4.091317491000041,4.101752519000058,4.115615214000059,4.121300259000066,4.11175828100005,4.120321690000083]}]],[[{"lng":[-75.02929164699992,-75.02310165999995,-74.99785608399992,-75.00657783699995,-75.02367700299993,-75.03413602099994,-75.04222599199994,-75.04324459899993,-75.05066851499993,-75.0599069619999,-75.0726608729999,-75.08273075199992,-75.07479287099994,-75.07846675499991,-75.06144885299994,-75.05512900399992,-75.07125223299994,-75.07985636099994,-75.0799170869999,-75.08477043599993,-75.06654105299992,-75.06164756999993,-75.04412161799991,-75.04765511699992,-75.0409212429999,-75.04408830499995,-75.06556482799994,-75.0726247849999,-75.08271517999992,-75.09316101499991,-75.09435073999992,-75.1207389679999,-75.13166069399995,-75.13769024299995,-75.15957652999992,-75.18972429699994,-75.19600607699994,-75.21402882899991,-75.21805643899995,-75.21033578799995,-75.19984236799991,-75.18996776599994,-75.18014865499993,-75.15971496899994,-75.14665172499991,-75.13665777699993,-75.11018776399993,-75.09744337599994,-75.08529860399995,-75.10124099599994,-75.0965439389999,-75.10896234599994,-75.12160940899992,-75.1352809789999,-75.14438581699994,-75.1528122659999,-75.17905196399994,-75.16861394099993,-75.14583185899994,-75.14831226199993,-75.13967481799995,-75.12574307499995,-75.11520206299991,-75.10380444399993,-75.08856399699994,-75.08578002699994,-75.07483450699993,-75.02929164699992],"lat":[4.279496809000079,4.279474722000089,4.248178039000038,4.236532407000084,4.230655952000063,4.245944921000046,4.246814660000041,4.229712237000058,4.216420566000068,4.181786235000061,4.152604526000061,4.138004152000065,4.12391774300005,4.110421439000049,4.10950772700005,4.100694203000046,4.080992267000056,4.061080936000053,4.043632996000042,4.023604568000053,4.002329105000058,3.985847322000041,3.961407695000048,3.956030113000054,3.939016966000054,3.926082216000054,3.938684503000047,3.937929035000082,3.952951402000053,3.960541884000065,3.970725977000086,3.979077885000038,3.98785809900005,4.008087085000057,3.996237368000038,4.012441498000044,4.023410813000055,4.032476325000061,4.053917420000062,4.080716629000051,4.088033472000063,4.108580304000043,4.105028726000057,4.119530548000057,4.135960726000064,4.140460321000091,4.167711721000046,4.195884541000055,4.229254099000059,4.230282026000054,4.247923351000054,4.252308698000093,4.23837876500005,4.235856901000091,4.246959451000066,4.245456466000064,4.278653426000062,4.297796684000048,4.310955019000062,4.321393285000056,4.325176628000065,4.317657531000066,4.319680076000054,4.306331298000089,4.301108381000063,4.290400809000062,4.284309388000054,4.279496809000079]}]],[[{"lng":[-75.05048053299993,-75.07350066699991,-75.08184024199994,-75.09605751999993,-75.11322533299995,-75.13072194499995,-75.14860597199993,-75.15731912399991,-75.18782942699994,-75.20929302899992,-75.24134124699992,-75.25466902199992,-75.27623967699992,-75.2856601119999,-75.30360964099992,-75.32519191799992,-75.35470085599991,-75.36383341199991,-75.3835074669999,-75.38871062199991,-75.3781724829999,-75.38800026299992,-75.37774488899993,-75.37984836999993,-75.37549906999993,-75.34288758699995,-75.32613617899995,-75.3181292939999,-75.29427856899991,-75.28197675599995,-75.2735891559999,-75.25514833199992,-75.24424802099992,-75.23648146099993,-75.2164178459999,-75.18000257499995,-75.16667759299992,-75.14303851099993,-75.13416392199991,-75.11019247499991,-75.09624373299994,-75.07046674199995,-75.05030332199993,-75.04343263199991,-75.0466508479999,-75.03732336599995,-75.01268830399994,-75.0290415259999,-75.03176250899992,-75.06669135399994,-75.06480667799991,-75.05048053299993],"lat":[4.696241422000071,4.684362142000055,4.660545545000048,4.657131016000051,4.667505468000058,4.663803599000062,4.672007979000057,4.683126630000061,4.711776911000072,4.713984827000047,4.711736767000048,4.706076479000046,4.716018782000049,4.709689428000047,4.710440173000052,4.701825504000055,4.701320458000055,4.708051212000044,4.708344679000049,4.715441808000094,4.730469691000053,4.746421730000066,4.768856652000068,4.776544650000062,4.802684968000051,4.765215511000065,4.76195565200004,4.754162916000041,4.763137647000065,4.758604774000048,4.767468266000037,4.768217800000059,4.774887429000046,4.77090897000005,4.776296071000047,4.754995135000058,4.740337652000051,4.736657622000052,4.74380181500004,4.737649978000093,4.750295908000055,4.752976295000053,4.760978631000057,4.773322087000054,4.787134859000048,4.796295783000062,4.811585630000081,4.784818939000047,4.753658725000093,4.715070836000052,4.705372577000048,4.696241422000071]}]],[[{"lng":[-74.74476457899993,-74.76678893999991,-74.77711734699994,-74.78995760399994,-74.78479668499995,-74.78497843199995,-74.79615143099994,-74.79396391499995,-74.79843436899995,-74.79865424099995,-74.7805689029999,-74.79499616299995,-74.80720563199992,-74.80535242399992,-74.80992098499991,-74.82467122999992,-74.8396474189999,-74.87012830999993,-74.87397471399993,-74.86799631799994,-74.87611027999992,-74.87544403099992,-74.86564065099992,-74.86901948199994,-74.8620714569999,-74.86578300699995,-74.85740771299993,-74.84075148799991,-74.83372790399994,-74.83813407799994,-74.82807850899991,-74.81172206499991,-74.81414911399992,-74.80477403799995,-74.8193363389999,-74.8114771779999,-74.80101448999994,-74.79639833199991,-74.79463753399995,-74.78147358099994,-74.7655008939999,-74.7519976559999,-74.74476457899993],"lat":[4.247759847000054,4.228791206000039,4.199677076000057,4.17552508700004,4.153333271000065,4.136985199000094,4.09994395800004,4.075353643000085,4.05601609900009,4.026259159000062,4.013972167000077,3.98847431900009,3.975141043000065,3.950425538000047,3.927106821000052,3.895465332000072,3.903914697000062,3.914493778000065,3.925618950000057,3.942423894000058,3.962911053000084,3.976759517000062,3.979376924000064,3.991988065000044,3.999031271000092,4.009230331000083,4.02906007200005,4.034294883000086,4.045972701000039,4.062515292000057,4.09009659600008,4.108819603000086,4.130900999000062,4.154124540000055,4.179204057000049,4.191709417000084,4.202951080000048,4.221272929000065,4.246400037000058,4.265062322000063,4.256982229000073,4.259161615000039,4.247759847000054]}]],[[{"lng":[-75.18996776599994,-75.21066891599992,-75.24419552299992,-75.24155053999993,-75.24697290799992,-75.23804852199993,-75.23743127599994,-75.23015383599994,-75.21585018799993,-75.19988341599992,-75.19272937999995,-75.1929265199999,-75.17905196399994,-75.1528122659999,-75.14438581699994,-75.1352809789999,-75.12160940899992,-75.10896234599994,-75.0965439389999,-75.10124099599994,-75.08529860399995,-75.09744337599994,-75.11018776399993,-75.13665777699993,-75.14665172499991,-75.15971496899994,-75.18014865499993,-75.18996776599994],"lat":[4.108580304000043,4.100014056000077,4.107485564000058,4.117092851000052,4.133445201000086,4.152627661000054,4.166234063000047,4.190335963000052,4.21365578700005,4.226012531000038,4.247233161000054,4.25970886500005,4.278653426000062,4.245456466000064,4.246959451000066,4.235856901000091,4.23837876500005,4.252308698000093,4.247923351000054,4.230282026000054,4.229254099000059,4.195884541000055,4.167711721000046,4.140460321000091,4.135960726000064,4.119530548000057,4.105028726000057,4.108580304000043]}]],[[{"lng":[-75.0077509219999,-75.00029323599995,-74.96416514499992,-74.9561320819999,-74.94666183099991,-74.94138894199995,-74.92361912999991,-74.91672821099991,-74.8964409219999,-74.88678040399992,-74.87159944299992,-74.87681148799993,-74.87175736599994,-74.88453785399992,-74.88419479899994,-74.86509042699993,-74.83175417899992,-74.8157831229999,-74.80129599599991,-74.80720370699993,-74.78823895099993,-74.7865267169999,-74.79559264099993,-74.80228061299994,-74.8162493669999,-74.82679454099991,-74.8554765639999,-74.8625876829999,-74.8885020969999,-74.8923568219999,-74.90882645799991,-74.92539563999992,-74.94290847299993,-74.94497999099991,-74.95491285399993,-74.95828117399992,-74.97234378999991,-75.01428892899992,-75.01703720599994,-75.03326275199993,-75.05048053299993,-75.06480667799991,-75.06669135399994,-75.03176250899992,-75.0290415259999,-75.01268830399994,-75.0077509219999],"lat":[4.811035975000038,4.798588521000056,4.794268627000065,4.78275203600009,4.781800252000039,4.791651221000052,4.790585223000051,4.783285034000073,4.773812879000047,4.777917054000056,4.774252683000043,4.75544609700006,4.74438761600004,4.734277595000037,4.719650345000048,4.712562779000052,4.727824640000051,4.713573549000046,4.699971959000038,4.669448789000057,4.658214330000078,4.64726700600005,4.642901246000065,4.625791176000064,4.611092497000072,4.608655843000065,4.619063605000065,4.625193792000061,4.629215487000067,4.637008218000062,4.634311191000052,4.640268081000045,4.661385801000051,4.671445059000064,4.674496628000043,4.692931596000051,4.702868222000063,4.693447936000041,4.688760398000056,4.701362025000037,4.696241422000071,4.705372577000048,4.715070836000052,4.753658725000093,4.784818939000047,4.811585630000081,4.811035975000038]}]],[[{"lng":[-74.53159213599992,-74.52745540599994,-74.51308620099991,-74.51497996199993,-74.52262848399994,-74.52872807499995,-74.53945977399991,-74.55159685399991,-74.5600535559999,-74.58258027799991,-74.60264993399994,-74.61764264999994,-74.64491637099991,-74.67255314499994,-74.69666896699994,-74.70524693999994,-74.71033304199995,-74.71737180899993,-74.7066152729999,-74.70756720599991,-74.70709662899992,-74.69104902099991,-74.69720587599994,-74.69295258699992,-74.70238120499994,-74.69726536399992,-74.68233424399995,-74.6622159019999,-74.65372122699995,-74.66193036699991,-74.66837870299992,-74.63608942099995,-74.62711885399995,-74.61105748799991,-74.59204559699992,-74.55471185099992,-74.53924535899995,-74.53159213599992],"lat":[3.975497081000071,3.962770843000044,3.953410947000066,3.927214622000065,3.91707196100009,3.878511661000061,3.844774947000076,3.836874093000063,3.816201192000051,3.794844724000086,3.765871049000054,3.737321564000069,3.714423937000049,3.696596119000048,3.703254561000051,3.730330923000054,3.756415765000042,3.759153118000086,3.779975396000054,3.789812712000071,3.802768752000077,3.810281789000044,3.821048853000093,3.842761427000084,3.87137444800004,3.877769249000039,3.879732306000051,3.900106440000059,3.919046949000062,3.945435175000057,3.949266105000049,3.974535980000041,3.978152762000093,3.995570419000046,3.981793337000056,3.977510307000045,3.973393839000039,3.975497081000071]}]],[[{"lng":[-74.78992066599994,-74.77327739299994,-74.76585347499991,-74.73427575799991,-74.72498724899992,-74.72335653699992,-74.7303723149999,-74.7296627149999,-74.73355691399991,-74.71986737399993,-74.71466137499993,-74.71915570599992,-74.73103348399991,-74.73152806999991,-74.71981957799994,-74.71680799799992,-74.72974825799992,-74.72971531999991,-74.7354119929999,-74.75162802199992,-74.76218443699992,-74.77194449599995,-74.77192664199993,-74.78470042299995,-74.80075723199991,-74.81553981699994,-74.84597753199995,-74.85090654099992,-74.88435851199995,-74.86411017899991,-74.86791118799994,-74.83587243999995,-74.81734244399991,-74.7950597549999,-74.80405040099993,-74.8173363329999,-74.82303698399994,-74.81808013799991,-74.82185990199991,-74.83309596599992,-74.84939007599991,-74.86127117399991,-74.8513312799999,-74.82269149399991,-74.81211191799991,-74.78992066599994],"lat":[5.298564296000052,5.298229872000093,5.287960119000047,5.286864727000079,5.264369393000038,5.239851581000039,5.232173149000062,5.213031525000076,5.20313514500009,5.198326566000048,5.186024719000045,5.163709557000061,5.149541639000063,5.140726298000061,5.11948996700005,5.092314671000054,5.074332083000058,5.068119947000071,5.052746013000046,5.048022786000047,5.039881398000091,5.061438550000048,5.099666739000043,5.100811529000055,5.092993991000071,5.093329377000089,5.101531050000062,5.119664327000066,5.146773978000056,5.167774573000088,5.174664385000085,5.187571828000046,5.208239913000057,5.227338789000044,5.23400954400006,5.253797706000057,5.268912837000073,5.280562475000067,5.292241464000085,5.293781856000066,5.307340404000058,5.30625849200004,5.313973950000047,5.318122143000039,5.306082540000091,5.298564296000052]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"black","weight":2,"opacity":0.5,"fill":true,"fillColor":["#C8C8C8","#C8C8C8","#C8C8C8","#80CC96","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#80CC96","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#F08E94","#00992C","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8","#C8C8C8"],"fillOpacity":0.65,"smoothFactor":0.2,"noClip":false},["<b>Municipality Name: <\/b>IBAGUE<br><b>Municipality Code: <\/b>73001<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>ALVARADO<br><b>Municipality Code: <\/b>73026<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>AMBALEMA<br><b>Municipality Code: <\/b>73030<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>ANZOATEGUI<br><b>Municipality Code: <\/b>73043<br><b>Cluster: <\/b>Low-High<br>","<b>Municipality Name: <\/b>ARMERO<br><b>Municipality Code: <\/b>73055<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>ATACO<br><b>Municipality Code: <\/b>73067<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>CAJAMARCA<br><b>Municipality Code: <\/b>73124<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>CARMEN DE APICALA<br><b>Municipality Code: <\/b>73148<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>CASABIANCA<br><b>Municipality Code: <\/b>73152<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>CHAPARRAL<br><b>Municipality Code: <\/b>73168<br><b>Cluster: <\/b>Low-High<br>","<b>Municipality Name: <\/b>COELLO<br><b>Municipality Code: <\/b>73200<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>COYAIMA<br><b>Municipality Code: <\/b>73217<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>CUNDAY<br><b>Municipality Code: <\/b>73226<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>DOLORES<br><b>Municipality Code: <\/b>73236<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>ESPINAL<br><b>Municipality Code: <\/b>73268<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>FALAN<br><b>Municipality Code: <\/b>73270<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>FLANDES<br><b>Municipality Code: <\/b>73275<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>FRESNO<br><b>Municipality Code: <\/b>73283<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>GUAMO<br><b>Municipality Code: <\/b>73319<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>ICONONZO<br><b>Municipality Code: <\/b>73352<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>LERIDA<br><b>Municipality Code: <\/b>73408<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>LIBANO<br><b>Municipality Code: <\/b>73411<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>SAN SEBASTIAN DE MARIQUITA<br><b>Municipality Code: <\/b>73443<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>MELGAR<br><b>Municipality Code: <\/b>73449<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>NATAGAIMA<br><b>Municipality Code: <\/b>73483<br><b>Cluster: <\/b>High-Low<br>","<b>Municipality Name: <\/b>ORTEGA<br><b>Municipality Code: <\/b>73504<br><b>Cluster: <\/b>Low-Low<br>","<b>Municipality Name: <\/b>PALOCABILDO<br><b>Municipality Code: <\/b>73520<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>PIEDRAS<br><b>Municipality Code: <\/b>73547<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>PLANADAS<br><b>Municipality Code: <\/b>73555<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>PRADO<br><b>Municipality Code: <\/b>73563<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>PURIFICACION<br><b>Municipality Code: <\/b>73585<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>RIOBLANCO<br><b>Municipality Code: <\/b>73616<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>ROVIRA<br><b>Municipality Code: <\/b>73624<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>SALDANA<br><b>Municipality Code: <\/b>73671<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>SAN ANTONIO<br><b>Municipality Code: <\/b>73675<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>SAN LUIS<br><b>Municipality Code: <\/b>73678<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>SANTA ISABEL<br><b>Municipality Code: <\/b>73686<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>SUAREZ<br><b>Municipality Code: <\/b>73770<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>VALLE DE SAN JUAN<br><b>Municipality Code: <\/b>73854<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>VENADILLO<br><b>Municipality Code: <\/b>73861<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>VILLARRICA<br><b>Municipality Code: <\/b>73873<br><b>Cluster: <\/b>Not Significant<br>","<b>Municipality Name: <\/b>HONDA<br><b>Municipality Code: <\/b>73349<br><b>Cluster: <\/b>Not Significant<br>"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#BA0001","#F08E94","#80CC96","#00992C","#C8C8C8"],"labels":["High-High","High-Low","Low-High","Low-Low","Not Significant"],"na_color":null,"na_label":"NA","opacity":1,"position":"bottomright","type":"factor","title":"Local Moran's Index Clusters <\/br>2020-W53 to 12 months later","extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[2.873008062000054,5.318122143000039],"lng":[-76.10574139899995,-74.4748249029999]}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->
</div>
<div class="section level3">
<h3 id="interpretación-de-los-resultados-del-mapa">2. Interpretación de los resultados del mapa<a class="anchor" aria-label="anchor" href="#interpretaci%C3%B3n-de-los-resultados-del-mapa"></a>
</h3>
<p>El metodo del indice de moran local divide los datos espaciales en 4
cuadrantes:</p>
<ul>
<li>High-High: donde se ubican los municipios cuya incidencia está sobre
la media de la región, y se encuentran rodeados de municipios que
también se encuentran sobre la media de la región.</li>
<li>Low-High: municipios cuya incidencia está debajo de la media de la
región, y se encuentran rodeados de municipios que se encuentran sobre
la media de la región. Este cuadrante marca municipios candidatos a ser
casos atípicos espaciales.</li>
<li>Low-Low: municipios cuya incidencia está debajo de la media de la
región, y se encuentran rodeados de municipios que se encuentran debajo
de la media media de la región.</li>
<li>High-Low, municipios cuya incidencia está sobre la media de la
región, y se encuentran rodeados de municipios que se encuentran debajo
de la media de la región. Este cuadrante marca municipios candidatos a
ser casos atípicos espaciales.</li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="reto">Reto<a class="anchor" aria-label="anchor" href="#reto"></a>
</h2>
<p><a href="https://docs.google.com/document/d/1HLUTZzEA5-8BjjeK6vByLnO9D2W0VhRK/edit?usp=sharing&amp;ouid=108718106243006326200&amp;rtpof=true&amp;sd=true" class="external-link">Reto</a>
***</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<p>Revise si al final de esta lección adquirió estas competencias:</p>
<ol style="list-style-type: decimal">
<li>Navegar por la codificación de la División Política Administrativa
de Colombia (DIVIPOLA).</li>
<li>Consultar, visualizar e interpretar pirámides poblacionales a
distintas escalas administrativas.</li>
<li>Familiarizarse con la información epidemiológica proporcionada por
el SIVIGILA.</li>
<li>Describir las características demográficas de la información
epidemiológica.</li>
<li>Estimar tasas de incidencia acumulada a distintas escalas espaciales
y temporales.</li>
<li>Realizar una evaluación del riesgo etario integrando información
epidemiológica con información sobre la estructura poblacional de una
región.</li>
</ol>
</div>
</div>
</div>
<div class="section level3">
<h3 id="sobre-este-documento">Sobre este documento<a class="anchor" aria-label="anchor" href="#sobre-este-documento"></a>
</h3>
<p>Este documento ha sido diseñado por Juan Daniel Umaña Caro y Juan
Montenegro-Torres para el Curso Internacional: Análisis de Brotes y
Modelamiento en Salud Pública, Bogotá 2023. TRACE-LAC/Javeriana.</p>
<div class="section level4">
<h4 id="contribuciones">Contribuciones<a class="anchor" aria-label="anchor" href="#contribuciones"></a>
</h4>
<ul>
<li>
<a href="https://github.com/juan-umana" class="external-link">Juan D. Umaña</a>
(author)</li>
<li>
<a href="https://github.com/Juanmontenegro99" class="external-link">Juan
Montenegro-Torres</a> (author)</li>
<li>
<a href="https://github.com/jd-otero" class="external-link">Julian Otero</a> (author)</li>
<li>
<a href="https://github.com/mauricio110785" class="external-link">Mauricio Santos-Vega</a>
(contributor)</li>
<li>
<a href="mailto:cgonzalez@uniandes.edu.co">Catalina Gonzalez
Uribe</a> (contributor)</li>
<li>
<a href="mailto:jucordov@uniandes.edu.co">Juan Manuel Cordovez</a>
(contributor)</li>
</ul>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>
</div>
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>Esta lección está sujeta al <a href="CODE_OF_CONDUCT.html">Código de Conducta</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/epimodelac/edit/main/README.md" class="external-link">Editar en GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/epimodelac/blob/main/CONTRIBUTING.md" class="external-link">Contribuir</a>
        | <a href="https://github.com/epiverse-trace/epimodelac/" class="external-link">Fuente</a></p>
				<p><a href="https://github.com/epiverse-trace/epimodelac/blob/main/CITATION" class="external-link">Cita</a> | <a href="mailto:team@carpentries.org">Contacto</a> | <a href="https://carpentries.org/about/" class="external-link">Acerca de</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Plantilla compartida bajo <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> por <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Construido con <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a> y <a href="https://github.com/epiverse-trace/varnish/tree/tracelactheme" class="external-link">varnish (1.0.1.9000)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Volver al inicio"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Volver</span> al inicio
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/epimodelac/aio.html",
  "inLanguage": "es",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Todo en una sola página",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/epimodelac/aio.html",
  "identifier": "https://epiverse-trace.github.io/epimodelac/aio.html",
  "dateCreated": "2023-11-10",
  "dateModified": "2025-03-13",
  "datePublished": "2025-03-13"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

